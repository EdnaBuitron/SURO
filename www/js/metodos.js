    var IdUsuario = localStorage.getItem("IdUsuario");
    $("#IdUsuario").val(IdUsuario);
    //Borrar variables de sesion y regresar a el Log-in
    function logaout(){
        window.localStorage.clear();
        window.location.href = "index.html";
    }
    //Bennetts Inicio
    function buscarClienteBennetts() {
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var horario_programado = fecha_llegada;
        var estatus = 0;
        productHandler.addBennetts(id_usuario, nombre_usuario, fecha_llegada, geolocation, horario_programado, estatus);
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "Select MAX(id_cedula) as Id from cedulas_general",
              [],
              function (tx, results) {
                var item = results.rows.item(0);
                localStorage.setItem("IdCedula", item.Id);
                app.views.main.router.navigate({ name: "menuBennetts" });
                app.preloader.hide();
              },
              function (tx, error) {
                console.log("Error al guardar cedula: " + error.message);
                app.preloader.hide();
              }
            );
          },
          function (error) {},
          function () {}
        );
      }
      function continuarCedBennetts(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'menuBennetts'});
        } else if(tipo == 2){
            app.views.main.router.back('/recorridoBennetts2/', {force: true, ignoreCache: true, reload: true});
        }
      }
      function guardarDatosBennetts(){
        app.preloader.show('blue');
        if($("#division").val() == "0"){
          swal("", "Debes de llenar todos los campos" , "warning");
          app.preloader.hide();
          return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var division = $("#division").val();
        databaseHandler.db.transaction(
          function(tx){
            tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
            [division,id_cedula],
            function(tx, results){
              $("#division").css("background-color", "#FFFFFF");
              swal("","Se guardaron los datos correctamente", "success");
              app.preloader.hide();
            },
            function(tx, error){
              swal("Error al guardar", error.message, "error");
              app.preloader.hide();
            }
            );
          },
          function(error){},
          function(){}
        );
      
      }
      function guardarDatosBennetts2(){
        app.preloader.show('blue');
        if($("#nombre_comp").val() == "" || $("#almacen").val() == "0" || $("#empresa").val() == "0"){
          swal("", "Debes de llenar todos los campos" , "warning");
          app.preloader.hide();
          return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombre_comp = $("#nombre_comp").val();
        var almacen = $("#almacen").val();
        var empresa = $("#empresa").val();
        databaseHandler.db.transaction(
          function(tx){
            tx.executeSql("UPDATE inventario SET pareja_almacen = ?, almacen = ?, empresa = ? WHERE id_cedula = ?",
            [nombre_comp,almacen,empresa,id_cedula],
            function(tx, results){
                if(empresa == 1 && almacen == 1){
                    var inventario = "codigos_bennetts"
                } else if(empresa == 1 && almacen == 2){
                    var inventario = "codigos_bennetts2"
                } else if(empresa == 2 && almacen == 1){
                    var inventario = "codigos_bennetts3"
                } else {
                    var inventario = "codigos_bennetts4"
                }
                localStorage.setItem("almacen", inventario);
              $("#nombre_comp").css("background-color", "#FFFFFF");
              swal("","Se guardaron los datos correctamente", "success");
              app.preloader.hide();

            },
            function(tx, error){
              swal("Error al guardar", error.message, "error");
              app.preloader.hide();
            }
            );
          },
          function(error){},
          function(){}
        );
      
      }
      function datosCheckB(){
        var checkbox1 = document.getElementById("destruccion");
        var checkbox2 = document.getElementById("baja"); 
       checkbox1.onclick = function(){ 
       if(checkbox1.checked != false){ 
       checkbox2.checked =null; }
        } 
       checkbox2.onclick = function(){ 
       if(checkbox2.checked != false){ 
       checkbox1.checked=null;
        }
       
        } 
       }
       
    function actaBajaProducto(){
        app.preloader.show('blue');
        if($("#codigo").val() == "" || $("#descripcion").val() == "" || $("#cantidad").val() == "" || ($("#destruccion").prop("checked") == false && $("#baja").prop("checked") == false) || $("#motivo").val() == "" || $("#imagenC1").val() == "" || $("#imagenC2").val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var codigo_producto = $("#codigo").val();
        var descripcion_producto = $("#descripcion").val();
        var cantidad_producto = $("#cantidad").val();
        var motivo = $("#motivo").val();
        if ($("#destruccion").prop("checked") == true){
        var aplica = 1; 
        } else {
        var aplica = 0;
        }
        var evidencia_foto_antes = $('#imagenC1').val();
        var evidencia_foto_despues = $('#imagenC2').val();
        var fechaR = new Date();
        var fecha = fechaR.getFullYear()+"-"+(fechaR.getMonth()+1)+"-"+fechaR.getDate()+" "+fechaR.getHours()+":"+fechaR.getMinutes()+":"+fechaR.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
            
                tx.executeSql("INSERT INTO productos(id_cedula,codigo_producto,descripcion_producto,cantidad_producto,motivo, aplica, evidencia_foto_antes,evidencia_foto_despues,fecha) VALUES (?,?,?,?,?,?,?,?,?)",
                    [id_cedula,codigo_producto,descripcion_producto,cantidad_producto,motivo, aplica, evidencia_foto_antes,evidencia_foto_despues,fecha],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_producto) as Id from productos",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from productos where id_producto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        if(item.aplica ==1){
                                                        var valoraplica = "Destrucción";
                                                        } else{
                                                        var valoraplica = "Baja";
                                                        }
                                                        $("#smallImage1").attr("src","img/blank.png");
                                                        $("#smallImage2").attr("src","img/blank.png");
                                                        $('#imagenC1').val("");
                                                        $('#imagenC2').val("");
                                                        $("#photoIcon1").attr("src","img/camera.svg");
                                                        $("#photoIcon2").attr("src","img/camera.svg");
                                                        $("#tabla_productos tbody").append("<tr id='fila"+ item.id_producto +"'><td><a href='#' onclick='eliminarFilaBennetts("+ item.id_producto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + unescape(item.codigo_producto) + "</td><td style='text-align: center;'>" + unescape(item.descripcion_producto) + "</td><td style='text-align: center;'>" + unescape(item.cantidad_producto) + "</td><td style='text-align: center;'>" + unescape(item.motivo) + "</td><td style='text-align: center;'>" + valoraplica + "</td><td><img src='"+item.evidencia_foto_antes+"' width='60px' style='margin-top: 4px;'/></td><td><img src='"+item.evidencia_foto_despues+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $("#codigo").css("background-color","#ffffff");
                                                        $("#descripcion").css("background-color","#ffffff");
                                                        $("#cantidad").css("background-color","#ffffff");
                                                        $("#motivo").css("background-color","#ffffff");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Acuerdo guardado","success");
                        app.preloader.hide();
                        
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function deleteForm() {
        document.getElementById("demo-form").reset();
    }
    function eliminarFilaBennetts(index, opc, contexto){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM productos WHERE id_producto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM conteo WHERE id_conteo = ?",
                        [index],
                        function(tx, results){
                            
                            // console.log("entre antes de eliminar")
                            // console.log(contexto)
                            // var table = $("#inventario").DataTable();
                            // console.log(table)
                            // table
                            //     .row($(contexto).parents('tr'))
                            //     .remove()
                            // .draw();
                            // console.log("entreee 1321313213")
                            swal("","El registro se elimito satisfactoriamente","success");
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarCierreBennetts() {
        if ($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#puesto").val() == "" || $("#correo").val() == ""){
          swal("", "Todos los campos son obligatorios", "warning");
          return false;
        }
        
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var correo = $("#correo").val();
        var puesto = $("#puesto").val();
        var correo = $("#correo").val()
        var fecha = new Date();
        var fecha_firma =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "UPDATE datos_productos SET firma_cliente = ?, puesto = ?,correo = ? WHERE id_cedula = ?",
              [firmaCliente, puesto,correo, id_cedula],
              function (tx, results) {
                databaseHandler.db.transaction(
                  function (tx) {
                    tx.executeSql(
                      "UPDATE cedulas_general SET nombre_evalua = ?, horario_programado = ? WHERE id_cedula = ?",
                      [nombrefirma,puesto,id_cedula],
                      function (tx, results) {
                        swal("", "Guardado correctamente", "success");
                        app.views.main.router.back("/yamevoyBennetts/", {
                          force: true,
                          ignoreCache: true,
                          reload: true,
                        });
                      },
                      function (tx, error) {
                        console.error("Error al guardar cierre: " + error.message);
                      }
                    );
                  },
                  function (error) {},
                  function () {}
                );
              },
              function (tx, error) {
                console.error("Error al guardar cierre: " + error.message);
              }
            );
          },
          function (error) {},
          function () {}
        );
      }
      function terminarBajaBennetts() {
        var id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_salida =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();
        var ubicacion_salida = $("#geolocation").val();
        var estatus = 1;
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
              [fecha_salida, ubicacion_salida, estatus, id_cedula],
              function (tx, results) {
                window.location.href = "./menu.html";
              },
              function (tx, error) {
                swal("Error al guardar", error.message, "error");
              }
            );
          },
          function (error) {},
          function () {}
        )
      }
      function terminarConteoBennetts() {
        var id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_salida =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();
        var ubicacion_salida = $("#geolocation").val();
        var estatus = 1;
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
              [fecha_salida, ubicacion_salida, estatus, id_cedula],
              function (tx, results) {
                window.location.href = "./menu.html";
              },
              function (tx, error) {
                swal("Error al guardar", error.message, "error");
              }
            );
          },
          function (error) {},
          function () {}
        )
      }
      function generarBajaBennetts(){
        // let id_cedula = localStorage.getItem("IdCedula");
        // let foto_llegada = localStorage.getItem("foto_llegada");
        // let tipoCedula = "minutaCoordinador";
        // databaseHandler.db.transaction(
        //     function(tx){
        //         tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
        //             [tipoCedula,id_cedula],
        //             function(tx, results){
        //                 productHandler.addMinutaCoordinador(id_cedula,foto_llegada);
                        app.views.main.router.navigate({name: 'recorridoBennetts1'});
        //             },
        //             function(tx, error){
        //                 console.error("Error al actualizar el tipo de cedula: " + error.message);
        //             }
        //         );
        //     },
        //     function(error){},
        //     function(){}
        // );
    }
    function generarInventarioBennetts(){
      let id_cedula = localStorage.getItem("IdCedula");
      let tipoCedula = "conteo";
      databaseHandler.db.transaction(
          function(tx){
              tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                  [tipoCedula,id_cedula],
                  function(tx, results){
                      productHandler.addConteo(id_cedula);
                      app.views.main.router.navigate({name: 'recorridoBennetts2'});
                  },
                  function(tx, error){
                      console.error("Error al actualizar el tipo de cedula: " + error.message);
                  }
              );
          },
          function(error){},
          function(){}
      );
    }
    function buscarCodigoBennetts(table,codigo){
        var NomJson = localStorage.getItem("almacen");;
        app.request({
            url: cordova.file.dataDirectory + "jsons/"+NomJson+".json", // y por cual era? XD perate culo dale shift+f6 si le distre? xd
            method: 'GET',
            dataType: 'json',
            //send "query" to server. Useful in case you generate response dynamically, deja inento en el mio para acordarme xd
            success: function (data) {
                var aux = 0;
                for (var i = 0; i < data.length; i++) {
                    if(data[i].CodigoSIAN == codigo || data[i].CodigoSAP == codigo){
                        aux =  aux + 1;
                        $("#inventario tbody").append("<tr id='fila" + i + "'><td style='text-align: center;'>" + unescape(data[i].CodigoSIAN) + "</td><td style='text-align: center;'>" + unescape(data[i].CodigoSAP) + "</td><td style='text-align: center;'>" + unescape(data[i].Descripcion) + "</td><td style='text-align: center;'>" + unescape(data[i].Existencia) + "</td><td><a href='#' onclick='eliminarFilaBennetts(" + i + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td></tr>");
                    }
                    table.row.add([
                        data[i].CodigoSIAN, '1', '1','1', '1', '1'
                      ]).draw();
                }
                if(aux == 0){
                    console.log("No lo encontre")
                }
            }
        }); 
    }
    function cantidadIngresada(inventario,id,id_conteo){
        $('input').blur();
        inventario = parseFloat(inventario);
        var valor = $("#"+id).val();
        var adicional = inventario / 2;
        var max = inventario + adicional;
        var min = inventario - adicional;
        if(valor == 0 && max == 0 && min ==0){

        } else {
            if(valor <= min || valor >= max){
                swal("Alerta!", "La cantidad de producto ingresada esta excediendo el rango del 50% de existencia." ,"warning");
            }
        }
        if(valor == parseInt(inventario)){
            var estatus = 1;
        } else {
            var estatus = 0;
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE conteo SET fisico = ?,estatus_diferencia = ? WHERE id_conteo = ?",
                    [valor,estatus,id_conteo],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function rotate(){
        if(localStorage.getItem("currentOrientation") == "portrait"){
            screen.orientation.lock('landscape');
            localStorage.setItem("currentOrientation", "landscape");
        } else {
            screen.orientation.lock('portrait');
            localStorage.setItem("currentOrientation", "portrait");
        }
    }
    function insertConteo(id_cedula,id_conteo_general,numero_conteo,Codigo,SAP,ubicacion,Descripcion,Inventario,Familia,Costo_unitario,id_usuario){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT id_cedula FROM conteo WHERE id_cedula = ? AND (codigo_sap = ? OR codigo_proveedor = ?) AND ubicacion = ?",
                    [id_cedula,SAP,Codigo,ubicacion],
                    function(tx, results){
                        if(results.rows.length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO conteo(id_cedula,id_conteo_general,numero_conteo,codigo_proveedor,codigo_sap,ubicacion,descripcion,inventario,familia,costo_unitario,usuario,estatus_diferencia,enviado) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,'0')",
                                        [id_cedula,id_conteo_general,numero_conteo,Codigo,SAP,ubicacion,Descripcion,Inventario,Familia,Costo_unitario,id_usuario],
                                        function(tx, results){
                                            var id = results.insertId;
                                            var table = $('#inventario').DataTable();
                                            table.row.add([id,SAP,"<input type='number' id='item"+id+"' onchange='cantidadIngresada(\"" + Inventario + "\",this.id,"+id+")' placeholder='#' style='width:60px'>",Descripcion,Inventario,ubicacion,"<a href='#' class='remove' onclick='eliminarFilaBennetts(" + id + ",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a>"]).draw();
                                            $("#codigo").val("");
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            swal("Error al guardar el registro",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        } else {
                            swal("Producto escaneado", "Ese producto ya fue escaneado en la ubicacion actual, por favor actualiza la cantidad en el registro existente!" ,"warning");
                            $("#codigo").val("");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function searchAsin(codigo){
        var id_cedula = localStorage.getItem("IdCedula");
        var NomJson = localStorage.getItem("almacen");;
        app.request({
            url: cordova.file.dataDirectory + "jsons/"+NomJson+".json",
            method: 'GET',
            dataType: 'json',
            success: function (data) {
                var aux = 0;
                var samecode = 0;
                for (var j = 0; j < data.length; j++) {
                    if(data[j].CodigoSIAN == codigo || data[j].CodigoSAP == codigo){
                        aux =  aux + 1;
                        samecode ++;
                        var id_conteo_general = "1";
                        var numero_conteo = "1";
                        var id_usuario = localStorage.getItem("id_usuario");
                        if(codigo == ""){
                            return;
                        } else {
                            insertConteo(id_cedula,id_conteo_general,numero_conteo,data[j].CodigoSIAN,data[j].CodigoSAP,$('#ubicacion').val(),data[j].Descripcion,data[j].Existencia,data[j].Familia,data[j].Precio,id_usuario);
                        }
                        if(samecode == 2){
                            swal("Codigo duplicado","El codigo ingresado tiene 2 coincidencias en el catalogo de productos, por favor revisalo!.","warning");      
                        }
                    }
                }
                if(aux == 0){
                  swal("Codigo No encontrado","El codigo escaneado no esta en el catalogo de productos.","warning");
                  $("#codigo").val("");
                }
            }
        });
    }
    function searchSingle(codigo){
        var id_cedula = localStorage.getItem("IdCedula");
        var NomJson = localStorage.getItem("almacen");;
        app.request({
            url: cordova.file.dataDirectory + "jsons/"+NomJson+".json",
            method: 'GET',
            dataType: 'json',
            success: function (data) {
                var aux = 0;
                var samecode = 0;
                for (var i = 0; i < data.length; i++) {
                    if(data[i].CodigoSIAN == codigo || data[i].CodigoSAP == codigo){
                        aux =  aux + 1;
                        samecode++;
                        var id_conteo_general = "1";
                        var numero_conteo = "1";
                        var id_usuario = localStorage.getItem("id_usuario");
                        insertConteo(id_cedula,id_conteo_general,numero_conteo,data[i].CodigoSIAN,data[i].CodigoSAP,$('#ubicacion').val(),data[i].Descripcion,data[i].Existencia,data[i].Familia,data[i].Precio,id_usuario);
                        if(samecode == 2){
                            swal("Codigo duplicado","El codigo ingresado tiene 2 coincidencias en el catalogo de productos, por favor revisalo!.","warning");
                            $("#codigo").val("");
                        }
                    }
                }
                if(aux == 0){
                  swal("Codigo No encontrado","El codigo escaneado no esta en el catalogo de productos.","warning");
                  $("#codigo").val("");
                }
            }
        });
    }
    function llevarUbicacion(){
        var ubicacion = $("#ubicacion").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT ubicacion FROM conteo WHERE ubicacion = ? AND (fisico IS NULL OR fisico = '') AND id_cedula = ?",
                    [ubicacion,id_cedula],
                    function(tx, results){
                        if(results.rows.length == 0){
                            var conteo = new Array();
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("SELECT * from conteo WHERE id_cedula = ? AND ubicacion = ?",
                                        [id_cedula,ubicacion],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            for(var i = 0; i< length; i++){
                                                var item3 = results.rows.item(i);
                                                conteo[i] = {'id_cedula': item3.id_cedula,'id_conteo_general': item3.id_conteo_general,'numero_conteo': item3.numero_conteo,'codigo_proveedor': item3.codigo_proveedor,'codigo_sap': item3.codigo_sap,'ubicacion': item3.ubicacion,'descripcion': item3.descripcion,'inventario': item3.inventario,'familia': item3.familia,'costo_unitario': item3.costo_unitario,'usuario': item3.usuario,'estatus_diferencia': item3.estatus_diferencia,'fisico': item3.fisico};
                                            }
                                            $("#ubicacion").val("");
                                            var table = $('#inventario').DataTable();
                                            table.search("").draw();
                                            $.ajax({
                                                type: "POST",
                                                async : true,
                                                url: "http://www.appbennetts.com/FWM2/app/guardarConteoInTime.php",
                                                dataType: 'html',
                                                data: {'conteo': JSON.stringify(conteo)},
                                                success: function(respuesta){
                                                    if(respuesta == "CEDULA._.1"){
                                                        databaseHandler.db.transaction(
                                                            function(tx7){
                                                                tx7.executeSql(
                                                                    "UPDATE conteo SET enviado = 1 WHERE id_cedula = ? AND ubicacion = ?",
                                                                    [id_cedula,ubicacion],
                                                                    function(tx7, results){
                                                                        $("#filtrosUbicacion").css("display","none");
                                                                        swal("Ubicacion guardada", "Se acaba de enviar la Ubicacion!" ,"success");
                                                                    }
                                                                );
                                                            }
                                                        );
                                                        
                                                    }
                                                },
                                                error: function(){
                                                    console.log("Error en la comunicacion con el servidor");
                                                }
                                            });
                                        },
                                        function(tx, error){
                                            console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        } else {
                            swal("Llena las cantidades", "No puedes finalizar la ubicacion actual y no tienes llenas todas las cantidades!" ,"warning");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function restorientation(){
        screen.orientation.lock('portrait');
        localStorage.setItem("currentOrientation", "portrait");
    }
    function validarInventario(){
        if(localStorage.getItem("almacen") == "no"){
          swal("Faltan datos","Para poder iniciar el conteo necesitas llenar datos generales.","warning");
        } else {
            app.views.main.router.back('/template2/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function eliminarubicacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var ubicacion = $("#ubicacion").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT ubicacion FROM conteo WHERE ubicacion = ? AND id_cedula = ?",
                    [ubicacion,id_cedula],
                    function(tx, results){
                        if(results.rows.length == 0){
                            swal("No existen registros", "La ubicacion no tiene registros en la base de datos!" ,"warning");
                        } else {
                            databaseHandler.db.transaction(
                                function(tx4){
                                    tx4.executeSql("DELETE FROM conteo WHERE id_cedula = ? AND ubicacion = ?",
                                        [id_cedula,ubicacion],
                                        function(tx4, results){
                                            swal("Ubicacion eliminada", "Se eliminaron todos los registros de la ubicacion exitosamente!" ,"success");
                                            var table = $('#inventario').DataTable();
                                            var indexes = table
                                            .rows()
                                            .indexes()
                                            .filter( function ( value, index ) {
                                                console.log(table.row(value).data()[5])
                                                return ubicacion === table.row(value).data()[5];
                                            });
                                            console.log(indexes)
                                            table.rows(indexes).remove().draw();
                                        },
                                        function(tx4, error){
                                            console.error("Error al eliminar cedula_general: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    //Bennetts Fin
    //DIPREC Inicio
    function buscarClienteDIPREC(){
        app.preloader.show('blue');
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $('#id_cliente').val();
        var nombre_cliente = $("#nombre_cliente").val();
        var hora_programada = $("#horario_programado").val();
        var atencion = $("#persona_recibe").val();
        var direccion = $("#direccion").val();
        var telefono = $("#telefono").val();
        var correo = $("#correo").val();
        var foto_llegada = $("#imagenC").val();
        var documentoIngresar = $("#documento_ingresar").val();
        var telefono = $("#telefono").val();
        var correo = $("#correo").val();
        var estatus = 0;
        if(localStorage.getItem("IdCedula"))
        {
            app.preloader.hide();
            var cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [cedula],
                        function(tx5, results){
                            var item = results.rows.item(0);
                            if(nombre_cliente != item.nombre_cliente || foto_llegada != localStorage.getItem("foto_llegada")){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET id_usuario = ?,nombre_usuario = ?,fecha_entrada = ?,geolocalizacion_entrada = ?,id_cliente = ?,nombre_cliente = ?,horario_programado = ? WHERE id_cedula = ?",
                                            [id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,hora_programada,cedula],
                                            function(tx, results){
                                                app.views.main.router.navigate({name: 'recorrido1'});
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else {
                                app.views.main.router.navigate({name: 'recorrido1'});
                            }
                        },
                        function(tx5, error){
                            console.error("Error al consultar bandeja de salida: " + error.message);
                        }
                    );
                },
            function(error){},
            function(){}
            );
        } else {
            var NomDescCli = "Clientes_DIPREC";
            if(foto_llegada != ''){
                app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", { IdCed: id_usuario}, function (data) {
                    var content = JSON.parse(data);
                    var aux = 0;
                    for(var i=0; i < content.length; i++){
                        for (var i = 0; i < content.length; i++) {
                            if(content[i].IdCte == id_cliente){
                                aux = 1;
                                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,hora_programada,estatus);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                            [],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                localStorage.setItem("IdCedula", item.Id);
                                                localStorage.setItem("nombreCliente", nombre_cliente);
                                                localStorage.setItem("IdCte", id_cliente);
                                                localStorage.setItem("foto_llegada", foto_llegada);
                                                localStorage.setItem("atencion", atencion);
                                                localStorage.setItem("direccion", direccion);
                                                localStorage.setItem("documentoIngresar", documentoIngresar);
                                                localStorage.setItem("telefono", telefono);
                                                localStorage.setItem("correo", correo);
                                                app.views.main.router.navigate({name: 'menuDIPREC'});
                                                app.preloader.hide();
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        }
                    }
                    if(aux == 0){
                        app.preloader.hide();
                        swal("Cliente no encontrado", "No se tiene registro de ese cliente, Por favor sincroniza tus datos!" ,"error");
                    }
                });
            } else {
                swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        }
    }
    function generarReporteTecnico(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let atencion = localStorage.getItem("atencion");
        let direccion = localStorage.getItem("direccion");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        let tipoCedula = "reporteTecnico";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addReporteTecnico(id_cedula,foto_llegada,nombre_cliente,direccion,telefono,atencion,correo);
                        app.views.main.router.navigate({name: 'recorridoDIPREC1'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedDIPREC(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoDIPREC1'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoDIPREC3'});
        }
    }
    
    function guardarDatosReporteTecnicoDIPREC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#atencion").val() == "" || $("#direccion").val() == "" || $("#telefono").val() == "" || $("#correo").val() == "" || $("#tipoServicio").val() == 0){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var cliente = $("#nombreCliente").val();
        var atencion = $("#atencion").val();
        var direccion = $("#direccion").val();
        var telefono = $("#telefono").val();
        var correo = $("#correo").val();
        var tipoServicio = $("#tipoServicio").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicio_tecnico SET nombre_cliente = ?,atencion = ?,direccion = ?,telefono = ?,email = ?,tipo_servicio = ? WHERE id_cedula = ?",
                    [cliente,atencion,direccion,telefono,correo,tipoServicio,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#atencion").css("background-color", "#FFFFFF");
                        $("#direccion").css("background-color", "#FFFFFF");
                        $("#telefono").css("background-color", "#FFFFFF");
                        $("#correo").css("background-color", "#FFFFFF");
                        $("#tipoServicio").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function guardarEquipoDIPREC(){
        app.preloader.show('blue');
        if($("#nombreEquipo").val() == "" || $('#marca').val() == "0" || $('#modelo').val() == ""  || $('#noSerie').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var equipo = $("#nombreEquipo").val();
        var marca = $('#marca').val();
        var modelo = $('#modelo').val();
        var noSerie = $('#noSerie').val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fase = 'antes';
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        //-------------
        databaseHandler.db.transaction(
            function(tx1){
                tx1.executeSql(
                    "Select * from datos_equipo where equipo = ? AND marca = ? AND modelo = ? AND no_serie = ? AND id_cedula = ?",
                    [equipo,marca,modelo,noSerie,id_cedula],
                    function(tx, results){
                        var length = results.rows.length;
                        if(length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO datos_equipo(id_cedula,equipo,marca,modelo,no_serie,fecha_registro) VALUES (?,?,?,?,?,?)",
                                        [id_cedula,equipo,marca,modelo,noSerie,fecha_registro],
                                        function(tx, results){
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("INSERT INTO evidencia_equipo(id_cedula,fase,foto,equipo,fecha_regristro) VALUES (?,?,?,?,?)",
                                                        [id_cedula,fase,foto,equipo,fecha_registro],
                                                        function(tx, results){
                                                            app.preloader.hide();
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("Select MAX(id_foto) as Id from evidencia_equipo",
                                                                        [],
                                                                        function(tx, results){
                                                                            var item = results.rows.item(0);
                                                                            var id_evidencia = item.Id;
                                                                            app.preloader.hide();
                                                                            //Consultar el producto
                                                                            databaseHandler.db.transaction(
                                                                                function(tx){
                                                                                    tx.executeSql("Select * from evidencia_equipo where id_foto = ?",
                                                                                    [id_evidencia],
                                                                                        function(tx, results){
                                                                                            var item = results.rows.item(0);
                                                                                            $("#smallImage").attr("src","img/blank.png");
                                                                                            $('#imagenC').val("");
                                                                                            $("#photoIcon").attr("src","img/camera.svg");
                    
                                                                                            $("#nombreEquipo").css("background-color", "#FFFFFF");
                                                                                            $("#marca").css("background-color", "#FFFFFF");
                                                                                            $("#modelo").css("background-color", "#FFFFFF");
                                                                                            $("#noSerie").css("background-color", "#FFFFFF");
                    
                                                                                            $("#tabla_reporteTecnico tbody").append("<tr id='fila"+ item.id_foto +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.equipo) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                                            $("#message-nr").css("display", "none");
                                                                                            $('.preloader').remove();
                                                                                            $('.infinite-scroll-preloader').remove();
                                                                                            app.preloader.hide();
                                                                                        },
                                                                                        function(tx, error){
                                                                                            console.log("Error al guardar cedula: " + error.message);
                                                                                            app.preloader.hide();
                                                                                        }
                                                                                    );
                                                                                },
                                                                                function(error){},
                                                                                function(){}
                                                                            );
                                                                        },
                                                                        function(tx, error){
                                                                            swal("Error al mostrar el registro guardada",error.message,"error");
                                                                            app.preloader.hide();
                                                                        }
                                                                    );
                                                                },
                                                                function(error){},
                                                                function(){}
                                                            );
                                                            swal("","Registro guardado","success");
                                                            app.preloader.hide();
                                                        },
                                                        function(tx, error){
                                                            swal("Error al guardar plaga",error.message,"error");
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        } else {
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO evidencia_equipo(id_cedula,fase,foto,equipo,fecha_regristro) VALUES (?,?,?,?,?)",
                                        [id_cedula,fase,foto,equipo,fecha_registro],
                                        function(tx, results){
                                            app.preloader.hide();
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select MAX(id_foto) as Id from evidencia_equipo",
                                                        [],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            var id_evidencia = item.Id;
                                                            app.preloader.hide();
                                                            //Consultar el producto
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("Select * from evidencia_equipo where id_foto = ?",
                                                                    [id_evidencia],
                                                                        function(tx, results){
                                                                            var item = results.rows.item(0);
                                                                            $("#smallImage").attr("src","img/blank.png");
                                                                            $('#imagenC').val("");
                                                                            $("#photoIcon").attr("src","img/camera.svg");
    
                                                                            $("#nombreEquipo").css("background-color", "#FFFFFF");
                                                                            $("#marca").css("background-color", "#FFFFFF");
                                                                            $("#modelo").css("background-color", "#FFFFFF");
                                                                            $("#noSerie").css("background-color", "#FFFFFF");
    
                                                                            $("#tabla_reporteTecnico tbody").append("<tr id='fila"+ item.id_foto +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.equipo) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                            $("#message-nr").css("display", "none");
                                                                            $('.preloader').remove();
                                                                            $('.infinite-scroll-preloader').remove();
                                                                            app.preloader.hide();
                                                                        },
                                                                        function(tx, error){
                                                                            console.log("Error al guardar cedula: " + error.message);
                                                                            app.preloader.hide();
                                                                        }
                                                                    );
                                                                },
                                                                function(error){},
                                                                function(){}
                                                            );
                                                        },
                                                        function(tx, error){
                                                            swal("Error al mostrar el registro guardada",error.message,"error");
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                            swal("","Registro guardado","success");
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            swal("Error al guardar plaga",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        }
                    },
                    function(tx, error){
                        console.log("Error al consultar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function eliminarFilaDIPREC(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_equipo WHERE id_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_refacciones WHERE id_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM zonas_coordinador WHERE id_zona = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 4) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM equipos_coordinador WHERE id_equipo = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 5) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM observaciones WHERE id_acuerdo = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 6) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM notas WHERE id_nota = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarRevisionDiprec(){
        app.preloader.show('blue');
        // if($("#equipo").val() == "0" || $('#voltaje').val() == "" || ($("#voltaje1").prop("checked") == false && $("#voltaje2").prop("checked") == false) || $('#imagenC1').val() == "" || $('#corriente').val() == "" || ($("#corriente1").prop("checked") == false && $("#corriente2").prop("checked") == false) || $('#imagenC2').val() == "" || $('#fase').val() == "" || ($("#fase1").prop("checked") == false && $("#fase2").prop("checked") == false) || $('#imagenC3').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#presiongas').val() == "" || ($("#presiongas1").prop("checked") == false && $("#presiongas2").prop("checked") == false) || $('#imagenC5').val() == "" || $('#presionvapor').val() == "" || ($("#presionvapor1").prop("checked") == false && $("#presionvapor2").prop("checked") == false) || $('#imagenC6').val() == "" || $('#temperaturaequipo').val() == "" || ($("#temperaturaequipo1").prop("checked") == false && $("#temperaturaequipo2").prop("checked") == false) || $('#imagenC7').val() == "" || $('#fallareportada').val() == ""){
        if($("#equipo").val() == "0"){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var equipo = $("#equipo").val();
        var voltajeT = $("#voltaje").val();
        if($("#voltaje1").prop("checked") == true){
            var voltajeC = "1";
        } else if($("#voltaje0").prop("checked")){
            var voltajeC = "0";
        }
        var voltajeF = $('#imagenC1').val();
        var corrienteT = $("#corriente").val();
        if($("#corriente1").prop("checked") == true){
            var corrienteC = "1";
        } else if($("#corriente0").prop("checked")){
            var corrienteC = "0";
        }
        var corrienteF = $('#imagenC2').val();

        var faseT = $("#fase").val();
        if($("#fase1").prop("checked") == true){
            var faseC = "1";
        } else if($("#fase0").prop("checked")){
            var faseC = "0";
        }
        var faseF = $('#imagenC3').val();
        var tipogasT = $("#tipogas").val();
        if($("#tipogas1").prop("checked") == true){
            var tipogasC = "1";
        } else if($("#tipogas0").prop("checked")){
            var tipogasC = "0";
        }
        var tipogasF = $('#imagenC4').val();
        var presiongasT = $("#presiongas").val();
        if($("#presiongas1").prop("checked") == true){
            var presiongasC = "1";
        } else if($("#presiongas0").prop("checked")){
            var presiongasC = "0";
        }
        var presiongasF = $('#imagenC5').val();
        var presionvaporT = $("#presionvapor").val();
        if($("#presionvapor1").prop("checked") == true){
            var presionvaporC = "1";
        } else if($("#presionvapor0").prop("checked")){
            var presionvaporC = "0";
        }
        var presionvaporF = $('#imagenC6').val();
        var temperaturaequipoT = $("#temperaturaequipo").val();
        if($("#temperaturaequipo1").prop("checked") == true){
            var temperaturaequipoC = "1";
        } else if($("#temperaturaequipo0").prop("checked")){
            var temperaturaequipoC = "0";
        }
        var temperaturaequipoF = $('#imagenC7').val();
        var fallareportada = $('#fallareportada').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_equipo_antes(id_cedula,equipo,voltaje,estado_voltaje,evidencia_voltaje,corriente,estado_corriente,evidencia_corriente,fases,estado_fase,evidencia_fase,tipo_gas,estado_gas,evidencia_gas,presion_gas,estado_presion_gas,evidencia_presion_gas,presion_vapor,estado_presion_vapor,evidencia_presion_vapor,temperatura,estado_temperatura,evidencia_estado_temperatura,falla_reportada) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,equipo,voltajeT,voltajeC,voltajeF,corrienteT,corrienteC,corrienteF,faseT,faseC,faseF,tipogasT,tipogasC,tipogasF,presiongasT,presiongasC,presiongasF,presionvaporT,presionvaporC,presionvaporF,temperaturaequipoT,temperaturaequipoC,temperaturaequipoF,fallareportada],
                    function(tx, results){
                        swal("","Evidencia del equipo Guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function guardarRefaccionDIPREC(){
        app.preloader.show('blue');
        if($("#refaccion").val() == "0" || $('#clave').val() == "" || $('#cantidad').val() == "" || $('#descripcion').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var refacion= $('#refaccion').val()
        var clave= $('#clave').val()
        var cantidad= $('#cantidad').val()
        var descripcion= $('#descripcion').val()
        var foto = $('#imagenC').val()
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_refacciones(id_cedula,fase,clave,cantidad,descripcion,foto,fecha_regristro) VALUES (?,?,?,?,?,?,?)",
                    [id_cedula,refacion,clave,cantidad,descripcion,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_foto) as Id from evidencia_refacciones",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_refacciones where id_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#refacion").val("");
                                                        $("#clave").val("");
                                                        $("#cantidad").val("");
                                                        $("#descripcion").val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#tabla_refacciones tbody").append("<tr id='fila"+ item.id_foto +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.clave) + "</td><td style='text-align: center;'>" + unescape(item.cantidad) + "</td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar el registro guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado exitosamente","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarActividadesDIPREC(){
        var id_cedula = localStorage.getItem("IdCedula");
        app.preloader.show('blue');
        if($("#equipo").val() == "0" || ($('#recorrido1').prop("checked") == false && $('#recorrido2').prop("checked") == false)){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        if($('#recorrido2').prop("checked") == true){
            if(($("#valvulas1").prop("checked") == true || $("#valvulas0").prop("checked") == true) && ($("#termostato1").prop("checked") == true || $("#termostato0").prop("checked") == true) && ($("#controlpresion1").prop("checked") == true || $("#controlpresion0").prop("checked") == true) && ($("#quemador1").prop("checked") == true || $("#quemador0").prop("checked") == true) && ($("#turbinas1").prop("checked") == true || $("#turbinas0").prop("checked") == true) && ($("#resistencias1").prop("checked") == true || $("#resistencias0").prop("checked") == true) && ($("#sondas1").prop("checked") == true || $("#sondas0").prop("checked") == true) && ($("#tarjetaselectronicas1").prop("checked") == true || $("#tarjetaselectronicas0").prop("checked") == true) && ($("#compresor1").prop("checked") == true || $("#compresor0").prop("checked") == true) && ($("#motordifusores1").prop("checked") == true || $("#motordifusores0").prop("checked") == true) && ($("#aspasmotor1").prop("checked") == true || $("#aspasmotor0").prop("checked") == true) && ($("#contactores1").prop("checked") == true || $("#contactores0").prop("checked") == true) && ($("#fugatuberia1").prop("checked") == true || $("#fugatuberia0").prop("checked") == true) && ($("#aislantetuberia1").prop("checked") == true || $("#aislantetuberia0").prop("checked") == true) && ($("#condensador1").prop("checked") == true || $("#condensador0").prop("checked") == true) && ($("#iluminacion1").prop("checked") == true || $("#iluminacion0").prop("checked") == true) && ($("#empaques1").prop("checked") == true || $("#empaques0").prop("checked") == true) && ($("#fugagas1").prop("checked") == true || $("#fugagas0").prop("checked") == true)){
                
            } else {
                swal("","Todos los campos son requeridos","warning");
                app.preloader.hide();
                return false;
            }
        }
        var equipo = $('#equipo').val()
        if($("#gabineteexterior").prop("checked") == true){
            var gabineteexteriorC = "1";
        } else {
            var gabineteexteriorC = "0";
        }
        if($("#gabineteinterior").prop("checked") == true){
            var gabineteinteriorC = "1";
        } else {
            var gabineteinteriorC = "0";
        }
        if($("#paneles").prop("checked") == true){
            var panelesC = "1";
        } else {
            var panelesC = "0";
        }
        if($("#quemadores").prop("checked") == true){
            var quemadoresC = "1";
        } else {
            var quemadoresC = "0";
        }
        if($("#parrillas").prop("checked") == true){
            var parrillasC = "1";
        } else {
            var parrillasC = "0";
        }
        if($("#vulvasespreas").prop("checked") == true){
            var vulvasespreasC = "1";
        } else {
            var vulvasespreasC = "0";
        }
        if($("#panelescontrol").prop("checked") == true){
            var panelescontrolC = "1";
        } else {
            var panelescontrolC = "0";
        }
        if($("#condensador").prop("checked") == true){
            var condensadorC = "1";
        } else {
            var condensadorC = "0";
        }
        if($("#evaporador").prop("checked") == true){
            var evaporadorC = "1";
        } else {
            var evaporadorC = "0";
        }
        if($("#motoresaspas").prop("checked") == true){
            var motoresaspasC = "1";
        } else {
            var motoresaspasC = "0";
        }
        if($("#compresor").prop("checked") == true){
            var compresorC = "1";
        } else {
            var compresorC = "0";
        }
        if($("#flautas").prop("checked") == true){
            var flautasC = "1";
        } else {
            var flautasC = "0";
        }
        if($("#sistemahidraulico").prop("checked") == true){
            var sistemahidraulicoC = "1";
        } else {
            var sistemahidraulicoC = "0";
        }
        if($("#sistemalavado").prop("checked") == true){
            var sistemalavadoC = "1";
        } else {
            var sistemalavadoC = "0";
        }
        if($("#empaques").prop("checked") == true){
            var empaquesC = "1";
        } else {
            var empaquesC = "0";
        }
        if($("#deteccionfugas").prop("checked") == true){
            var deteccionfugasC = "1";
        } else {
            var deteccionfugasC = "0";
        }
        if($("#ajusteelectrico").prop("checked") == true){
            var ajusteelectricoC = "1";
        } else {
            var ajusteelectricoC = "0";
        }
        if($("#lubricacionmovil").prop("checked") == true){
            var lubricacionmovilC = "1";
        } else {
            var lubricacionmovilC = "0";
        }
        if($("#revisionmodos").prop("checked") == true){
            var revisionmodosC = "1";
        } else {
            var revisionmodosC = "0";
        }
        if($("#filtroaire").prop("checked") == true){
            var filtroaireC = "1";
        } else {
            var filtroaireC = "0";
        }
        if($("#valvulas1").prop("checked") == true){
            var valvulasS = "1";
        } else if($("#valvulas0").prop("checked")){
            var valvulasS = "0";
        }
        if($("#termostato1").prop("checked") == true){
            var termostatoS = "1";
        } else if($("#termostato0").prop("checked")){
            var termostatoS = "0";
        }
        if($("#controlpresion1").prop("checked") == true){
            var controlpresionS = "1";
        } else if($("#controlpresion0").prop("checked")){
            var controlpresionS = "0";
        }
        if($("#sensorflama1").prop("checked") == true){
            var sensorflamaS = "1";
        } else if($("#sensorflama0").prop("checked")){
            var sensorflamaS = "0";
        }
        if($("#quemador1").prop("checked") == true){
            var quemadorS = "1";
        } else if($("#quemador0").prop("checked")){
            var quemadorS = "0";
        }
        if($("#turbinas1").prop("checked") == true){
            var turbinasS = "1";
        } else if($("#turbinas0").prop("checked")){
            var turbinasS = "0";
        }
        if($("#resistencias1").prop("checked") == true){
            var resistenciasS = "1";
        } else if($("#resistencias0").prop("checked")){
            var resistenciasS = "0";
        }
        if($("#sondas1").prop("checked") == true){
            var sondasS = "1";
        } else if($("#sondas0").prop("checked")){
            var sondasS = "0";
        }
        if($("#tarjetaselectronicas1").prop("checked") == true){
            var tarjetaselectronicasS = "1";
        } else if($("#tarjetaselectronicas0").prop("checked")){
            var tarjetaselectronicasS = "0";
        }
        if($("#compresor1").prop("checked") == true){
            var compresorS = "1";
        } else if($("#compresor0").prop("checked")){
            var compresorS = "0";
        }
        if($("#motordifusores1").prop("checked") == true){
            var motordifusoresS = "1";
        } else if($("#motordifusores0").prop("checked")){
            var motordifusoresS = "0";
        }
        if($("#aspasmotor1").prop("checked") == true){
            var aspasmotorS = "1";
        } else if($("#aspasmotor0").prop("checked")){
            var aspasmotorS = "0";
        }
        if($("#contactores1").prop("checked") == true){
            var contactoresS = "1";
        } else if($("#contactores0").prop("checked")){
            var contactoresS = "0";
        }
        if($("#fugatuberia1").prop("checked") == true){
            var fugatuberiaS = "1";
        } else if($("#fugatuberia0").prop("checked")){
            var fugatuberiaS= "0";
        }
        if($("#aislantetuberia1").prop("checked") == true){
            var aislantetuberiaS = "1";
        } else if($("#aislantetuberia1").prop("checked")){
            var aislantetuberiaS = "0";
        }
        if($("#condensador1").prop("checked") == true){
            var condensadorS = "1";
        } else if($("#condensador0").prop("checked")){
            var condensadorS = "0";
        }
        if($("#iluminacion1").prop("checked") == true){
            var iluminacionS = "1";
        } else if($("#iluminacion0").prop("checked")){
            var iluminacionS = "0";
        }
        if($("#empaques1").prop("checked") == true){
            var empaquesS = "1";
        } else if($("#empaques0").prop("checked")){
            var empaquesS = "0";
        }
        if($("#fugagas1").prop("checked") == true){
            var fugagaS = "1";
        } else if($("#fugagas0").prop("checked")){
            var fugagaS = "0";
        }
        if($("#fugagas1").prop("checked") == true){
            var valvulasS = "1";
        } else if($("#fugagas0").prop("checked")){
            var valvulasS = "0";
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO check_list(id_cedula,equipo,gabinete_exterior,gabinete_interior,quemadores,paneles,parillas,vulvas_espreas,paneles_control,condensador,evaporador,motores,compresor,flautas,sistema_hidraulico,sistema_lavado,empaques,dereccion_fugas,ajuste_electrico,libricacion,revision_operacion,filtro_aire) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,equipo,gabineteexteriorC,gabineteinteriorC,quemadoresC,panelesC,parrillasC,vulvasespreasC,panelescontrolC,condensadorC,evaporadorC,motoresaspasC,compresorC,flautasC,sistemahidraulicoC,sistemalavadoC,empaquesC,deteccionfugasC,ajusteelectricoC,lubricacionmovilC,revisionmodosC,filtroaireC],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO check_list2(id_cedula,equipo,vulvas,termostato,control_presion,sensor_flama,quemadores,turbinas,resistencias,sondas,tarjeta_electronica,compresor,motor_difusores,aspas,contractores,fuga_tuberia,aislante_tuberia,condfensador,iluminacion,empaques,fuga) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                                    [id_cedula,equipo,valvulasS,termostatoS,controlpresionS,sensorflamaS,quemadorS,turbinasS,resistenciasS,sondasS,tarjetaselectronicasS,compresorS,motordifusoresS,aspasmotorS,contactoresS,fugatuberiaS,aislantetuberiaS,condensadorS,iluminacionS,empaquesS,fugagaS],
                                    function(tx, results){
                                        swal("","Comprobacion Guardada","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar el registro",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarEquipoDespuesDIPREC(){
        app.preloader.show('blue');
        if($("#equipo").val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var equipo = $("#equipo").val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fase = 'despues';
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_equipo(id_cedula,fase,foto,equipo,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto,equipo,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_foto) as Id from evidencia_equipo",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_equipo where id_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#tabla_equipo_despues tbody").append("<tr id='fila"+ item.id_foto +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.equipo) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar el registro guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarRevisionDespuesDiprec(){
        app.preloader.show('blue');
        // if($("#equipo").val() == "0" || $('#voltaje').val() == "" || ($("#voltaje1").prop("checked") == false && $("#voltaje2").prop("checked") == false) || $('#imagenC1').val() == "" || $('#corriente').val() == "" || ($("#corriente1").prop("checked") == false && $("#corriente2").prop("checked") == false) || $('#imagenC2').val() == "" || $('#fase').val() == "" || ($("#fase1").prop("checked") == false && $("#fase2").prop("checked") == false) || $('#imagenC3').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#presiongas').val() == "" || ($("#presiongas1").prop("checked") == false && $("#presiongas2").prop("checked") == false) || $('#imagenC5').val() == "" || $('#presionvapor').val() == "" || ($("#presionvapor1").prop("checked") == false && $("#presionvapor2").prop("checked") == false) || $('#imagenC6').val() == "" || $('#temperaturaequipo').val() == "" || ($("#temperaturaequipo1").prop("checked") == false && $("#temperaturaequipo2").prop("checked") == false) || $('#imagenC7').val() == "" || $('#fallareportada').val() == ""){
        if($("#equipo").val() == "0"){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var equipo = $("#equipo").val();
        var voltajeT = $("#voltaje").val();
        if($("#voltaje1").prop("checked") == true){
            var voltajeC = "1";
        } else if($("#voltaje0").prop("checked")){
            var voltajeC = "0";
        }
        var voltajeF = $('#imagenC1').val();
        var corrienteT = $("#corriente").val();
        if($("#corriente1").prop("checked") == true){
            var corrienteC = "1";
        } else if($("#corriente0").prop("checked")){
            var corrienteC = "0";
        }
        var corrienteF = $('#imagenC2').val();

        var faseT = $("#fase").val();
        if($("#fase1").prop("checked") == true){
            var faseC = "1";
        } else if($("#fase0").prop("checked")){
            var faseC = "0";
        }
        var faseF = $('#imagenC3').val();
        var tipogasT = $("#tipogas").val();
        if($("#tipogas1").prop("checked") == true){
            var tipogasC = "1";
        } else if($("#tipogas0").prop("checked")){
            var tipogasC = "0";
        }
        var tipogasF = $('#imagenC4').val();
        var presiongasT = $("#presiongas").val();
        if($("#presiongas1").prop("checked") == true){
            var presiongasC = "1";
        } else if($("#presiongas0").prop("checked")){
            var presiongasC = "0";
        }
        var presiongasF = $('#imagenC5').val();
        var presionvaporT = $("#presionvapor").val();
        if($("#presionvapor1").prop("checked") == true){
            var presionvaporC = "1";
        } else if($("#presionvapor0").prop("checked")){
            var presionvaporC = "0";
        }
        var presionvaporF = $('#imagenC6').val();
        var temperaturaequipoT = $("#temperaturaequipo").val();
        if($("#temperaturaequipo1").prop("checked") == true){
            var temperaturaequipoC = "1";
        } else if($("#temperaturaequipo0").prop("checked")){
            var temperaturaequipoC = "0";
        }
        var temperaturaequipoF = $('#imagenC7').val();
        var fallareportada = $('#fallareportada').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_equipo_despues(id_cedula,equipo,voltaje,estado_voltaje,evidencia_voltaje,corriente,estado_corriente,evidencia_corriente,fases,estado_fase,evidencia_fase,tipo_gas,estado_gas,evidencia_gas,presion_gas,estado_presion_gas,evidencia_presion_gas,presion_vapor,estado_presion_vapor,evidencia_presion_vapor,temperatura,estado_temperatura,evidencia_estado_temperatura,falla_reportada) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,equipo,voltajeT,voltajeC,voltajeF,corrienteT,corrienteC,corrienteF,faseT,faseC,faseF,tipogasT,tipogasC,tipogasF,presiongasT,presiongasC,presiongasF,presionvaporT,presionvaporC,presionvaporF,temperaturaequipoT,temperaturaequipoC,temperaturaequipoF,fallareportada],
                    function(tx, results){
                        app.preloader.hide();
                        swal("","Evidencia del equipo Guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreReporteDIPREC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == "" || $("#puesto").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var puesto = $("#puesto").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicio_tecnico SET firma_cliente = ?,fecha_cliente = ?,puesto = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,puesto,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyTecnicoDIPREC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function guardarCierreMinutaDIPREC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#puesto").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        } else {
            if($("#coordinadorobra").text() == 'Entrega'){
                if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
                    swal("","Por favor, ingresa el motivo de tu calificacion","warning");
                    return false;
                }
            } else {
                
            }
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        if($("#coordinadorobra").text() == 'Entrega'){
            var calificacion = $("#eval").val(); 
            var comentarioCliente = $('#comentario_cliente').val(); 
        } else {
            var calificacion = "";
            var comentarioCliente = "";
        }
        
        var puesto = $("#puesto").val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE minuta_coordinador SET firma_cliente = ?,fecha_cliente = ?,puesto = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,puesto,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyCoordinadorDIPREC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarTecnicoDIPREC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicio_tecnico SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarMinutaCoordinador(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "minutaCoordinador";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addMinutaCoordinador(id_cedula,foto_llegada);
                        app.views.main.router.navigate({name: 'recorridoDIPREC3'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function guardarDatosMinutaCoordinadorDIPREC(){
        app.preloader.show('blue');
        if($("#empresa").val() =="0" || $("#coordinadorObra").val() == "0" || $("#nombreCliente").val() == "" || $("#proyecto").val() == "" || $("#coordinador").val() == "" || $("#direccion").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var empresa = $("#empresa").val();
        var coordinadorObra = $("#coordinadorObra").val();
        var nombreCliente = $("#nombreCliente").val();
        var proyecto = $("#proyecto").val();
        var coordinador = $("#coordinador").val();
        var direccion = $("#direccion").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ?,id_cliente = ? WHERE id_cedula = ?",
                    [nombreCliente,nombreCliente,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE minuta_coordinador SET empresa = ?,coordinador_obra = ?,nombre_cliente = ?,proyecto = ?,coordonador = ?,direccion = ? WHERE id_cedula = ?",
                                    [empresa,coordinadorObra,nombreCliente,proyecto,coordinador,direccion,id_cedula],
                                    function(tx, results){
                                        $("#empresa").css("background-color", "#FFFFFF");
                                        $("#coordinadorObra").css("background-color", "#FFFFFF");
                                        $("#nombreCliente").css("background-color", "#FFFFFF");
                                        $("#proyecto").css("background-color", "#FFFFFF");
                                        $("#coordinador").css("background-color", "#FFFFFF");
                                        $("#direccion").css("background-color", "#FFFFFF");
                                        swal("", "Se guardaron los datos correctamente" ,"success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function guardarZonaDIPREC(){
        app.preloader.show('blue');
        if($("#zona").val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var zona = $("#zona").val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO zonas_coordinador(id_cedula,nombre,foto,fecha_registro) VALUES (?,?,?,?)",
                    [id_cedula,zona,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_zona) as Id from zonas_coordinador",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from zonas_coordinador where id_zona = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#tabla_zona tbody").append("<tr id='fila"+ item.id_zona +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_zona +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.nombre) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function guardarEquipoCoordinadorDIPREC(){
        app.preloader.show('blue');
        if($("#zona").val() == "0" || $('#equipo').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var zona = $("#zona").val();
        var equipo = $("#equipo").val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO equipos_coordinador(id_cedula,zona,equipo,foto,fecha_registro) VALUES (?,?,?,?,?)",
                    [id_cedula,zona,equipo,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_equipo) as Id from equipos_coordinador",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from equipos_coordinador where id_equipo = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#tabla_equipo tbody").append("<tr id='fila"+ item.id_equipo +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_equipo +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.zona) + "</td><td style='text-align: center;'>" + unescape(item.equipo) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function guardarZonaEquipoDiprec(){
        app.preloader.show('blue');
        // if($("#zona").val() == "0" || $("#equipo").val() == "0" || $('#voltaje').val() == "" || ($("#voltaje1").prop("checked") == false && $("#voltaje2").prop("checked") == false) || $('#imagenC1').val() == "" || $('#corriente').val() == "" || ($("#corriente1").prop("checked") == false && $("#corriente2").prop("checked") == false) || $('#imagenC2').val() == "" || $('#fase').val() == "" || ($("#fase1").prop("checked") == false && $("#fase2").prop("checked") == false) || $('#imagenC3').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#presiongas').val() == "" || ($("#presiongas1").prop("checked") == false && $("#presiongas2").prop("checked") == false) || $('#imagenC5').val() == "" || $('#presionvapor').val() == "" || ($("#presionvapor1").prop("checked") == false && $("#presionvapor2").prop("checked") == false) || $('#imagenC6').val() == "" || $('#temperaturaequipo').val() == "" || ($("#temperaturaequipo1").prop("checked") == false && $("#temperaturaequipo2").prop("checked") == false) || $('#imagenC7').val() == "" || $('#fallareportada').val() == ""){
        if($("#zona").val() == "0" || $("#equipo").val() == "0"){
            swal("","Los campos de Zona y Equipo son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var zona = $("#zona").val();
        var equipo = $("#equipo").val();

        var voltajeT = $("#voltaje").val();
        if($("#voltaje1").prop("checked") == true){
            var voltajeC = "1";
        } else if($("#voltaje0").prop("checked")){
            var voltajeC = "0";
        }
        var voltajeF = $('#imagenC1').val();
        var corrienteT = $("#corriente").val();
        if($("#corriente1").prop("checked") == true){
            var corrienteC = "1";
        } else if($("#corriente0").prop("checked")){
            var corrienteC = "0";
        }
        var corrienteF = $('#imagenC2').val();

        var faseT = $("#fase").val();
        if($("#fase1").prop("checked") == true){
            var faseC = "1";
        } else if($("#fase0").prop("checked")){
            var faseC = "0";
        }
        var faseF = $('#imagenC3').val();
        var tipogasT = $("#tipogas").val();
        if($("#tipogas1").prop("checked") == true){
            var tipogasC = "1";
        } else if($("#tipogas0").prop("checked")){
            var tipogasC = "0";
        }
        var tipogasF = $('#imagenC4').val();
        var presiongasT = $("#presiongas").val();
        if($("#presiongas1").prop("checked") == true){
            var presiongasC = "1";
        } else if($("#presiongas0").prop("checked")){
            var presiongasC = "0";
        }
        var presiongasF = $('#imagenC5').val();
        var presionvaporT = $("#presionvapor").val();
        if($("#presionvapor1").prop("checked") == true){
            var presionvaporC = "1";
        } else if($("#presionvapor0").prop("checked")){
            var presionvaporC = "0";
        }
        var presionvaporF = $('#imagenC6').val();
        var temperaturaequipoT = $("#temperaturaequipo").val();
        if($("#temperaturaequipo1").prop("checked") == true){
            var temperaturaequipoC = "1";
        } else if($("#temperaturaequipo0").prop("checked")){
            var temperaturaequipoC = "0";
        }
        var temperaturaequipoF = $('#imagenC7').val();
        var fallareportada = $('#fallareportada').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_coordinador(id_cedula,zona,equipo,voltaje,estado_voltaje,evidencia_voltaje,corriente,estado_corriente,evidencia_corriente,fases,estado_fase,evidencia_fase,tipo_gas,estado_gas,evidencia_gas,presion_gas,estado_presion_gas,evidencia_presion_gas,presion_vapor,estado_presion_vapor,evidencia_presion_vapor,temperatura,estado_temperatura,evidencia_estado_temperatura,falla_reportada) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,zona,equipo,voltajeT,voltajeC,voltajeF,corrienteT,corrienteC,corrienteF,faseT,faseC,faseF,tipogasT,tipogasC,tipogasF,presiongasT,presiongasC,presiongasF,presionvaporT,presionvaporC,presionvaporF,temperaturaequipoT,temperaturaequipoC,temperaturaequipoF,fallareportada],
                    function(tx, results){
                        app.preloader.hide();
                        swal("","Evidencia del equipo Guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarObservacionesCoordinadorDIPREC(){
        app.preloader.show('blue');
        if($("#acuerdo").val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#sourceP").val() == "Subida"){
            var acuerdo = $("#acuerdo").val() + " #$ S";
        } else {
            var acuerdo = $("#acuerdo").val() + " #$ C";
        }
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO observaciones(id_cedula,acuerdo,foto,fecha_registro) VALUES (?,?,?,?)",
                    [id_cedula,acuerdo,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_acuerdo) as Id from observaciones",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from observaciones where id_acuerdo = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $('#acuerdo').val("");
                                                        $("#textInput").text("Seleccione");
                                                        $("#sourceP").text("Camera");
                                                        $("#acuerdo").css("background-color", "white");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        item.acuerdo = item.acuerdo.split("#$");
                                                        item.acuerdo = item.acuerdo[0];
                                                        $("#tabla_acuerdo tbody").append("<tr id='fila"+ item.id_acuerdo +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_acuerdo +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><a href='#' onclick='editarFilaDiprec("+ item.id_acuerdo +",1);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.acuerdo) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Acuerdo guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarNotasCoordinadorDIPREC(){
        app.preloader.show('blue');
        if($("#nota").val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#sourceP").val() == "Subida"){
            var nota = $("#nota").val() + " #$ S";
        } else {
            var nota = $("#nota").val() + " #$ C";
        }
        
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO notas(id_cedula,nota,foto,fecha_registro) VALUES (?,?,?,?)",
                    [id_cedula,nota,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_nota) as Id from notas",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from notas where id_nota = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#nota").val("");
                                                        $("#textInput").text("Seleccione");
                                                        $("#sourceP").text("Camera");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        item.nota = item.nota.split("#$");
                                                        item.nota = item.nota[0];
                                                        $("#tabla_notas tbody").append("<tr id='fila"+ item.id_nota +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_nota +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a><a href='#' onclick='editarFilaDiprec("+ item.id_nota +",2);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.nota) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Acuerdo guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function activarCheck1(valor){
        if($("#recorrido1").prop("checked") === true){
            $("#re1").css("display", "block");
        } else {
            $("#re1").css("display", "none");
        }
    }
    function activarCheck2(valor){
        if($("#recorrido2").prop("checked") === true){
            $("#re2").css("display", "block");
        } else {
            $("#re2").css("display", "none");
        }
    }
    function terminarCoordinadorDIPREC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE minuta_coordinador SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function editarFilaDiprec(index, opc){
        if(opc == 1){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "SELECT acuerdo FROM observaciones WHERE id_acuerdo = ?",
                        [index],
                        function(tx, results){
                            var item = results.rows.item(0);
                            dynamicPopup.open();
                            item.acuerdo = item.acuerdo.split("#$");
                            var estado = item.acuerdo[1];
                            item.acuerdo = item.acuerdo[0];
                            $("#edit").val(item.acuerdo);
                            $("#option").val(index + "," + opc + "," + estado);
                        },
                        function(tx, error){
                            swal("Error al actualizar el registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "SELECT nota FROM notas WHERE id_nota = ?",
                        [index],
                        function(tx, results){
                            var item = results.rows.item(0);
                            dynamicPopup.open();
                            item.nota = item.nota.split("#$");
                            var estado = item.nota[1];
                            item.nota = item.nota[0];
                            $("#edit").val(item.nota);
                            $("#option").val(index + "," + opc + "," + estado);
                        },
                        function(tx, error){
                            swal("Error al actualizar el registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } 
    }
    function FilaEditadaDiprec(){
        var options = $("#option").val();
        var opt = options.split(",");
        var text = $("#edit").val() + " #$ " + opt[2];
        if(opt[1] == 1){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE observaciones SET acuerdo = ? WHERE id_acuerdo = ?",
                        [text,opt[0]],
                        function(tx, results){
                            $("#tabla_acuerdo tbody").remove();
                            $("#tabla_acuerdo").append("<tbody></tbody>");
                            var id_cedula = localStorage.getItem("IdCedula");
                            databaseHandler.db.transaction(
                                function(tx1){
                                    tx1.executeSql(
                                        "Select * from observaciones where id_cedula= ?",
                                        [id_cedula],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            if(length == 0){
                                                $("#message-nr").css("display", "block");
                                            } else {
                                                for(var i = 0; i< length; i++){
                                                    var item = results.rows.item(i);
                                                    item.acuerdo = item.acuerdo.split("#$");
                                                    item.acuerdo = item.acuerdo[0];
                                                    $("#tabla_acuerdo tbody").append("<tr id='fila"+ item.id_acuerdo +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_acuerdo +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><a href='#' onclick='editarFilaDiprec("+ item.id_acuerdo +",1);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.acuerdo) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                    $("#message-nr").css("display", "none");
                                                    swal("", "Registro Actualizado Exitosamente!!" ,"success");
                                                }
                                            }
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                        },
                                        function(tx, error){
                                            console.log("Error al consultar: " + error.message);
                                        }
                                    );
                                    console.log("Consulta correcta");
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opt[1] == 2){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE notas SET nota = ? WHERE id_nota = ?",
                        [text,opt[0]],
                        function(tx, results){
                            $("#tabla_notas tbody").remove();
                            $("#tabla_notas").append("<tbody></tbody>");
                            var id_cedula = localStorage.getItem("IdCedula");
                            databaseHandler.db.transaction(
                                function(tx1){
                                    tx1.executeSql(
                                        "Select * from notas where id_cedula= ?",
                                        [id_cedula],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            if(length == 0){
                                                $("#message-nr").css("display", "block");
                                            } else {
                                                for(var i = 0; i< length; i++){
                                                    var item = results.rows.item(i);
                                                    item.nota = item.nota.split("#$");
                                                    item.nota = item.nota[0];
                                                    $("#tabla_notas tbody").append("<tr id='fila"+ item.id_nota +"'><td style='display: flex;flex-direction: row;justify-content: space-around;align-items: flex-end;padding:0;'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_nota +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a><a href='#' onclick='editarFilaDiprec("+ item.id_nota +",2);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.nota) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                    $("#message-nr").css("display", "none");
                                                    swal("", "Registro Actualizado Exitosamente!!" ,"success");
                                                }
                                            }
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                        },
                                        function(tx, error){
                                            console.log("Error al consultar: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function editarFilaSuro(index, opc){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "SELECT nombre_grupo FROM grupos WHERE id_grupo = ?",
                    [index],
                    function(tx, results){
                        var item = results.rows.item(0);
                        PopupSuro.open();
                        $("#edit").val(item.nombre_grupo);
                        $("#option").val(index + "," + opc);
                        $("#lastValue").val(item.nombre_grupo);
                    },
                    function(tx, error){
                        swal("Error al actualizar el registro",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function FilaEditadaSuro(){
        var id_cedula = localStorage.getItem("IdCedula");
        var options = $("#option").val();
        var toSearch = $("#lastValue").val();
        var opt = options.split(",");
        var text = $("#edit").val();
        if(opt[1] == 1){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE grupos SET nombre_grupo = ? WHERE id_grupo = ? AND id_cedula = ?",
                        [text,opt[0],id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE evidencia SET nombre_grupo = ? WHERE nombre_grupo = ? AND id_cedula = ? AND fases = 'durante'",
                                        [text,toSearch,id_cedula],
                                        function(tx, results){
                                            $("#tabla_grupos_uno tbody").remove();
                                            $("#tabla_grupos_uno").append("<tbody></tbody>");
                                            var id_cedula = localStorage.getItem("IdCedula");
                                            databaseHandler.db.transaction(
                                                function(tx1){
                                                    tx1.executeSql(
                                                        "Select * from grupos where id_cedula= ? AND fases = 'durante'",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            if(length == 0){
                                                                $("#message-nr").css("display", "block");
                                                            } else {
                                                                for(var i = 0; i< length; i++){
                                                                    var item = results.rows.item(i);
                                                                    $("#tabla_grupos_uno tbody").append("<tr id='fila"+ item.id_grupo +"'><td><a href='#' onclick='editarFilaSuro("+ item.id_grupo +",1);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td> " + item.nombre_grupo + "</td></tr>");
                                                                    $("#message-nr").css("display", "none");
                                                                    swal("", "Registro Actualizado Exitosamente!!" ,"success");
                                                                }
                                                            }
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al consultar: " + error.message);
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opt[1] == 2){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE grupos SET nombre_grupo = ? WHERE id_grupo = ? AND id_cedula = ?",
                        [text,opt[0],id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE evidencia SET nombre_grupo = ? WHERE nombre_grupo = ? AND id_cedula = ? AND fases = 'fomites'",
                                        [text,toSearch,id_cedula],
                                        function(tx, results){
                                            $("#tabla_grupos_dos tbody").remove();
                                            $("#tabla_grupos_dos").append("<tbody></tbody>");
                                            databaseHandler.db.transaction(
                                                function(tx1){
                                                    tx1.executeSql(
                                                        "Select * from grupos where id_cedula= ? AND fases = 'fomites'",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            if(length == 0){
                                                                $("#message-nr2").css("display", "block");
                                                            } else {
                                                                for(var i = 0; i< length; i++){
                                                                    var item = results.rows.item(i);
                                                                    $("#tabla_grupos_dos tbody").append("<tr id='fila"+ item.id_grupo +"'><td><a href='#' onclick='editarFilaSuro("+ item.id_grupo +",2);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td> " + item.nombre_grupo + "</td></tr>");
                                                                    $("#message-nr2").css("display", "none");
                                                                    swal("", "Registro Actualizado Exitosamente!!" ,"success");
                                                                }
                                                            }
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al consultar: " + error.message);
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    var dynamicPopup = app.popup.create({
        content: `
          <div class="popup FWM-half-modal">
            <div class="my-swipe-to-close-handler" style="padding-top:16px">
                <div class="FWM-bubble-close"></div>
            </div>
            <div class="block">
                <p style="margin:0">Edicion de registro:</p>
                <textarea class ="FWM-input-modal" id="edit" name="edit"  cols="30" rows="10"></textarea>
                <input type="hidden" id="option" name="option"/>
                <div class="FWM-button-modal-container">
                    <div class="FWM-button-modal popup-close" onclick="FilaEditadaDiprec()">Actualizar Registro</div>
                </div>
            </div>
          </div>
        `,
        swipeToClose: true,
        swipeHandler: '.my-swipe-to-close-handler',
        // Events
        on: {
          open: function (popup,text) {
            
          },
          opened: function (popup) {
            
          },
        }
    });
    dynamicPopup.on('close', function (popup) {});
    var PopupSuro = app.popup.create({
        content: `
          <div class="popup FWM-half-modal">
            <div class="my-swipe-to-close-handler" style="padding-top:16px">
                <div class="FWM-bubble-close"></div>
            </div>
            <div class="block">
                <p style="margin:0">Edicion de registro:</p>
                <textarea class ="FWM-input-modal" id="edit" name="edit"  cols="30" rows="10"></textarea>
                <input type="hidden" id="option" name="option"/>
                <input type="hidden" id="lastValue" name="lastValue"/>
                <div class="FWM-button-modal-container">
                    <div class="FWM-button-modal popup-close" onclick="FilaEditadaSuro()">Actualizar Registro</div>
                </div>
            </div>
          </div>
        `,
        swipeToClose: true,
        swipeHandler: '.my-swipe-to-close-handler',
        // Events
        on: {
          open: function (popup,text) {
            
          },
          opened: function (popup) {
            
          },
        }
    });
    PopupSuro.on('close', function (popup) {});
    function startFromProgramDIPREC(empresa,category,nombre_comercial,person_receive,direccion){
        localStorage.setItem("empresaD", empresa);
        localStorage.setItem("categoryD", category);
        localStorage.setItem("nombre_comercialD", nombre_comercial);
        localStorage.setItem("person_receiveD", person_receive);
        localStorage.setItem("direccionD", direccion);
        app.views.main.router.navigate({name: 'yallegueDIPREC2'});
    }
    function iniciarClienteDIPREC(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = localStorage.getItem("nombre_comercialD");
        var tipoCedula = "minutaCoordinador";
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                            [tipoCedula,id_cedula],
                                            function(tx, results){
                                                var empresa = localStorage.getItem("empresaD");
                                                if(empresa == "ZUBRAUN, S.A. DE C.V"){
                                                    empresa = 1;
                                                } else if(empresa == "GASTRO CHEF DE MEXICO S.A. DE C.V"){
                                                    empresa = 2;
                                                } else if(empresa == "DIPREC S.A. DE C.V"){
                                                    empresa = 3;
                                                }
                                                var coordinador_obra = localStorage.getItem("categoryD");
                                                if(coordinador_obra == "Levantamiento"){
                                                    coordinador_obra = 1;
                                                } else if(coordinador_obra == "Instalación"){
                                                    coordinador_obra = 2;
                                                } else if(coordinador_obra == "Avance de Obra"){
                                                    coordinador_obra = 3;
                                                } else if(coordinador_obra == "Reunión"){
                                                    coordinador_obra = 4;
                                                } else if(coordinador_obra == "Capacitación"){
                                                    coordinador_obra = 5;
                                                } else if(coordinador_obra =="Entrega"){
                                                    coordinador_obra = 6;
                                                }
                                                var nombre_cliente = localStorage.getItem("nombre_comercialD");
                                                var proyecto = localStorage.getItem("person_receiveD");
                                                var coordonador = nombre_usuario;
                                                var direccion = localStorage.getItem("direccionD");
                                                productHandler.addMinutaCoordinadorr(id_cedula,foto_llegada,empresa,coordinador_obra,nombre_cliente,proyecto,coordonador,direccion);
                                                app.views.main.router.back('/recorridoDIPREC3/', {force: true, ignoreCache: true, reload: true});
                                            },
                                            function(tx, error){
                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                                // app.views.main.router.navigate({name: 'menuSMC'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function uploadPicture(input){
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onloadend = function (e) {
                $("body").append("<canvas id='tempCanvas' width='800' height='800' style='display:none'></canvas>");
                var canvas = document.getElementById("tempCanvas");
                var ctx = canvas.getContext("2d");
                var maxW = 800;
                var maxH = 800;
                var img = new Image;
                img.src = this.result;
                img.onload = function(){
                    var iw = img.width;
                    var ih = img.height;
                    var scale = Math.min((maxW/iw),(maxH/ih));
                    var iwScaled = iw*scale;
                    var ihScaled = ih*scale;
                    canvas.width = iwScaled;
                    canvas.height = ihScaled;
                    ctx.drawImage(img,0,0,iwScaled,ihScaled);
                    var base64image = canvas.toDataURL("image/jpeg");
                    $("#imagenC").val(base64image);
                    $("#sourceP").val("Subida");
                    $("#textInput").text(input.files[0].name);
                    $("#tempCanvas").remove();
                }
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
    //DIPREC FIN
    //Inicio MerGroup
    function tracking1(){
        app.views.main.router.navigate({
            name: "tracking-1",
        });
    }
    function tracking2(){
        app.views.main.router.navigate({
            name: "tracking-2",
        });
    }
    function tracking3(){
        app.views.main.router.navigate({
            name: "tracking-3",
        });
    }
    function tracking4(){
        app.views.main.router.navigate({
            name: "tracking-4",
        });
    }
    function buscarClienteMerGroup(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#autocomplete-dropdown-ajax").val();
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                app.views.main.router.navigate({name: 'recorridoMerGroup'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function guardarObservacionesMer(){
        app.preloader.show('blue');
        if($("#titulo").val() == "" || $('#imagenC').val() == ""){
            swal("","El titulo y la fotografia son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var titulo = $("#titulo").val();
        var observacion = $("#observacion").val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidenciaFotografica(id_cedula,titulo,observacion,foto,fecha_registro) VALUES (?,?,?,?,?)",
                    [id_cedula,titulo,observacion,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidenciaFotografica",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidenciaFotografica where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $('#imagenC').val("");
                                                        $("#titulo").val("");
                                                        $("#observacion").val("");
                                                        $("#titulo").css("background-color", "#FFFFFF");
                                                        $("#observacion").css("background-color", "#FFFFFF");
                                                        $("#tabla_evidencias tbody").append("<tr id='fila"+ item.id_evidencia +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_evidencia +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.titulo) + "</td><td style='text-align: center;'>" + unescape(item.observacion) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Acuerdo guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreFotografiaMer(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE reporteFotografico SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyMerGroup/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarReporteMer(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE reporteFotografico SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    //Fin MerGroup
    //Inicio PlatoLimpio
    function buscarClientePlatoLimpio(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#autocomplete-dropdown-ajax").val();
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                app.views.main.router.navigate({name: 'menuPlatoLimpio'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarCicloCharola() {
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let foto_llegada = localStorage.getItem("foto_llegada");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        let tipoCedula = "Plato Limpio";
        let direccion = localStorage.getItem("direccion");
        let correo = localStorage.getItem("correo");
        let sucursal = localStorage.getItem("sucursal");
        let proceso = 0;
        let recorrido = 0;
        let titulo = "foto_llegada";
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula, id_cedula],
                    function (tx, results) {
                        productHandler.addPL(id_cedula, nombre_cliente, correo);
                        productHandler.PLFotos(id_cedula, recorrido, proceso, fecha_llegada, titulo, foto_llegada);
                        app.views.main.router.navigate({ name: 'recorridoPL1' });
    
                    },
                    function (tx, error) {
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function (error) { },
            function () { }
        );
    
    }
    function FactorHumano(){
        app.views.main.router.navigate({name: 'recorridoPL2'});
    }
    function SanitizacionLava(){
        app.views.main.router.navigate({name: 'recorridoPL3'});
    }
    function regresarRecorridoPL1(){
        app.views.main.router.back('/recorridoPL1/', {force: true, ignoreCache: true, reload: true});
    }
    function terminarCiclo1(){
        app.views.main.router.back('/menuPlatoLimpio/', {force: true, ignoreCache: true, reload: true});
    }
    //Fin PlatoLimpio
    // Inicio ServInd
    function iniciarClienteServ(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_visita = localStorage.getItem("id_visita");
        var id_cliente = localStorage.getItem("id_cliente");
        var orden_servicio = localStorage.getItem("orden_servicio");
        var nombre_comercial = localStorage.getItem("nombre_comercial");
        var sucursal = localStorage.getItem("sucursal");
        var nombre_cliente = localStorage.getItem("nombre_comercial");
        var direccion = localStorage.getItem("direccionD");
        var ciudad = localStorage.getItem("ciudad");
        var telefono = localStorage.getItem("telefono");
        var correo = localStorage.getItem("correo");
        var tipo = localStorage.getItem("category");
        if(tipo == "General"){
            var tipoCedula = "reporteGeneral";
        } else if(tipo == "Checklist"){
            var tipoCedula = "checklistServ";
        }
        var equip = localStorage.getItem("equip");
        var mark = localStorage.getItem("mark");
        var model = localStorage.getItem("model");
        var serie = localStorage.getItem("serie");
        var horario_programado = localStorage.getItem("horario_programado");
        var razon_servicio = localStorage.getItem("razon_servicio");
        var foto_llegada = $("#imagenC").val();
        var estatus = 0;
        if(foto_llegada != ''){
            productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                tipo == "General"
                                if(tipo == "General"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addreporteGeneral(id_cedula,id_visita,orden_servicio,foto_llegada,nombre_cliente,nombre_comercial,sucursal,direccion,ciudad,telefono,correo,equip,mark,model,serie,tipoCedula,razon_servicio);
                                                    app.views.main.router.back('/recorridoServ2/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                } else if(tipo == "Checklist"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addCheckServInd(id_cedula,id_visita,orden_servicio,foto_llegada,nombre_cliente,nombre_comercial,sucursal,ciudad,direccion);
                                                    app.views.main.router.back('/recorridoServ1/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function iniciarClienteMer(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = localStorage.getItem("id_cliente");
        var sucursal = localStorage.getItem("sucursal");
        var nombre_cliente = localStorage.getItem("nombre_comercial") + " " + sucursal;
        var tipo = localStorage.getItem("category");
        var estatus = 0;

        var id_visita = localStorage.getItem("id_visita");
        var foto_llegada = $("#imagenC").val();
        var orden_compra = localStorage.getItem("orden_servicio");
        var proyecto = localStorage.getItem("nombre_comercial")
        var contratista = localStorage.getItem("contratista");


        var type_proyect = localStorage.getItem("type_proyect");
        var region = localStorage.getItem("region");
        var torre = localStorage.getItem("tower");
        var proceso = localStorage.getItem("category");

        var tipo = "reporteFotografico";

        if(foto_llegada != ''){
            productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,fecha_llegada,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                            [tipo,id_cedula],
                                            function(tx, results){
                                                productHandler.addreporteFotografico(id_cedula,id_visita,foto_llegada,orden_compra,proyecto,sucursal,contratista,type_proyect,region,torre,proceso);
                                                app.views.main.router.back('/recorridoMerGroup/', {force: true, ignoreCache: true, reload: true});
                                            },
                                            function(tx, error){
                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function startFromProgramServ(id_visita,nombre_comercial,orden_servicio,sucursal,direccion,ciudad,telefono,correo,category,equip,mark,model,serie,id_cliente,horario_programado,razon_servicio){
        localStorage.setItem("id_visita", id_visita);
        localStorage.setItem("nombre_comercial", nombre_comercial);
        localStorage.setItem("orden_servicio", orden_servicio);
        localStorage.setItem("sucursal", sucursal);
        localStorage.setItem("direccionD", direccion);
        localStorage.setItem("ciudad", ciudad);
        localStorage.setItem("telefono", telefono);
        localStorage.setItem("correo", correo);
        localStorage.setItem("category", category);
        localStorage.setItem("equip", equip);
        localStorage.setItem("mark", mark);
        localStorage.setItem("model", model);
        localStorage.setItem("serie", serie);
        localStorage.setItem("id_cliente", id_cliente);
        localStorage.setItem("horario_programado", horario_programado);
        localStorage.setItem("razon_servicio", razon_servicio);
        app.views.main.router.back('/yallegueServInd2/', {force: true, ignoreCache: true, reload: true});
    }

    function startFromProgramMer(id_visita,proyecto,sucursal,numero_orden,contratista,type_proyect,category,region,tower,id_cliente){
        localStorage.setItem("id_visita", id_visita);
        localStorage.setItem("nombre_comercial", proyecto);
        localStorage.setItem("orden_servicio", numero_orden);
        localStorage.setItem("sucursal", sucursal);
        localStorage.setItem("contratista", contratista);
        localStorage.setItem("type_proyect", type_proyect);
        localStorage.setItem("category", category);
        localStorage.setItem("region", region);
        localStorage.setItem("tower", tower);
        localStorage.setItem("id_cliente", id_cliente);
        app.views.main.router.back('/yallegueMerGroup2/', {force: true, ignoreCache: true, reload: true});
    }

    function buscarClienteServInd(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#id_cliente").val();
        var horario_programado = $("#horario_programado").val();;
        var foto_llegada = $("#imagenC").val();
        var id_calendar = $("#cte").val();
        var nombre_cliente = $("#nombre_comercial").val() + " " + $("#sucursal").val();
        var nombre_comercial = $("#nombre_comercial").val();
        var sucursal = $("#sucursal").val();
        var order_number = $("#order_number").val();
        var store = $("#store").val();
        var telefono = $("#telefono").val();
        var correo = $("#correo").val();
        var equipo = $("#equipo").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var serie = $("#serie").val();
        var razon_servicio = $("#razon_servicio").val();
        var direccion = $("#direccion").val();
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                localStorage.setItem("id_visita", id_calendar);
                                localStorage.setItem("nombre_comercial", nombre_comercial);
                                localStorage.setItem("sucursal", sucursal);
                                localStorage.setItem("order_number", order_number);
                                localStorage.setItem("store", store);
                                localStorage.setItem("direccion", direccion);
                                localStorage.setItem("telefono", telefono);
                                localStorage.setItem("correo", correo);
                                localStorage.setItem("equipo", equipo);
                                localStorage.setItem("marca", marca);
                                localStorage.setItem("modelo", modelo);
                                localStorage.setItem("serie", serie);
                                localStorage.setItem("razon_servicio", razon_servicio);
                                app.views.main.router.navigate({name: 'menuServInd'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarChecklistServInd(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_entrada = localStorage.getItem("foto_llegada");
        let id_visita = localStorage.getItem("id_visita");
        let nombre_comercial = localStorage.getItem("nombre_comercial");
        let sucursal = localStorage.getItem("sucursal");
        let orden_servicio = localStorage.getItem("order_number");
        let tienda = localStorage.getItem("store");
        let direccion = localStorage.getItem("direccion");
        let tipoCedula = "checklistServ";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addCheckServInd(id_cedula,id_visita,orden_servicio,foto_entrada,nombre_cliente,nombre_comercial,sucursal,tienda,direccion);
                        app.views.main.router.navigate({name: 'recorridoServ1'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedServInd(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoServ1'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoServ2'});
        } else if(tipo == 3){
            app.views.main.router.navigate({ name: 'recorridoServ3'});
        } else if(tipo == 4){
            app.views.main.router.navigate({ name: 'recorridoServ4'});
        } else if(tipo == 5){
            app.views.main.router.navigate({ name: 'recorridoServ5'});
        }
    }
    function guardarDatoscheckServind(){
        app.preloader.show('blue');
        if($("#cliente").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var orden_servicio = $("#orden_servicio").val();
        var tienda = $("#tienda").val();
        var cliente = $("#cliente").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE checklist SET orden_servicio = ?,tienda = ?,nombre_cliente = ? WHERE id_cedula = ?",
                    [orden_servicio,tienda,cliente,id_cedula],
                    function(tx, results){
                        $("#orden_servicio").css("background-color", "#FFFFFF");
                        $("#tienda").css("background-color", "#FFFFFF");
                        $("#cliente").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarEquipoServind(){
        app.preloader.show('blue');
        if($("#modelo").val() =="" || $("#serie").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var modelo = $("#modelo").val();
        var serie = $("#serie").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE checklist SET modelo = ?,serie = ? WHERE id_cedula = ?",
                    [modelo,serie,id_cedula],
                    function(tx, results){
                        $("#modelo").css("background-color", "#FFFFFF");
                        $("#serie").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatoscheckServind2(){
        app.preloader.show('blue');
        if($("#fecha_entrada").val() =="" || $("#nombre_cliente").val() == "" || $("#sucursal").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var numero_servicio = $("#numero_servicio").val();
        var nombre_cliente = $("#nombre_cliente").val();
        var sucursal = $("#sucursal").val();
        var direccion = $("#direccion").val();
        var ciudad = $("#ciudad").val();
        var telefono = $("#telefono").val();
        var correo = $("#correo").val();
        var folio_interno = $("#folio_interno").val();
        var equipo = $("#equipo").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var serie = $("#serie").val();
        var tipo_servicio = $("#tipo_servicio").val();
        var id_cedula = localStorage.getItem("IdCedula");

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE reporteGeneral SET orden_servicio = ?,nombre_cliente = ?,sucursal = ?,direccion = ?,ciudad = ?,telefono = ?,correo = ?,folio_interno = ?,equipo = ?,marca = ?,modelo = ?,serie = ?,tipo_servicio = ? WHERE id_cedula = ?",
                    [numero_servicio,nombre_cliente,sucursal,direccion,ciudad,telefono,correo,folio_interno,equipo,marca,modelo,serie,tipo_servicio,id_cedula],
                    function(tx, results){
                        $("#fecha_llegada").css("background-color", "#FFFFFF");
                        $("#numero_servicio").css("background-color", "#FFFFFF");
                        $("#nombre_cliente").css("background-color", "#FFFFFF");
                        $("#sucursal").css("background-color", "#FFFFFF");
                        $("#direccion").css("background-color", "#FFFFFF");
                        $("#ciudad").css("background-color", "#FFFFFF");
                        $("#telefono").css("background-color", "#FFFFFF");
                        $("#correo").css("background-color", "#FFFFFF");
                        $("#folio_interno").css("background-color", "#FFFFFF");
                        $("#equipo").css("background-color", "#FFFFFF");
                        $("#marca").css("background-color", "#FFFFFF");
                        $("#modelo").css("background-color", "#FFFFFF");
                        $("#serie").css("background-color", "#FFFFFF");
                        $("#tipo_servicio").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarSuministrosServind(){
        app.preloader.show('blue');
        if($("#voltaje").val() =="" || $("#amperaje").val() == "" || $("#breaker").val() == "" || $("#1-1-select").val() == "0" || $("#1-2-select").val() == "0" || $("#presion").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var voltaje = $("#voltaje").val();
        var amperaje = $("#amperaje").val();
        var breaker = $("#breaker").val();
        var presion = $("#presion").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE checklist SET voltaje = ?,amperaje = ?,breaker = ?,presion = ? WHERE id_cedula = ?",
                    [voltaje,amperaje,breaker,presion,id_cedula],
                    function(tx, results){

                        var data = $("#1-1-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#1-1-select").val());
                        
                        var data2 = $("#1-2-select").attr("id").split("-");
                        guardarSelectServ(data2[0],data2[1],$("#1-2-select").val());

                        $("#voltaje").css("background-color", "#FFFFFF");
                        $("#amperaje").css("background-color", "#FFFFFF");
                        $("#breaker").css("background-color", "#FFFFFF");
                        $("#presion").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCalentamientoServind(){
        app.preloader.show('blue');
        if($("#2-1-select").val() == "0" || $("#2-2-select").val() == "0" || $("#2-3-select").val() == "0" || $("#2-4-select").val() == "0" || $("#2-5-select").val() == "0" || $("#2-6-select").val() == "0" || $("#dinamica").val() == "" || $("#estatica").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var dinamica = $("#dinamica").val();
        var estatica = $("#estatica").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE checklist SET dinamica = ?,estatica = ? WHERE id_cedula = ?",
                    [dinamica,estatica,id_cedula],
                    function(tx, results){
                        var data = $("#2-1-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#2-1-select").val());
                        var data = $("#2-2-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#2-2-select").val());
                        var data = $("#2-3-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#2-3-select").val());
                        var data = $("#2-4-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#2-4-select").val());
                        var data = $("#2-5-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#2-5-select").val());
                        var data = $("#2-6-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#2-6-select").val());
                        
                        $("#dinamica").css("background-color", "#FFFFFF");
                        $("#estatica").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarSistemaServind(){
        app.preloader.show('blue');
        if($("#3-1-select").val() == "0" || $("#3-2-select").val() == "0" || $("#3-3-select").val() == "0" || $("#3-4-select").val() == "0" || $("#3-5-select").val() == "0" || $("#3-6-select").val() == "0" || $("#3-7-select").val() == "0"  || $("#3-8-select").val() == "0" || $("#3-9-select").val() == "0" || $("#3-10-select").val() == "0" || $("#3-11-select").val() == "0" || $("#3-12-select").val() == "0" || $("#amp1").val() == "" || $("#amp2").val() == "" || $("#amp3").val() == "" || $("#amp4").val() == "" || $("#amp5").val() == "" || $("#amp6").val() == "" || $("#amp7").val() == "" || $("#amp8").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var amp1 = $("#amp1").val();
        var amp2 = $("#amp2").val();
        var amp3 = $("#amp3").val();
        var amp4 = $("#amp4").val();
        var amp5 = $("#amp5").val();
        var amp6 = $("#amp6").val();
        var amp7 = $("#amp7").val();
        var amp8 = $("#amp8").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE checklist SET amp1 = ?,amp2 = ?,amp3 = ?,amp4 = ?,amp5 = ?,amp6 = ?,amp7 = ?,amp8 = ? WHERE id_cedula = ?",
                    [amp1,amp2,amp3,amp4,amp5,amp6,amp7,amp8,id_cedula],
                    function(tx, results){
                        var data = $("#3-1-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#3-1-select").val());
                        var data = $("#3-2-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#3-2-select").val());
                        var data = $("#3-3-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#3-3-select").val());
                        var data = $("#3-4-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#3-4-select").val());
                        var data = $("#3-5-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#3-5-select").val());
                        var data = $("#3-6-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#3-6-select").val());
                        var data = $("#3-7-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#3-7-select").val());
                        var data = $("#3-8-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#3-8-select").val());
                        var data = $("#3-9-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#3-9-select").val());
                        var data = $("#3-10-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#3-10-select").val());
                        var data = $("#3-11-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#3-11-select").val());
                        var data = $("#3-12-select").attr("id").split("-");
                        guardarSelectServ(data[0],data[1],$("#3-12-select").val());
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarSensoresServind(){
        app.preloader.show('blue');
        if($("#temperatura").val() == "" || $("#nivel").val() == "" || $("#magneto").val() == "" || $("#magnetron").val() == "" || $("#transformadorhv").val() == "" || $("#diodohv").val() == "" || $("#capacitorhv").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var temperatura = $("#temperatura").val();
        var nivel = $("#nivel").val();
        var magneto = $("#magneto").val();
        var magnetron = $("#magnetron").val();
        var transformadorhv = $("#transformadorhv").val();
        var diodohv = $("#diodohv").val();
        var capacitorhv = $("#capacitorhv").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE checklist SET temperatura = ?,nivel = ?,magneto = ?,magnetron = ?,transformadorhv = ?,diodohv = ?,capacitorhv = ? WHERE id_cedula = ?",
                    [temperatura,nivel,magneto,magnetron,transformadorhv,diodohv,capacitorhv,id_cedula],
                    function(tx, results){
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function guardarGabineteServind(){
        app.preloader.show('blue');
        if($("#4-1-select").val() == "0" || $("#4-2-select").val() == "0" || $("#4-3-select").val() == "0" || $("#4-4-select").val() == "0" || $("#4-5-select").val() == "0" || $("#4-6-select").val() == "0" || $("#4-7-select").val() == "0"  || $("#4-8-select").val() == "0" || $("#4-9-select").val() == "0" || $("#4-10-select").val() == "0"){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        } else {
            var data = $("#4-1-select").attr("id").split("-");
            guardarSelectServ(data[0],data[1],$("#4-1-select").val());
            var data = $("#4-2-select").attr("id").split("-");
            guardarSelectServ(data[0],data[1],$("#4-2-select").val());
            var data = $("#4-3-select").attr("id").split("-");
            guardarSelectServ(data[0],data[1],$("#4-3-select").val());
            var data = $("#4-4-select").attr("id").split("-");
            guardarSelectServ(data[0],data[1],$("#4-4-select").val());
            var data = $("#4-5-select").attr("id").split("-");
            guardarSelectServ(data[0],data[1],$("#4-5-select").val());
            var data = $("#4-6-select").attr("id").split("-");
            guardarSelectServ(data[0],data[1],$("#4-6-select").val());
            var data = $("#4-7-select").attr("id").split("-");
            guardarSelectServ(data[0],data[1],$("#4-7-select").val());
            var data = $("#4-8-select").attr("id").split("-");
            guardarSelectServ(data[0],data[1],$("#4-8-select").val());
            var data = $("#4-9-select").attr("id").split("-");
            guardarSelectServ(data[0],data[1],$("#4-9-select").val());
            var data = $("#4-10-select").attr("id").split("-");
            guardarSelectServ(data[0],data[1],$("#4-10-select").val());
            swal("", "Se guardaron los datos correctamente" ,"success");
            app.preloader.hide();
        }
    }
    function guardarSelectServ(fase,id,valor){
        var id_cedula = localStorage.getItem("IdCedula");
        console.log(fase,id,valor);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * from selectcheck WHERE id_cedula = ? AND fase = ? AND opcion = ?",
                [id_cedula,fase,id],
                    function(tx, results){
                        if(results.rows.length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO selectcheck(id_cedula,fase,opcion,valor) VALUES (?,?,?,?)",
                                        [id_cedula,fase,id,valor],
                                        function(tx, results){},
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){}
                            );
                        } else {
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE selectcheck SET valor = ? WHERE id_cedula = ? AND fase = ? AND opcion = ?",
                                        [valor,id_cedula,fase,id],
                                        function(tx, results){},
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){}
                            );
                        }
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreChecklistServind(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE checklist SET fecha_cliente = ?,firma_cliente = ? WHERE id_cedula = ?",
                    [fecha_firma,firmaCliente,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_evalua = ? WHERE id_cedula = ?",
                                    [nombrefirma,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoychecklistServ/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarCheckServ(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE checklist SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarReporteServ(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE reporteGeneral SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarReporteServInd(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let id_visita = localStorage.getItem("id_visita");
        let nombre_comercial = localStorage.getItem("nombre_comercial");
        let sucursal = localStorage.getItem("sucursal");
        let orden_servicio = localStorage.getItem("order_number");
        let ciudad = localStorage.getItem("store");
        let direccion = localStorage.getItem("direccion");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        let equipo = localStorage.getItem("equipo");
        let marca = localStorage.getItem("marca");
        let modelo = localStorage.getItem("modelo");
        let serie = localStorage.getItem("serie");
        let razon_servicio = localStorage.getItem("razon_servicio");
        let tipoCedula = "reporteGeneral";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addreporteGeneral(id_cedula,id_visita,orden_servicio,foto_llegada,nombre_cliente,nombre_comercial,sucursal,direccion,ciudad,telefono,correo,equipo,marca,modelo,serie,tipoCedula,razon_servicio);
                        app.views.main.router.navigate({name: 'recorridoServ2'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function requiereCotizacion(){
        if($("#cotizacion-1").prop("checked") == true){
            $("#cotizacion").css("display","block")
        } else {
            $("#cotizacion").css("display","none")
        }
    }
    function norequiereCotizacion(){
        if($("#cotizacion-2").prop("checked") == true){
            $("#cotizacion").css("display","none")
        }
    }
    function horaLlena(id,valor){
        if($("#horas_viaje").val() == ""){
            var viaje = 0;
        } else {
            var viaje = $("#horas_viaje").val()
        }
        if($("#horas_espera").val() == ""){
            var espera = 0;
        } else {
            var espera = $("#horas_espera").val()
        }
        if($("#horas_activas").val() == ""){
            var activas = 0;
        } else {
            var activas = $("#horas_activas").val()
        }
        $("#horas_totales").val(parseFloat(viaje) + parseFloat(espera) + parseFloat(activas))
    }
    function selectChanged(id,valor){
        let actual = id.split("-");
        if(valor == "0"){
            $("#"+actual[0]+"-value").text("0%");
        } else {
            $("#"+actual[0]+"-value").text("100%");
        }
        var total = 0;
        for(i = 1;i <=28;i++){
            let elemento = $("#"+i+"-value").text();
            let valor = elemento.split("%");
            total = total + parseInt(valor[0]);
        }
        total = total /28;
        $("#total").text(Math.round(total) + "%");
    }
    function guardarDiagnosticoServ(){
        app.preloader.show('blue');
        if($("#voltaje").val() == "" || $('#amp').val() == "" || $('#wc').val() == "" || $('#tierra_fisica').val() == "" || $('#razon_servicio').val() == "" || $('#equipo_encontrado').val() == "0" || $('#diagnostico').val() == "" || $('#titulo').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var voltaje = $("#voltaje").val();
        var amp = $('#amp').val();
        var wc = $('#wc').val();
        var tierra_fisica = $('#tierra_fisica').val();
        var razon_servicio = $('#razon_servicio').val();
        var equipo_encontrado = $('#equipo_encontrado').val();
        var diagnostico = $('#diagnostico').val();
        var titulo = $('#titulo').val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fase = "1";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE reporteGeneral SET voltaje = ?,amp = ?,wc = ?,tierra_fisica = ?,razon_servicio = ?,equipo_encontrado = ?,diagnostico = ? WHERE id_cedula = ?",
                    [voltaje,amp,wc,tierra_fisica,razon_servicio,equipo_encontrado,diagnostico,id_cedula],
                    function(tx, results){
                        $("#voltaje").css("background-color", "#FFFFFF");
                        $("#amp").css("background-color", "#FFFFFF");
                        $("#wc").css("background-color", "#FFFFFF");
                        $("#tierra_fisica").css("background-color", "#FFFFFF");
                        $("#razon_servicio").css("background-color", "#FFFFFF");
                        $("#lugarReparacion").css("background-color", "#FFFFFF");
                        $("#equipo_encontrado").css("background-color", "#FFFFFF");
                        $("#diagnostico").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO evidenciasReporte(id_cedula,fase,titulo,foto,fecha_registro) VALUES (?,?,?,?,?)",
                                    [id_cedula,fase,titulo,foto,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from evidenciasReporte",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from evidenciasReporte where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#titulo").css("background-color", "#FFFFFF");
                                                                        $("#titulo").val("");
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#tabla_diagnostico tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaServ("+ item.id_evidencia +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.titulo) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarEntregaServ(){
        app.preloader.show('blue');
        if($("#trabajo_realizado").val() == "" || $('#equipo_entrego').val() == "0" || $('#titulo').val() == "" || $('#imagenC').val() == "" || $('#comentario').val() == "" || $('#horas_activas').val() == "" || $('#horas_viaje').val() == "" || $('#horas_viaje').val() == ""|| $('#horas_totales').val() == "" || ($("#reprogramar").prop("checked") == false && $("#terminada").prop("checked") == false && $("#refaccion").prop("checked") == false)){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var trabajo_realizado = $("#trabajo_realizado").val();
        var equipo_entrego = $('#equipo_entrego').val();
        var titulo = $('#titulo').val();
        var foto = $('#imagenC').val();
        var horas_activas = $('#horas_activas').val();
        var horas_viaje = $('#horas_viaje').val();
        var horas_espera = $('#horas_espera').val();
        var horas_totales = $('#horas_totales').val();
        var comentario = $('#comentario').val();
        if($("#reprogramar").prop("checked") == true){
            var estatus = "1";
        } else if($("#terminada").prop("checked")){
            var estatus = "2";
        } else if($("#refaccion").prop("checked")){
            var estatus = "3";
        }
        var fecha = new Date();
        var fase = "2";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        console.log(trabajo_realizado,equipo_entrego,imagenC,comentario,estatus,id_cedula)
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE reporteGeneral SET trabajo_realizado = ?,equipo_entrego = ?,estatus_reporte = ?,comentario = ?,horas_activas = ?,horas_viaje = ?,horas_espera = ?,horas_totales = ? WHERE id_cedula = ?",
                    [trabajo_realizado,equipo_entrego,estatus,comentario,horas_activas,horas_viaje,horas_espera,horas_totales,id_cedula],
                    function(tx, results){
                        $("#trabajo_realizado").css("background-color", "#FFFFFF");
                        $("#equipo_entrego").css("background-color", "#FFFFFF");
                        $("#comentario").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO evidenciasReporte(id_cedula,fase,titulo,foto,fecha_registro) VALUES (?,?,?,?,?)",
                                    [id_cedula,fase,titulo,foto,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from evidenciasReporte",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from evidenciasReporte where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#titulo").css("background-color", "#FFFFFF");
                                                                        $("#titulo").val("");
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#tabla_entrega tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaServ("+ item.id_evidencia +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.titulo) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function datosCheckMulti(){
        var checkbox1 = document.getElementById("reprogramar");
        var checkbox2 = document.getElementById("terminada"); 
        var checkbox3 = document.getElementById("refaccion"); 
        checkbox1.onclick = function(){ 
            if(checkbox1.checked != false){ 
                checkbox2.checked =null;
                checkbox3.checked =null;
            }
        }
        checkbox2.onclick = function(){ 
            if(checkbox2.checked != false){ 
                checkbox1.checked=null;
                checkbox3.checked=null;
            }
        }
        checkbox3.onclick = function(){ 
            if(checkbox3.checked != false){ 
                checkbox1.checked=null;
                checkbox2.checked=null;
            }
        } 
    }
    function guardarPapeletaServ(){
        app.preloader.show('blue');
        if($("#numero_parte").val() == "" || $('#descripcion').val() == "" || $('#prioridad').val() == "0" || $('#cantidad').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var numero_parte = $("#numero_parte").val();
        var descripcion = $('#descripcion').val();
        var prioridad = $('#prioridad').val();
        var cantidad = $('#cantidad').val();
        var origin = "app";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO equiposReporte(id_cedula,origin,numero_parte,descripcion,prioridad,cantidad,fecha_registro) VALUES (?,?,?,?,?,?,?)",
                    [id_cedula,origin,numero_parte,descripcion,prioridad,cantidad,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_equipo) as Id from equiposReporte",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from equiposReporte where id_equipo = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#numero_parte").css("background-color", "#FFFFFF");
                                                        $("#descripcion").css("background-color", "#FFFFFF");
                                                        $("#cantidad").css("background-color", "#FFFFFF");
                                                        $("#numero_parte").val("");
                                                        $("#descripcion").val("");
                                                        $("#prioridad").val("");
                                                        $("#cantidad").val("");
                                                        if(item.prioridad == 1){
                                                            var prioridadText = "A";
                                                        } else if(item.prioridad == 2){
                                                            var prioridadText = "B";
                                                        } else {
                                                            var prioridadText = "C";
                                                        }
                                                        $("#equipos tbody").append("<tr id='fila"+ item.id_equipo +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_equipo +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + unescape(item.numero_parte) + "</td><td style='text-align: center;'>" + item.descripcion + "</td><td style='text-align: center;'>" + prioridadText + "</td><td style='text-align: center;'>" + item.cantidad + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function showTPM(){
        var tmp = app.popup.create({
            content: `
                  <div class="popup popup-TMP" id="camera">
                        <br/>
                        <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                            <a class="link popup-close">Cerrar</a>
                        </div>
                      <div class="app">
                        <div class="page">
                        <div class="page-content" style="background-color: #f6f7f9; ">
                            <div style="text-align: center; justify-content:center; margin-right:auto; margin-left:auto; width: 99%;">
                                <div style="text-align: left;">
                                    <div class="item-inner">
                                        <div class="block-title" style="text-align: center; font-size: 20px;"><h2 style="color:#505759;font-size: 22px;font-family: 'ITC Avant Garde Gothic', sans-serif;">TPM</h2></div>
                                    </div>
                                </div>
                                <table id="tabla_zona" style="width: 100%;text-align: left;">
                                    <thead>
                                        <tr>
                                            <th class="numeric-cell" style="text-align: center;background-color: #063E7F;color: white;">Instrucciones de Trabajo Rational</th>
                                            <th class="numeric-cell" style="text-align: center;background-color: #063E7F;color: white;">Validacion</th>
                                            <th class="numeric-cell" style="text-align: center;background-color: #063E7F;color: white;">Puntuación</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-1" style="margin: 0;">Descalcificación de caldera</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="1-select" name="1-select" onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="1-value">0%</span></td>
                                    </tr>
                    
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-2" style="margin: 0;">Limpieza de válvula de clima</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="2-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="2-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-3" style="margin: 0;">Limpieza de cámara de condensación</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="3-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="3-value">0%</span></td>
                                    </tr>                  
                                    
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-4" style="margin: 0;">Limpieza de tubo de salida de cámara de condensación</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="4-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="4-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-5" style="margin: 0;">Limpieza de sprea de válvula de humidificación</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="5-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="5-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-6" style="margin: 0;">Limpieza de mangueras de P1</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="6-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="6-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-7" style="margin: 0;">Verificar voltajes de P1</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="7-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="7-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-8" style="margin: 0;">Revisión de las RPM del motor turbina</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="8-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="8-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-9" style="margin: 0;">Revisión del funcionamiento de relevadores (SCR)</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="9-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="9-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-10" style="margin: 0;">Revisión de parámetros de temperatura</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="10-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="10-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-11" style="margin: 0;">Limpieza de filtros de aire</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="11-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="11-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-12" style="margin: 0;">Revisión de tiempos de lavado</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="12-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="12-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-13" style="margin: 0;">Revisión de mangueras de agua</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="13-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="13-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-14" style="margin: 0;">Revisión del sistema de drenado</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="14-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="14-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-15" style="margin: 0;">Revisión del sistema de iluminación</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="15-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="15-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-16" style="margin: 0;">Revisión del sistema de lavado (cleanjet + care)</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="16-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="16-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-17" style="margin: 0;">Revisión de empaque de puerta</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="17-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="17-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-18" style="margin: 0;">Actualización de software</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="18-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="18-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-19" style="margin: 0;">Revisión de nivel del equipo</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="19-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="19-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-20" style="margin: 0;">Revisión de  dureza del agua (PPM)</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="20-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="20-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-21" style="margin: 0;">Revisión de alimentacion electrica (CUENTE CON TIERRA FISICA)</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="21-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="21-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-22" style="margin: 0;">Ajuste e eliminación de falsos contactos eléctricos</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="22-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="22-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-23" style="margin: 0;">Revision de amperajes y voltajes de componentes electricos</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="23-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="23-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-24" style="margin: 0;">Limpieza de mangueras de suminstro de aire en equipos a gas</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="24-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="24-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-25" style="margin: 0;"></p>Limpieza del control electrico</td>
                                        <td>
                                        <select class="select-moji-fwm" id="25-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="25-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-26" style="margin: 0;">Limpieza de bomba vaciado</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="26-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="26-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-27" style="margin: 0;">Limpieza de puerta</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="27-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="27-value">0%</span></td>
                                    </tr>
                                    
                                    <tr>
                                        <td><p class="popup-open" data-popup=".popup-28" style="margin: 0;">Suministro eléctrico</p></td>
                                        <td>
                                        <select class="select-moji-fwm" id="28-select"onchange="selectChanged(this.id,this.value)">
                                            <option value="0">❌</option>
                                            <option value="1">✅</option>
                                        </select>
                                        </td>
                                        <td class="valor-tpm"><span id="28-value">0%</span></td>
                                    </tr>
                    
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td style="background-color: #063E7F;text-align: center;color: white;height: 39px;;"><span id="total">0%</span></td>
                                    </tr>
                                    </tbody>
                                </table>
                                <fwm></fwm>
                            </div> 
                        </div>
                        <!-- Start Pops -->
                        <div class="popup popup-1">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-1')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>F</span>
                                <span>Dascalcificación de caldera</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/1.png" width="44%">
                                <img src="img/recursos/serv/2.png" width="44%">
                            </div>
                            </div>
                        </div>
                    
                        <div class="popup popup-2">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-2')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>S F</span>
                                <span>Limpieza de válvula de clima</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/3.png" width="44%">
                                <img src="img/recursos/serv/4.png" width="44%">
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/5.png" width="44%">
                                <img src="img/recursos/serv/6.png" width="44%">
                            </div>
                            </div>
                        </div>
                        
                        <div class="popup popup-3">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-3')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>F</span>
                                <span>Limpieza de cámara de condensación</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/7.png" width="44%">
                                <img src="img/recursos/serv/8.png" width="44%">
                            </div>
                            </div>
                        </div>
                        
                        <div class="popup popup-4">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-4')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>S F</span>
                                <span>Limpieza de tubo de salida de cámara de condensación</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/9.png" width="44%">
                                <img src="img/recursos/serv/10.png" width="44%">
                            </div>
                            </div>
                        </div>
                        
                        <div class="popup popup-5">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-5')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>F</span>
                                <span>Limpieza de sprea de válvula de humidificación</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/11.png" width="44%">
                                <img src="img/recursos/serv/12.png" width="44%">
                            </div>
                            </div>
                        </div>
                        
                        <div class="popup popup-6">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-6')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>F</span>
                                <span>Limpieza de mangueras de P1</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/13.png" width="44%">
                                <img src="img/recursos/serv/14.png" width="44%">
                            </div>
                            </div>
                        </div>
                        
                        <div class="popup popup-8">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-8')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>F</span>
                                <span>Revisión de las RPM del motor turbina</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/15.png" width="100%">
                            </div>
                            </div>
                        </div>
                        
                        <div class="popup popup-10">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-10')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>F</span>
                                <span>Revisión de parámetros de temperatura</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/16.png" width="100%">
                            </div>
                            </div>
                        </div>
                        
                        <div class="popup popup-11">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-11')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>E F</span>
                                <span>Limpieza de filtros de aire</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/17.png" width="44%">
                                <img src="img/recursos/serv/18.png" width="44%">
                            </div>
                            </div>
                        </div>
                        
                        <div class="popup popup-16">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-16')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>E F</span>
                                <span>Revisión del sistema de lavado (cleanjet + care)</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/19.png" width="44%">
                                <img src="img/recursos/serv/20.png" width="44%">
                            </div>
                            </div>
                        </div>
                        
                        <div class="popup popup-17">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-17')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>E F</span>
                                <span>Revisión de empaque de puerta</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/21.png" width="44%">
                                <img src="img/recursos/serv/22.png" width="44%">
                            </div>
                            </div>
                        </div>
                    
                        <div class="popup popup-21">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-21')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>S F</span>
                                <span>Revisión de alimentacion electrica (CUENTE CON TIERRA FISICA)</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/23.png" width="100%">
                            </div>
                            </div>
                        </div>
                        
                        <div class="popup popup-22">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-22')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>S F</span>
                                <span>Ajuste e eliminación de falsos contactos eléctricos</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/24.png" width="100%">
                            </div>
                            </div>
                        </div>
                        
                        <div class="popup popup-25">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-25')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>E</span>
                                <span>Limpieza del control electrico</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/25.png" width="44%">
                                <img src="img/recursos/serv/26.png" width="44%">
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/28.png" width="44%">
                            </div>
                            </div>
                        </div>
                        
                        <div class="popup popup-26">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-26')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>E</span>
                                <span>Limpieza de bomba vaciado</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/29.png" width="44%">
                                <img src="img/recursos/serv/30.png" width="44%">
                            </div>
                            </div>
                        </div>
                        
                        <div class="popup popup-27">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-27')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>E</span>
                                <span>Limpieza de puerta</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/31.png" width="44%">
                                <img src="img/recursos/serv/32.png" width="44%">
                            </div>
                            </div>
                        </div>
                        
                        <div class="popup popup-28">
                            <br/>
                            <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                                <a class="link" onclick="app.popup.close('.popup-28')">Cerrar</a>
                            </div>
                            <div class="block">
                            <div style="display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px;">
                                <span>S F</span>
                                <span>Suministro eléctrico</span>
                            </div>
                            <div style="width: 100%;text-align: center;display: flex;justify-content: space-around;">
                                <img src="img/recursos/serv/33.png" width="100%">
                            </div>
                            </div>
                        </div>
                        <!-- End Pops -->
                    </div>
                        <fwm></fwm>
                      </div>
                  </div>
                `,
                on: {
                    open: function (popup) {
                      
                    },
                }
          });
          tmp.open();
    }
    function guardarReporteGeneralServ(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""){
            swal("","El campo de nombre y firma son obligatorios","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE reporteGeneral SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_evalua = ? WHERE id_cedula = ?",
                                    [nombrefirma,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyReporteServ/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    // Inicio Auditorias Serv
    var multicam;
    function capturePhotoSERV(Cam) {
    multicam = Cam;
        var camera = localStorage.getItem("camera");
        if(camera == 0){
        
            var camera = app.popup.create({
                content: `
                <div class="popup" id="camera">
                    <div class="app">
                    <div id="deviceready camera-Field-frame">
                        <div class="top"></div>
                        <canvas id="camera-frame" style="display: none;"></canvas>
                        <video id="camera-view" autoplay playsinline class="raster" style="display: none;"></video>
                        <img src="" id="phototaked">
                        <div class="camera">
                            <div class="take" id="take" onclick="onTake()">
                                <div class="bubble-take"></div>
                            </div>
                            <div class="select popup-close" id="select" style="display: none;" onClick="onDone()"><img id="img-select" src="img/validar_camera.svg"></div>
                        </div>
                        <div class="left-action">
                            <div class="cancel popup-close" id="cancelCamera" onClick="onCancelCamera()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                            <div class="cancel " id="cancelPicure" onClick="onCancelPicture()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                        </div>
                        <div class="actions">
                            <div class="action torch" id="torch" onClick="onTorch()"><img id="flash" src="img/flash_off.svg" width="30px"></div>
                            <div class="action rotate-right" id="rotateRight" onClick="onRotateRight()" style="display:none"><img id="flash" src="img/rotate-right.svg" width="30px"></div>
                            <div class="action rotate-left" id="rotateLeft" onClick="onRotateLeft()" style="display:none"><img id="flash" src="img/rotate-left.svg" width="30px"></div>
                        </div>
                        <div class="right-action">
                            <div class="switch" id="switch" onClick="onSwitch()"><img class="image-switch" src="img/flip.svg"></div>
                        </div>
                        <audio id="audio" controls style="display: none;">
                            <source type="audio/mp3" src="img/camera.mp3">
                        </audio>
                        <input type="hidden" id="deviceOrientation" name="deviceOrientation"/>
                    </div>
                    <fwm></fwm>
                    </div>
                </div>
                `,
                on: {
                    open: function (popup) {
                        var permissions = cordova.plugins.permissions;
                        permissions.checkPermission(permissions.CAMERA, function( status ){
                            if (status.hasPermission){
                                cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                                function empresaCargada(){
                                
                                    cameraStart(onPhotoDataSuccessSERV)
                                    
                                }
                                function cargarEmpresa(url, callback){
                                    var pie = document.getElementsByTagName('fwm')[0];
                                    var script = document.createElement('script');
                                    script.type = 'text/javascript';
                                    script.src = url;
                                    script.id = "cameraSource";
                                    script.onload = callback;
                                    pie.appendChild(script);
                                }
                            }else{
                                permissions.requestPermission(permissions.CAMERA, success, error);
                                function error() {
                                    app.sheet.close('.popup')
                                    swal("Field Requiere los permisos","Para poder tomar las evidencias fotograficas necesitamos el permiso.","warning");
                                }
                                function success( status ){
                                    if(!status.hasPermission){
                                        error();
                                    } else {
                                        cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                                        function empresaCargada(){
                                        
                                            cameraStart(onPhotoDataSuccessSERV)
                                            
                                        }
                                        function cargarEmpresa(url, callback){
                                            var pie = document.getElementsByTagName('fwm')[0];
                                            var script = document.createElement('script');
                                            script.type = 'text/javascript';
                                            script.src = url;
                                            script.id = "cameraSource";
                                            script.onload = callback;
                                            pie.appendChild(script);
                                        }
                                    }

                                }
                            }
                        });
                    },
                    opened: function (popup) {
                    localStorage.setItem("cameraField", "Active");
                    },
                    closed: function (popup) {
                    window.localStorage.removeItem("cameraField");
                    },
                }
            });
            camera.open();
        } else {
        
                navigator.camera.getPicture(onPhotoDataSuccessSERV, onFail, {
                    quality: 100,
                    destinationType: destinationType.DATA_URL,
                    targetWidth: 500,
                    targetHeight: 500,
                    correctOrientation: true,
                });      
                    
        }
    }
    function guardarFotoSERV(recorrido, proceso) {
        app.preloader.show('blue');
        var titulo = '#Titulo' + proceso;
        var mesg = '#message-nr' + proceso;
        var smallImage = '#smallImage' + proceso;
        var photoIcon = '#photoIcon' + proceso;
        var tabla2 = '#tabla_levantamiento' + proceso + ' tbody';

        if ($(titulo).val() == "") {
            swal("", "Debes de ingresar titulo ", "warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var FotoSERV= $('#imagenC'+proceso).val();
        var titulo = $(titulo).val();
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        if (FotoSERV) {
            productHandler.SERVFotos(id_cedula, recorrido, proceso, titulo, fecha_foto, FotoSERV);
            $(tabla2).empty("");
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Select * from SV_Fotos WHERE SV_ID_Cedula = ? and SV_Recorrido = ? and SV_Proceso = ?",
                    [id_cedula, recorrido, proceso],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                $("#imagenC"+proceso).val();
                                $("#Titulo"+proceso).val("");
                                $("#Titulo"+proceso).css("background","#FFFFFFFF");
                                var item = results.rows.item(i);
                                $(tabla2).append("<tr id='fila" + item.SV_ID_Fotos + "'><td><a href='#' onclick='eliminarFila(" + item.SV_ID_Fotos + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + item.SV_Foto + "' width='60px'/></td><td style='text-align: center;'>" + item.SV_titulo + "</td><td style='text-align: center;'>" + item.SV_FechaHora + "</td></tr>");
                                $(mesg).hide();
                                $(smallImage).attr('src', 'img/blank.png');
                                $(photoIcon).attr("src", "img/camera.svg");
                            }
                        } else {
                            $(mesg).show();

                        }

                        app.preloader.hide();
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }

    function calificacionSERV(value, pregunta, respuesta) {
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta,* from Aud_Tec WHERE AT_Pregunta = ? and AT_ID_cedula = ?",
                    [pregunta, id_cedula],
                    function (tx, results) {
                        var item = results.rows.item(0);                    
                        if (item.Cuenta == 0) {                        
                            var resp = 0;
                            tx.executeSql("insert into Aud_Tec(AT_ID_cedula ,AT_Pregunta , AT_Resp1 ,AT_Resp2 ,AT_Resp3 ,AT_Resp4 ,AT_Resp5 ,AT_Resp6 ,AT_Resp7,AT_Resp8,AT_Resp9, AT_Resp10,AT_Resp11,AT_Resp12,AT_Resp13,AT_Resp14,AT_Resp15,AT_Resp16,AT_Resp17) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                                [id_cedula, pregunta, resp, resp, resp, resp, resp, resp, resp, resp, resp, resp, resp, resp, resp, resp, resp, resp, resp],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    
                                    tx.executeSql("UPDATE Aud_Tec SET " + respuesta + " = ? WHERE AT_ID_cedula = ? and AT_Pregunta =?  ",
                                        [value, id_cedula, pregunta],
                                        function (tx, results) {
                                            var item = results.rows.item(0);
                                            
                                            //swal("", "Se actualizaron los datos correctamente", "success");
                                        },
                                        function (tx, error) {
                                            console.error("Error al registrar Aud_Tec: " + error.message);
                                        }
                                    );

                                    // swal("", "Se guardaron los datos correctamente", "success");

                                },
                                function (tx, error) {
                                    console.error("Error al registrar Aud_Tec: " + error.message);
                                }
                            );

                        } else {
                        
                            tx.executeSql("UPDATE Aud_Tec SET " + respuesta + " = ? WHERE AT_ID_cedula = ? and AT_Pregunta =?  ",
                                [value, id_cedula, pregunta],
                                function (tx, results) {
                                    var item = results.rows.item(0);                                
                                    //swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Aud_Tec: " + error.message);
                                }
                            );


                        }

                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );

            },
            function (error) { },
            function () { }
        );

        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select * from Aud_Tec WHERE AT_Pregunta = ? and AT_ID_cedula = ?",
                    [pregunta, id_cedula],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        var CalculoC1, CalculoC2, CalculoC3, CalculoC4, CalculoC5, CalculoC6, CalculoC8, CalculoC9, CalculoC10, CalculoC11, CalculoC12, CalculoC13, CalculoC14, CalculoC15, CalculoC16, CalculoC17, Calculo;
                        let arrCali = [item.AT_Resp1, item.AT_Resp2, item.AT_Resp3, item.AT_Resp4, item.AT_Resp5, item.AT_Resp6, item.AT_Resp7, item.AT_Resp8, item.AT_Resp9, item.AT_Resp10, item.AT_Resp11, item.AT_Resp12, item.AT_Resp13, item.AT_Resp14, item.AT_Resp15, item.AT_Resp16, item.AT_Resp17]
                        
                        for (var i = 0; i <= arrCali.length; i++) {
                            if (arrCali[i] == 100) {
                                arrCali[i] = 0;
                            }
                            
                        }
                        for (var i = 0; i <= arrCali.length; i++) {
                            if (arrCali[i] == 200) {
                                arrCali[i] = 0;
                            }
                            
                        }
                        
                        if (pregunta == 1) {
                            CalculoC1 = ((arrCali[0] + arrCali[1] + arrCali[2] + arrCali[3] + arrCali[4]) / 0.5)
                            $('#P1').text(CalculoC1)
                            $('#P11').text(CalculoC1)
                            Calculo = CalculoC1;
                        } else if (pregunta == 2) {
                            CalculoC2 = ((arrCali[0] + arrCali[1] + arrCali[2] + arrCali[3] + arrCali[4] + arrCali[5] + arrCali[6]) / 0.5)
                            $('#P2').text(CalculoC2)
                            $('#P22').text(CalculoC2)
                            Calculo = CalculoC2;
                        } else if (pregunta == 3) {
                            CalculoC3 = ((arrCali[0] + arrCali[1] + arrCali[2] + arrCali[3] + arrCali[4]) / 0.5)
                            $('#P3').text(CalculoC3)
                            $('#P33').text(CalculoC3)
                            Calculo = CalculoC3;
                        } else if (pregunta == 4) {
                            CalculoC4 = ((arrCali[0] + arrCali[1] + arrCali[2] + arrCali[3] + arrCali[4] + arrCali[5] + arrCali[6]) / 3.4)
                            $('#P4').text(CalculoC4.toFixed(2))
                            $('#P44').text(CalculoC4.toFixed(2))
                            Calculo = CalculoC4;
                        } else if (pregunta == 5) {
                            CalculoC5 = ((arrCali[0] + arrCali[1] + arrCali[2]) / 3.4)
                            $('#P5').text(CalculoC5.toFixed(2))
                            $('#P55').text(CalculoC5.toFixed(2))
                            Calculo = CalculoC5;
                        } else if (pregunta == 6) {
                            CalculoC6 = ((arrCali[0] + arrCali[1] + arrCali[2]) / 1.7)
                            $('#P6').text(CalculoC6.toFixed(2))
                            $('#P66').text(CalculoC6.toFixed(2))
                            Calculo = CalculoC6;
                        } else if (pregunta == 8) {
                            CalculoC8 = ((arrCali[0] + arrCali[1] + arrCali[2] + arrCali[3] + arrCali[4] + arrCali[5] + arrCali[6] + arrCali[7] + arrCali[8]) / 2.0)
                            $('#P8').text(CalculoC8.toFixed(2));
                            $('#P88').text(CalculoC8.toFixed(2));
                            Calculo = CalculoC8;
                        } else if (pregunta == 9) {
                            CalculoC9 = ((arrCali[0] + arrCali[1] + arrCali[2] + arrCali[3] + arrCali[4]) / 0.5)
                        
                            $('#P9').text(CalculoC9.toFixed(2));
                            $('#P99').text(CalculoC9.toFixed(2));
                            Calculo = CalculoC9;
                        } else if (pregunta == 10) {
                            CalculoC10 = ((arrCali[0] + arrCali[1] + arrCali[2] + arrCali[3] + arrCali[4]) / 0.5)
                            
                            $('#P10').text(CalculoC10.toFixed(2));
                            $('#P1010').text(CalculoC10.toFixed(2));
                            Calculo = CalculoC10;
                        } else if (pregunta == 11) {
                            CalculoC11 = ((arrCali[0] + arrCali[1] + arrCali[2] + arrCali[3] + arrCali[4] + arrCali[5] + arrCali[6] + arrCali[7] + arrCali[8]) / 2.0)
                            
                            $('#P11').text(CalculoC11.toFixed(2));
                            $('#P1111').text(CalculoC11.toFixed(2));
                            Calculo = CalculoC11;
                        } else if (pregunta == 12) {
                            CalculoC12 = ((item.AT_Resp2 * 10) / item.AT_Resp1)
                            console.log(item.AT_Resp2)
                            console.log(item.AT_Resp1)
                            $('#P12').text(CalculoC12.toFixed(2));
                            $('#P1212').text(CalculoC12.toFixed(2));
                            Calculo = CalculoC12;
                        } else if (pregunta == 13) {
                            CalculoC13 = ((item.AT_Resp2 * 10) / item.AT_Resp1)
                            
                            $('#P13').text(CalculoC13.toFixed(2));
                            $('#P1313').text(CalculoC13.toFixed(2));
                            Calculo = CalculoC13;
                        } else if (pregunta == 14) {
                            CalculoC14 = ((item.AT_Resp2 * 10) / item.AT_Resp1)
                            $('#P14').text(CalculoC14.toFixed(2));
                            $('#P1414').text(CalculoC14.toFixed(2));
                            Calculo = CalculoC14;
                        } else if (pregunta == 15) {
                            CalculoC15 = ((arrCali[0] + arrCali[1] + arrCali[2] + arrCali[3] + arrCali[4] + arrCali[5] + arrCali[6]) / 0.75)
                            $('#P15').text(CalculoC15.toFixed(2))
                            $('#P1515').text(CalculoC15.toFixed(2))
                            Calculo = CalculoC15;
                        } else if (pregunta == 17) {
                            CalculoC17 = ((arrCali[0] + arrCali[1] + arrCali[2] + arrCali[3] + arrCali[4] + arrCali[5] + arrCali[6] + arrCali[7] + arrCali[8] + arrCali[9] + arrCali[10] + arrCali[11] + arrCali[12] + arrCali[13] + arrCali[14] + arrCali[15] + arrCali[16]) / 5.0)
                            $('#P17').text(CalculoC17.toFixed(2))
                            $('#P1717').text(CalculoC17.toFixed(2))
                            Calculo = CalculoC17;
                        } else if (pregunta == 18) {
                            CalculoC18 = ((arrCali[0] + arrCali[1] + arrCali[2] + arrCali[3] + arrCali[4] + arrCali[5] + arrCali[6] + arrCali[7] + arrCali[8]) / 5.0)
                            $('#P18').text(CalculoC18.toFixed(2))
                            $('#P1818').text(CalculoC18.toFixed(2))
                            Calculo = CalculoC18;
                        }

                        tx.executeSql("UPDATE Aud_Tec SET  AT_Total = ? WHERE AT_ID_cedula = ? and AT_Pregunta =?  ",
                            [Calculo, id_cedula, pregunta],
                            function (tx, results) {
                                var item = results.rows.item(0);                            
                                //swal("", "Se actualizaron los datos correctamente", "success");
                            },
                            function (tx, error) {
                                console.error("Error al registrar TOTAL: " + error.message);
                            }
                        );

                        var C1 = parseFloat($('#P1').text());
                        var C2 = parseFloat($('#P2').text());
                        var C3 = parseFloat($('#P3').text());
                        var C4 = parseFloat($('#P4').text());
                        var C5 = parseFloat($('#P5').text());
                        var C6 = parseFloat($('#P6').text());
                        var C7 = parseFloat($('#P7').text());
                        var C8 = parseFloat($('#P8').text());
                        var C9 = parseFloat($('#P9').text());
                        var C10 = parseFloat($('#P10').text());
                        var C11 = parseFloat($('#P11').text());
                        var C12 = parseFloat($('#P12').text());
                        var C13 = parseFloat($('#P13').text());
                        var C14 = parseFloat($('#P14').text());
                        var C15 = parseFloat($('#P15').text());
                        var C17 = parseFloat($('#P17').text());
                        var C18 = parseFloat($('#P18').text());
                        var CaliGen;
                        var CaliGen0 = ((C1 + C2 + C3 + C4 + C5 + C6) / 6);
                        var CaliGen1 = ((C8 + C9 + C10 + C11 + C12 + C13 + C14 + C15) / 8);
                        var CaliGen2 = ((C17 + C18) / 2);
                        if (CaliGen0) {
                            CaliGen = CaliGen0
                        } else if (CaliGen1) {
                            CaliGen = CaliGen1
                        } else if (CaliGen2) {
                            CaliGen = CaliGen2
                        }
                        //sconsole.log("CaliGen1",CaliGen1)
                        $('#GEN').text(CaliGen.toFixed(2));
                        //  var menor =();
                        var Calificacion = ""
                        if (CaliGen <= 5.99) {
                            Calificacion = "CRITICO";
                            $('#CAL').text(Calificacion);
                        } else if (CaliGen <= 6.99 && CaliGen > 5.99) {
                            Calificacion = "ATENCION";
                            $('#CAL').text(Calificacion);
                        } else if (CaliGen <= 7.99 && CaliGen > 6.99) {
                            Calificacion = "REGULAR";
                            $('#CAL').text(Calificacion);
                        } else if (CaliGen <= 8.99 && CaliGen > 7.99) {
                            Calificacion = "BIEN";
                            $('#CAL').text(Calificacion);
                        } else if (CaliGen <= 9.9 && CaliGen > 8.99) {
                            Calificacion = "MUY BIEN";
                            $('#CAL').text(Calificacion);
                        } else if (CaliGen <= 10 && CaliGen > 9.9) {
                            Calificacion = "EXCELENTE";
                            $('#CAL').text(Calificacion);
                        }

                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );

            },
            function (error) { },
            function () { }
        );


    }

    function onPhotoDataSuccessSERV(imageData) {

        var small = 'smallImage' + multicam;
        var photo = '#photoIcon' + multicam;
        var camera = localStorage.getItem("camera");
        if (camera == 0) {
            var smallImage = document.getElementById(small);
            smallImage.style.display = 'flex';
            smallImage.src = imageData;
            localStorage.setItem("FotoSERV", imageData);
            $(photo).attr("src", "img/reload.svg");
        } else {
            var smallImage = document.getElementById(small);
            smallImage.style.display = 'flex';
            var nameima = "data:image/jpeg;base64," + imageData;
            smallImage.src = "data:image/jpeg;base64," + imageData;        
            localStorage.setItem("FotoSERV", nameima);
            $(photo).attr("src", "img/reload.svg");
        }
    }
    function terminarAuditoria(recorrido) {
        var cuenta;
        var firma1 = $("#signate1").val();
        var firma2 = $("#signate2").val();
        var firma3 = $("#signate3").val();
        var id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();

        if (recorrido == 1) { cuenta = 6; } else if (recorrido == 2) { cuenta = 8; } else if (recorrido == 3) { cuenta = 2; }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("Select count(*) as Cuenta from Aud_Tec where AT_ID_cedula = ? ",
                    [id_cedula],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        console.log("Cuenta:" + cuenta)
                        console.log("Cuenta:" + item.Cuenta)
                        if (item.Cuenta == cuenta) {
                            
                            if (firma1 && firma2 && firma3) {
                            
                                var calificacionGene = $('#GEN').text();                           
                                var cali = $('#CAL').text();                            
                                var correo = $('#Correo').val();                            
                                var observacion = $('#Observaciones').val();                            
                                var id_tec = $('#id_tec').val();                       
                                var tec = $('#tec').val();                            
                                var puesto = $('#puesto').val();
                        
                                databaseHandler.db.transaction(
                                    function (tx) {
                                        tx.executeSql("Select count(*) as Cuenta,*from Aud_General where AG_ID_cedula = ? and  AG_Auditoria = ?",
                                            [id_cedula,recorrido],
                                            function (tx, results) {

                                                var item = results.rows.item(0);                                          

                                                if (item.Cuenta == 0) {
                                                    productHandler.SERVFotos(id_cedula, recorrido, 100, 'Firma Tecnico', fecha_foto, firma1);
                                                    productHandler.SERVFotos(id_cedula, recorrido, 200, 'Firma Auditor', fecha_foto, firma2);
                                                    productHandler.SERVFotos(id_cedula, recorrido, 300, 'Firma Gerente', fecha_foto, firma3);
                                                    databaseHandler.db.transaction(
                                                        function (tx) {
                                                            tx.executeSql("insert into Aud_General(AG_ID_cedula,AG_Auditoria , AG_CaliGen,AG_Cali,AG_Obse, AG_correo,AG_ID_Tecnico ,AG_Tecnico , AG_Puesto   ) values(?,?,?,?,?,?,?,?,?)",
                                                                [id_cedula, recorrido, calificacionGene, cali, observacion, correo, id_tec, tec, puesto],
                                                                function (tx, results) {
                                                                    var item = results.rows.item(0);
                                                                    swal("", "Se actualizaron los datos correctamente", "success");
                                                                    app.views.main.router.back('/yamevoyAditoriaServ/', {force: true, ignoreCache: true, reload: true})
                                                                },
                                                                function (tx, error) {
                                                                    console.error("Error al registrar Aud_Tec: " + error.message);
                                                                }
                                                            );
                                                        });
                                                } else {
                                                    swal("", "Los datos ya fueron ingresados", "warning");
                                                    // databaseHandler.db.transaction(
                                                    //     function (tx) {
                                                    //         tx.executeSql("UPDATE Aud_General SET AG_Auditoria = ?, SET AG_CaliGen = ?, SET AG_Cali = ?, SET AG_Obse = ?, SET AG_correo = ?, SET AG_ID_Tecnico = ?, SET AG_Tecnico = ?, SET AG_Puesto  = ? where AG_ID_cedula = ?",
                                                    //             [recorrido, calificacionGene, cali, observacion, correo, id_tec, tec, puesto, id_cedula],
                                                    //             function (tx, results) {

                                                    //                 var item = results.rows.item(0);

                                                    //                 console.log("update", results);
                                                    //                 swal("", "Se actualizaron los datos correctamente", "success");
                                                    //             },
                                                    //             function (tx, error) {
                                                    //                 console.error("Error al registrar Aud_General: " + error.message);
                                                    //             }
                                                    //         );
                                                    //     }
                                                    // );
                                                }
                                            },
                                            function (tx, error) {
                                                console.error("Error al registrar Aud_Tec: " + error.message);
                                            }
                                        );
                                    }
                                );
                            } else {
                                swal("", "Faltan firmas", "warning");
                            }
                        } else {
                            swal("", "Debe De contestar todas las preguntas", "warning");
                        }

                    },
                    function (tx, error) {
                        console.error("Error al al buscar : " + error.message);
                    }
                );
            }
        );
    }
    function terminarAudSERV(){    
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function (tx) {
                                tx.executeSql(
                                    "insert into SV_Fotos(SV_ID_Cedula, SV_Recorrido, SV_Proceso, SV_titulo, SV_FechaHora, SV_Foto) values(?,?,?,?,?,?)",
                                    [id_cedula, '5', 500, 'Foto de Salida', fecha_salida, foto_salida],
                                    function (tx, results) {
                                        window.location.href = "./menu.html";
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar SV_Fotos: " + error.message);
                                    }
                                );
                            },
                            function (error) { },
                            function () { }
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function generarSERV(recorrido){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let direccion = localStorage.getItem("direccion");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let tipoCedula ;
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if(recorrido == 3){tipoCedula='AuditoriaTecnico';}else if(recorrido == 4){tipoCedula='AuditoriaSupervisorTecnico';}else if(recorrido == 5){tipoCedula='AuditoriaLider';}
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.SERVFotos(id_cedula, '4', 400, 'Foto de llegada', fecha_foto, foto_llegada);
                        },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function createFirmaSERV(id){
            var idSE = 'signature-pad'+id;
        screen.orientation.lock('landscape');
        var signaturePad = new SignaturePad(document.getElementById(idSE), {
            backgroundColor: 'rgba(255, 255, 255, 0)',
            penColor: 'rgb(6, 62, 127)'
        });
        testFirma = signaturePad;
    }
    
    
    function gfirmaMULT(id){
        var signate = '#signate' + id;
        var imagen = '#ImagenFirmaView' + id;
        var VolverFirmar = '#VolverFirmar' + id;
        var signaturePad = testFirma;
        var data = signaturePad.toDataURL('data:image/jpeg;base64,');
        screen.orientation.lock('portrait');
        screen.orientation.unlock();
        $(signate).val(data);
        console.log('data',data)
        $(imagen).attr('src', data);
        $(VolverFirmar).html("Evidencia");
    }
    //tomar Foto mult firma
    var FirmaMult;
    function capturaFirmaMultiSERV(id) {
        console.log("Entro aqui capturaFirmaMultiSERV")
        FirmaMult = id;
        var camera = localStorage.getItem("camera");
            if(camera == 0){
                var camera = app.popup.create({
                content: `
                <div class="popup" id="camera">
                    <div class="app">
                    <div id="deviceready camera-Field-frame">
                        <div class="top"></div>
                        <canvas id="camera-frame" style="display: none;"></canvas>
                        <video id="camera-view" autoplay playsinline class="raster" style="display: none;"></video>
                        <img src="" id="phototaked">
                        <div class="camera">
                            <div class="take" id="take" onclick="onTake()">
                                <div class="bubble-take"></div>
                            </div>
                            <div class="select popup-close" id="select" style="display: none;" onClick="onDone()"><img id="img-select" src="img/validar_camera.svg"></div>
                        </div>
                        <div class="left-action">
                            <div class="cancel popup-close" id="cancelCamera" onClick="onCancelCamera()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                            <div class="cancel" id="cancelPicure" onClick="onCancelPicture()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                        </div>
                        <div class="actions">
                            <div class="action torch" id="torch" onClick="onTorch()"><img id="flash" src="img/flash_off.svg" width="30px"></div>
                            <div class="action rotate-right" id="rotateRight" onClick="onRotateRight()" style="display:none"><img id="flash" src="img/rotate-right.svg" width="30px"></div>
                            <div class="action rotate-left" id="rotateLeft" onClick="onRotateLeft()" style="display:none"><img id="flash" src="img/rotate-left.svg" width="30px"></div>
                        </div>
                        <div class="right-action">
                            <div class="switch" id="switch" onClick="onSwitch()"><img class="image-switch" src="img/flip.svg"></div>
                        </div>
                        <audio id="audio" controls style="display: none;">
                            <source type="audio/mp3" src="img/camera.mp3">
                        </audio>
                        <input type="hidden" id="deviceOrientation" name="deviceOrientation"/>
                    </div>
                    <fwm></fwm>
                    </div>
                </div>
            `,
            on: {
                open: function (popup) {
                    var permissions = cordova.plugins.permissions;
                    permissions.checkPermission(permissions.CAMERA, function( status ){
                        if (status.hasPermission){
                            cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                            function empresaCargada(){
                                cameraStart(onPhotoSingSuccessMULTSERV)
                            }
                            function cargarEmpresa(url, callback){
                                var pie = document.getElementsByTagName('fwm')[0];
                                var script = document.createElement('script');
                                script.type = 'text/javascript';
                                script.src = url;
                                script.id = "cameraSource";
                                script.onload = callback;
                                pie.appendChild(script);
                            }
                        }else{
                            permissions.requestPermission(permissions.CAMERA, success, error);
                            function error() {
                                app.sheet.close('.popup')
                                swal("Field Requiere los permisos","Para poder tomar las evidencias fotograficas necesitamos el permiso.","warning");
                            }
                            function success( status ){
                                if(!status.hasPermission){
                                    error();
                                } else {
                                    cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                                    function empresaCargada(){
                                        cameraStart(onPhotoSingSuccessMULTSERV)
                                    }
                                    function cargarEmpresa(url, callback){
                                        var pie = document.getElementsByTagName('fwm')[0];
                                        var script = document.createElement('script');
                                        script.type = 'text/javascript';
                                        script.src = url;
                                        script.id = "cameraSource";
                                        script.onload = callback;
                                        pie.appendChild(script);
                                    }
                                }
    
                            }
                        }
                    });
                },
                opened: function (popup) {
                    localStorage.setItem("cameraField", "Active");
                },
                closed: function (popup) {
                    window.localStorage.removeItem("cameraField");
                },
            }
                });
                camera.open();
            } else {
                console.log("Entro aqui capturaFirmaMultiSERV2222222222")
                navigator.camera.getPicture(onPhotoSingSuccessMULTSERV,onFail, {
                    quality: 100,
                    destinationType: destinationType.DATA_URL,
                    targetWidth: 500,
                    targetHeight: 500,
                    correctOrientation: true
                });
            }
        $('#FotoYaLLegue').attr('src', "img/camara.png");
    }
    
    function onPhotoSingSuccessMULTSERV(imageData) {
        console.log("ENTRO A LA IMAGEN ",FirmaMult)
        var camera = localStorage.getItem("camera");
        var small = 'smaImage' + FirmaMult;
            var imagen = '#signate' + FirmaMult;
            var icon = '#photoIcon' + FirmaMult;      
            var Fotoim = '#ImagenFirmaView' + FirmaMult;
            console.log("small",small)
            console.log("imagen ",imagen)
            console.log("Fotoim ",Fotoim)
            if(camera == 0){        
            var smallImage = document.getElementById(small);
            smallImage.style.display = 'flex';
            var nameima = imageData;
            smallImage.src = imageData;
            $(imagen).val(nameima);
            $(Fotoim).attr('src', nameima);
            $(icon).attr("src","img/reload.svg");
            }else{
            var smallImage = document.getElementById(small);
            smallImage.style.display = 'flex';
            var nameima = "data:image/jpeg;base64," + imageData;
            smallImage.src = "data:image/jpeg;base64," + imageData;
            $(imagen).val(nameima);
            $(Fotoim).attr('src', nameima);
            $(icon).attr("src","img/reload.svg");
            }
    }
    // Fin Auditorias Serv
    // Fin ServInd
    // Inicio Plato Limpio
    function Results(){
        $( "#Resultados" ) .show( "fast");
        $( "#LimSani" )    .hide( "fast");
        $( "#ManAli" )     .hide( "fast");
        $( "#higPerso" )   .hide( "fast");
        $( "#ContTemp" )   .hide( "fast");
        $( "#ContPlag" )   .hide( "fast");
        var valCheckuno = document.getElementById("uno").checked;
    //  alert(valCheckuno);
        var valCheckdos = document.getElementById("dos").checked;
    //  alert(valCheckdos);
        if(valCheckuno == true){var n1 = 10;}
        if(valCheckdos == true){ var n2 = 10;}

        var suma = parseInt(n1) + parseInt(n2);
    // alert("La suma es: "+suma);
        $("#res").html("<span>La suma es: "+suma+"</span");
    }

    function limpiar(){
        $("#NombreRecibe").val("");
        $("#PuestoRecibe").val("");
        $("#Telefono").val("");
        $("#Correo").val("");
        $("#NombreRecibe").css("background-color", "#ffffff");
        $("#PuestoRecibe").css("background-color", "#ffffff");
        $("#Telefono").css("background-color", "#ffffff");
        $("#Correo").css("background-color", "#ffffff");
    }

    function editar_fecha(fecha, intervalo, dma, separador) {
        var separador = separador || "-";
        var arrayFecha = fecha.split(separador);
        var dia = arrayFecha[2];
        var mes = arrayFecha[1];
        var anio = arrayFecha[0];

        var fechaInicial = new Date(anio, mes - 1, dia);
        var fechaFinal = fechaInicial;
        if(dma=="m" || dma=="M"){
        fechaFinal.setMonth(fechaInicial.getMonth()+parseInt(intervalo));
        }else if(dma=="y" || dma=="Y"){
        fechaFinal.setFullYear(fechaInicial.getFullYear()+parseInt(intervalo));
        }else if(dma=="d" || dma=="D"){
        fechaFinal.setDate(fechaInicial.getDate()+parseInt(intervalo));
        }else{
        return fecha;
        }
        dia = fechaFinal.getDate();
        mes = fechaFinal.getMonth() + 1;
        anio = fechaFinal.getFullYear();
        dia = (dia.toString().length == 1) ? "0" + dia.toString() : dia;
        mes = (mes.toString().length == 1) ? mes.toString() : mes;
        return anio + "-" + mes + "-" + dia;
    }

    function storageImages(valor){
    var imagen = $("#imagenC"+ valor).val();
    localStorage.setItem("imagenC"+ valor, imagen);
    }

    function gdatos(){
        var emblechicos = $("#emblechicos").val();
        localStorage.setItem("emblechicos", emblechicos);
        var emblegrandes = $("#emblegrandes").val();
        localStorage.setItem("emblegrandes", emblegrandes);
    }
    function guardarDGPL() {
        app.preloader.show('blue');
        if ($("#empresa").val() == "" || $("#canEmpleados").val() == "" || $("#fecAudi").val() == "" || $("#hora").val() == "") {
            swal("", "Debes llenar todos los campos", "warning");
            app.preloader.hide();
            return false;
        }
        var empresa = $("#empresa").val();
        var canEmpleados = $("#canEmpleados").val();
        var fecAudi = $("#fecAudi").val();
        var hora = $("#hora").val();
        var contacto = $("#contacto").val();
        var puesto = $("#puesto").val();
        var correo = $("#mail").val();
        var movil = $("#movil").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("UPDATE DG_PlatoL SET  DG_CEmpleados  = ? ,DG_Empresa = ?, DG_FechaA= ?,DG_HoraA = ?, DG_Contacto = ?, DG_Puesto = ?, DG_Correo = ?, DG_Movil = ? WHERE DG_ID_Cedula = ?",
                    [canEmpleados, empresa, fecAudi, hora, contacto, puesto, correo, movil, id_cedula],
                    function (tx, results) {
                        $("#empresa").css("background-color", "#FFFFFF");
                        $("#canEmpleados").css("background-color", "#FFFFFF");
                        $("#fecAudi").css("background-color", "#FFFFFF");
                        $("#puesto").css("background-color", "#FFFFFF");
                        $("#contacto").css("background-color", "#FFFFFF");
                        $("#mail").css("background-color", "#FFFFFF");
                        $("#movil").css("background-color", "#FFFFFF");

                        swal("", "Se guardaron los datos correctamente", "success");
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarCCharolaPPL(tipo) {
        app.preloader.show('blue');
        if ($("#RespMD").val() == "" || $("#EscalaR").val() == "" || $("#areaOportunidad").val() == "" || $("#Comentarios").val() == "") {
            swal("", "Debes llenar todos los campos", "warning");
            app.preloader.hide();
            return false;
        }
        var RespMD = $("#RespMD").val();
        var EscalaR = $("#EscalaR").val();
        var areaOportunidad = $("#areaOportunidad").val();
        var Comentarios = $("#Comentarios").val();
        var id_cedula = localStorage.getItem("IdCedula");
        var etapa = $("#Etapa").val();
        $('select[name="Etapa"] option:selected ').html(function (a, cambiar) {
            return cambiar.replace('✘', '✔');
        });
        var jq = $('select[name="Etapa"] option:selected').text();
        var foto = $("#imagenC").val();
        var recorrido = 1;
        //var proceso= 1;
        var titulo = "" + jq;
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        if (foto) {
            productHandler.PLFotos(id_cedula, recorrido, etapa, titulo, fecha_foto, foto);
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from Ciclo_Charola WHERE CC_ID_Cedula = ? and CC_Etapa =?",
                    [id_cedula, etapa],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            // console.log("Insert")
                            tx.executeSql("insert into Ciclo_Charola(CC_ID_Cedula,CC_tipo,CC_Etapa,CC_Escala,CC_Oportunidad,CC_Comentario,CC_Responsable) values(?,?,?,?,?,?,?)",
                                [id_cedula, tipo, etapa, EscalaR, areaOportunidad, Comentarios, RespMD],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    //console.log("Registro de Ciclo_Charola exitosamente");
                                    $("#imagenC").val("");
                                    $("#smallImage").attr('src', 'img/blank.png');
                                    $("#photoIcon").attr("src", "img/camera.svg");
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Ciclo_Charola: " + error.message);
                                }
                            );

                        } else {
                            //console.log("Update")
                            tx.executeSql("UPDATE Ciclo_Charola SET CC_Responsable = ?, CC_Escala = ?, CC_Oportunidad = ? ,CC_Comentario = ? WHERE CC_ID_Cedula = ? and CC_Etapa =?  ",
                                [RespMD, EscalaR, areaOportunidad, Comentarios, id_cedula, etapa],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    $("#imagenC").val("");
                                    $("#smallImage").attr('src', 'img/blank.png');
                                    $("#photoIcon").attr("src", "img/camera.svg");
                                    // console.log("Registro de Ciclo_Charola exitosamente");
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Ciclo_Charola: " + error.message);
                                }
                            );
                        }
                        $("#RespMD").css("background-color", "#FFFFFF");
                        $("#EscalaR").css("background-color", "#FFFFFF");
                        $("#areaOportunidad").css("background-color", "#FFFFFF");
                        $("#Comentarios").css("background-color", "#FFFFFF");
                        $("#IdCedula").css("background-color", "#FFFFFF");
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );

    }

    function EtapasLP(id, value) {
        $("#tabla_ciclo_charola tbody").empty("");
        var id_cedula = localStorage.getItem("IdCedula");
        if (value == 1 || value == 12) {
            $(Protocolo).val("A,C")
        } else if (value == 2 || value == 3) {
            $(Protocolo).val("B,C")
        } else if (value == 4 || value == 9) {
            $(Protocolo).val("B,C,D")
        } else if (value == 5) {
            $(Protocolo).val("A,B,C,E")
        } else if (value == 6 || value == 7) {
            $(Protocolo).val("A,B,D")
        } else if (value == 8) {
            $(Protocolo).val("A,B,C,D")
        } else if (value == 10) {
            $(Protocolo).val("A")
        } else if (value == 11) {
            $(Protocolo).val("A,B,C")
        } else if (value == 13) {
            $(Protocolo).val("A,B")
        } else if (value == 14) {
            $(Protocolo).val("C,D")
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Select * from Ciclo_Charola WHERE CC_ID_Cedula = ? and CC_Etapa = ?",
                    [id_cedula, value],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);
                                $("#RespMD").val(item.CC_Responsable);
                                $("#areaOportunidad").val(item.CC_Oportunidad)
                                $("#Comentarios").val(item.CC_Comentario)
                                $("#EscalaR").val(item.CC_Escala)
                                $('select[name="Etapa"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('✘', '✔');
                                });
                                // $("#Etapa").css("background-color", "#66D654")
                                databaseHandler.db.transaction(
                                    function (tx) {
                                        tx.executeSql(
                                            "Select * from PL_Fotos WHERE F_ID_Cedula = ? and F_Recorrido = ? and F_Proceso = ?",
                                            [id_cedula, 1, value],
                                            function (tx, results) {
                                                let length = results.rows.length;
                                                if (length > 0) {
                                                    for (var i = 0; i < length; i++) {
                                                        var item = results.rows.item(i);
                                                        $("#tabla_ciclo_charola tbody").append("<tr id='fila" + item.F_ID_Fotos + "'><td><a href='#' onclick='eliminarFila(" + item.F_ID_Fotos + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + item.F_Foto + "' width='60px'/></td><td style='text-align: center;'>" + item.F_titulo + "</td><td style='text-align: center;'>" + item.F_FechaHora + "</td></tr>");
                                                        $("#message-nr").hide();
                                                    }
                                                } else {
                                                    $("#message-nr").show();
                                                }

                                            },
                                            function (tx, error) {
                                                console.log("Error al guardar registroPL: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function (error) { },
                                    function () { }
                                );
                            }
                        } else {
                            $("#RespMD").val("");
                            $("#areaOportunidad").val("")
                            $("#Comentarios").val("")
                            $("#EscalaR").val("")
                            $("#imagenC").val("");
                            $("#smallImage").attr('src', 'img/blank.png');
                            $("#photoIcon").attr("src", "img/camera.svg");
                            $("#message-nr").show();
                            $("#tabla_ciclo_charola tbody").empty("");
                            // $("#Etapa").css("background-color", "red");
                            $('select[name="Etapa"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('✔', '✘');
                            });

                        }
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );



    }

    function NombrePuesto(id, value){
        console.log('VALUE',value)
        if (value == 1 ) {
            $(Actividades).val("Usuario final y principal riesgo a convertirse en víctima en caso de no cumplirse las  sanitización y posible portador")
            $(Tipo).val("Responsable del cumplimiento de cocina")
        } else if (value == 2 ) {
            $(Actividades).val("Responsable del cumplimiento a protocolos de sanitización dentro toda la empresa")
            $(Tipo).val("Responsivo")
        } else if (value == 3 ) {
            $(Actividades).val("Responsable de condiciones de prestaciones a todo colaborador")
            $(Tipo).val("Responsivo")
        } else if (value == 4) {
            $(Actividades).val("Responsable del cumplimiento de cocina")
            $(Tipo).val("Responsivo")
        } else if (value == 5 ) {
            $(Actividades).val("Responsable del cumplimiento protocolos de sanitización dentro del área de cocina");
            $(Tipo).val("Responsivo");
        } else if (value == 6 || value == 7 || value == 8 || value == 9) {
            $(Actividades).val("Responsable de la Correcta Operación/ Manipulación o Actividades directas  para el cumplimiento de la sanitización")
            $(Tipo).val(" Manipulación Directa Riesgo Crítico");       
        } else if (value == 10) {
            $(Actividades).val("Responsable de la Correcta Operación/ Manipulación o Actividades directas  para el cumplimiento de la sanitización")
            $(Tipo).val(" Manipulación Eventual");  
        }else if (value == 11) {
            $(Actividades).val(" ");
            $(Tipo).val(" "); 
            $(Actividades).prop("disabled", false);
            $(Tipo).prop("disabled", false);
        

        }


    }

    function EquipoActual(id, value){
        console.log('VL',value)
        if (value == 9 || value == 11 || value == 12 || value == 13 || value == 15 || value == 16 ) {
            console.log('Entro 1')
            $(Boiler).show();
            $(booster).show();
            $(Lavaloza).show();
            $(pregunta).css("display", "none");

        

        } else {
            console.log('Entro 1')
            $(Boiler).hide();
            $(booster).hide();
            $(Lavaloza).hide();
            $(pregunta).css("display", "block");

        } 



    }

    function fromPL10(id, value){
        if(value == 1 || value == 2){
            $(suciedad).hide();
            $(detergente).hide();
            $(pregunta).css("display", "block");
        }else{
            $(suciedad).show();
            $(detergente).show();
            $(pregunta).css("display", "none");
        }
    }
    var i = 0;
    function saveTempFoto(){
        i++;
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if($('select[name="Etapa"] option:selected ').html().includes("✘")){
            var text = $('select[name="Etapa"] option:selected ').html().split("✘")
        } else {
            var text = $('select[name="Etapa"] option:selected ').html().split("✔")
        }
        $("#tabla_ciclo_charola tbody").append("<tr id='fila" + i + "'><td><a href='#' onclick='eliminarFila(" + i + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></><td><img src='" + $('#imagenC').val() + "' width='60px'/></td><td style='text-align: center;'>" + text[1] + "</td><td style='text-align: center;'>" + fecha_registro + "</td></tr>");
        $("#message-nr").css("display","none");
    }
    // Fin Plato Limpio 
    //FIled Inicio
    function buscarClienteField(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#cliente-Field").val();
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                app.views.main.router.navigate({name: 'menuField'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function iniciarClienteField(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        
        var nombre_cliente = localStorage.getItem("nombreCliente");
        var tipo = localStorage.getItem("tipoServicio");
        var orden_servicio = localStorage.getItem("ordenServicio");
        var estatus = 0;
        if(tipo == "Levantamiento"){
            var tipoCedula = "levantamiento";
        } else if(tipo == "Mantenimiento"){
            var tipoCedula = "mantenimiento";
        }
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                if(tipo == "Levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addLevantamientoFieldC(id_cedula,foto_llegada,nombre_cliente,orden_servicio);
                                                    app.views.main.router.back('/recorridoField1/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                } else if(tipo == "Mantenimiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addMantenimientoFieldC(id_cedula,foto_llegada,nombre_cliente,orden_servicio);
                                                    app.views.main.router.back('/recorridoField2/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }
                                
                                // app.views.main.router.navigate({name: 'menuField'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarLevantamientoField(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "levantamiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addLevantamientoField(id_cedula,foto_llegada,nombre_cliente);
                        app.views.main.router.navigate({name: 'recorridoField1'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarMantenimientoField(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "mantenimiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addMantenimientoField(id_cedula,foto_llegada,nombre_cliente);
                        app.views.main.router.navigate({name: 'recorridoField2'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosLevantamientoField(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var contacto = $("#nombreContacto").val();
        var telefono = $("#telefonoContacto").val();
        var correo = $("#correoContacto").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET nombre_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ? WHERE id_cedula = ?",
                    [cliente,contacto,telefono,correo,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosMantenimientoField(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == "" || ($("#servicioC").prop("checked") == false && $("#servicioP").prop("checked") == false)){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var contacto = $("#nombreContacto").val();
        var telefono = $("#telefonoContacto").val();
        var correo = $("#correoContacto").val();
        if($("#servicioC").prop("checked") == true){
            var servicio = "1";
        } else if($("#servicioP").prop("checked")){
            var servicio = "2";
        }
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_Field SET nombre_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ?,tipo_servicio = ? WHERE id_cedula = ?",
                    [cliente,contacto,telefono,correo,servicio,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarMantenimientoField(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var orden = $("#ordenServicio").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var serie = $("#numeroSerie").val();
        var descripcion = $('#descripcion').val();
        var foto = $('#imagenC').val()
        var equipo = $('#imagenC1').val()
        var fecha = new Date();
        var fase = "antes";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_Field SET orden_servicio = ?,marca = ?,modelo = ?,numero_serie = ?,foto_equipo = ? WHERE id_cedula = ?",
                    [orden,marca,modelo,serie,equipo,id_cedula],
                    function(tx, results){
                        $("#ordenServicio").css("background-color", "#FFFFFF");
                        $("#marca").css("background-color", "#FFFFFF");
                        $("#modelo").css("background-color", "#FFFFFF");
                        $("#numeroSerie").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO evidencia_mantenimiento_Field(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                                    [id_cedula,fase,descripcion,foto,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_Field",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from evidencia_mantenimiento_Field where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#descripcion").val("");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#tabla_mantenimiento tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaField("+ item.id_evidencia +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarEquipoField(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var orden = $("#ordenServicio").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var serie = $("#numeroSerie").val();
        var motor = $("#tipoMotor").val();
        var boquilla = $("#tipoBoquilla").val();
        var combustible = $("#tipoCombustible").val();
        var mastil = $("#tipoMastil").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET orden_servicio = ?,marca = ?,modelo = ?,numero_serie = ?,tipo_motor = ?,tipo_boquilla = ?,tipo_combustible = ?,tipo_mastil = ? WHERE id_cedula = ?",
                    [orden,marca,modelo,serie,motor,boquilla,combustible,mastil,id_cedula],
                    function(tx, results){
                        $("#ordenServicio").css("background-color", "#FFFFFF");
                        $("#marca").css("background-color", "#FFFFFF");
                        $("#modelo").css("background-color", "#FFFFFF");
                        $("#numeroSerie").css("background-color", "#FFFFFF");
                        $("#tipoMotor").css("background-color", "#FFFFFF");
                        $("#tipoBoquilla").css("background-color", "#FFFFFF");
                        $("#tipoCombustible").css("background-color", "#FFFFFF");
                        $("#tipoMastil").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarLevantamientoField(){
        app.preloader.show('blue');
        if($("#comentariosEquipo").val() == "" || $('#lugarReparacion').val() == "0" || ($("#reparadoSi").prop("checked") == false && $("#reparadoNo").prop("checked") == false) || $('#observaciones').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var comentariosEquipo = $("#comentariosEquipo").val();
        var lugarReparacion = $('#lugarReparacion').val()
        if($("#reparadoSi").prop("checked") == true){
            var reparado = "1";
        } else if($("#reparadoNo").prop("checked")){
            var reparado = "2";
        }
        var observaciones = $('#observaciones').val();
        var foto = $('#imagenC').val()
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET comentario_equipo = ?,lugar_reparacion = ?,reparo_visita = ? WHERE id_cedula = ?",
                    [comentariosEquipo,lugarReparacion,reparado,id_cedula],
                    function(tx, results){
                        $("#comentariosEquipo").css("background-color", "#FFFFFF");
                        $("#lugarReparacion").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO evidencia_levantamiento_Field(id_cedula,observacion,foto_observacion,fecha_regristro) VALUES (?,?,?,?)",
                                    [id_cedula,observaciones,foto,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_levantamiento_Field",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from evidencia_levantamiento_Field where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#observaciones").val("");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#tabla_levantamiento tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaField("+ item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_observacion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.observacion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedField(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoField1'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoField2'});
        }
    }
    function continuarCedMer(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoMerGroup'});
        }
    }
    function eliminarFilaField(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_levantamiento_Field WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_Field WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_Field WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 4) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_Field WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarPiezaField(){
        app.preloader.show('blue');
        if($("#pieza").val() == "" || $('#imagenC1').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var pieza = $("#pieza").val();
        var foto = $('#imagenC1').val();
        var fase = "pieza";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_mantenimiento_Field(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,pieza,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_Field",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_mantenimiento_Field where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage1").attr("src","img/blank.png");
                                                        $("#pieza").val("");
                                                        $('#imagenC1').val("");
                                                        $("#photoIcon1").attr("src","img/camera.svg");
                                                        $("#pieza").css("background-color", "#FFFFFF");
                                                        $("#tabla_pieza tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaField("+ item.id_evidencia +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr1").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Pieza guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCambioField(){
        app.preloader.show('blue');
        if($("#cambio").val() == "" || $('#imagenC').val() == "" || ($("#piezaChk").prop("checked") == false && $("#cambioChk").prop("checked") == false)){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var pieza = $("#cambio").val();
        var foto = $('#imagenC').val();
        if($("#piezaChk").prop("checked") == true){
            var fase = "pieza";
        } else {
            var fase = "cambio";
        }
        // var fase = "cambio";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_mantenimiento_Field(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,pieza,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_Field",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_mantenimiento_Field where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#cambio").val("");
                                                        $('#imagenC').val("");
                                                        $("#cambioChk").prop("checked", false);
                                                        $("#piezaChk").prop("checked", false);
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#cambio").css("background-color", "#FFFFFF");
                                                        $("#tabla_cambio tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaField("+ item.id_evidencia +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Pieza guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreLevantamientoField(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoylevantamientoField/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreMantenimientoField(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_Field SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoymantenimientoField/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarLevantamientoField(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarMantenimientooField(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_Field SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function singleCheck1(valor){
        if($("#reparadoNo").prop("checked") === true){
            $("#reparadoNo").prop("checked", false);
        }
    }
    function singleCheck2(valor){
        if($("#reparadoSi").prop("checked") === true){
            $("#reparadoSi").prop("checked", false);
        }
    }
    function datosCheck1(valor){
        if($("#servicioP").prop("checked") === true){
            $("#servicioP").prop("checked", false);
        }
    }
    function datosCheck2(valor){
        if($("#servicioC").prop("checked") === true){
            $("#servicioC").prop("checked", false);
        }
    }
    function ingressCheck1(valor){
        if($("#cambioChk").prop("checked") === true){
            $("#cambioChk").prop("checked", false);
        }
    }
    function ingressCheck2(valor){
        if($("#piezaChk").prop("checked") === true){
            $("#piezaChk").prop("checked", false);
        }
    }
    function checkAndSave(id,valor,parte){
        let id_cedula = localStorage.getItem("IdCedula");
        var currentId = id.split("-");
        if(id.includes("1")){
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-2").prop("checked", false);
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-2").prop("checked") == false){
                valor = "0";
            }
        } else {
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-1").prop("checked", false);
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-1").prop("checked") == false){
                valor = "0";
            }
        }
        if(parte == 1){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE reporteGeneral SET cotizacion = ? WHERE id_cedula = ?",
                        [valor,id_cedula],
                        function(tx, results){},
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(parte == 2){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE reporteGeneral SET viaticos = ? WHERE id_cedula = ?",
                        [valor,id_cedula],
                        function(tx, results){},
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(parte == 3){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE reporteGeneral SET refacciones = ? WHERE id_cedula = ?",
                        [valor,id_cedula],
                        function(tx, results){},
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function startFromProgramField(nombre,tipo,orden,descripcion){
        localStorage.setItem("nombreCliente", nombre);
        localStorage.setItem("tipoServicio", tipo);
        localStorage.setItem("ordenServicio", orden);
        localStorage.setItem("descripcion", descripcion);
        app.views.main.router.navigate({name: 'yallegueField2'});
    }
    function regresarRecorridoField1(){
        app.views.main.router.back('/recorridoField1/', {force: true, ignoreCache: true, reload: true});
    }
    function regresarRecorridoField2(){
        app.views.main.router.back('/recorridoField2/', {force: true, ignoreCache: true, reload: true});
    }
    function captureSingleField() {
        navigator.camera.getPicture(onSinglePhotoFieldSucceess, onSinglePhotoFieldFail, {
          quality: 100,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSinglePhotoFieldSucceess(imageData) {
        var smallImage = document.getElementById('smallImage1');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC1").val(nameima);
        $("#photoIcon1").attr("src","img/reload.svg");
    }
    function onSinglePhotoFieldFail(message) {
        swal("Error al tomar foto:",message,"error");
    }
    //Field Fin
    //SMC Inicio
    function buscarClienteSMC(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#id_cliente").val();
        var horario_programado = $("#HorarioProgramado").val();
        var foto_llegada = $("#imagenC").val();
        var RFC = $("#RFC").val();
        var NombreContacto = $("#NombreContacto").val();
        var TelefonoContacto = $("#TelefonoContacto").val();
        var CorreoContacto = $("#CorreoContacto").val();
        var TipoServicio = $("#TipoServicio").val();
        var nombre_cliente = $("#cliente-smc").val();
        
        if($("#brand").val() == ""){
            var brand = "0";
        } else {
            var brand = $("#brand").val();
        }
        
        if($("#motor_type").val() == ""){
            var motor_type = "0";
        } else {
            var motor_type = $("#motor_type").val();
        }
        
        if($("#motor_brand").val() == ""){
            var motor_brand = "0";
        } else {
            var motor_brand = $("#motor_brand").val();
        }
        
        if($("#motor_model").val() == ""){
            var motor_model = "0";
        } else {
            var motor_model = $("#motor_model").val();
        }
        
        if($("#serie").val() == ""){
            var serie = "0";
        } else {
            var serie = $("#serie").val();
        }
        
        if($("#aditaments").val() == ""){
            var aditaments = "0";
        } else {
            var aditaments = $("#aditaments").val();
        }
        var datosCliente = brand +"/+/"+motor_type+"/+/"+motor_brand+"/+/"+motor_model+"/+/"+serie+"/+/"+aditaments; 
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                localStorage.setItem("RFC", RFC);
                                localStorage.setItem("nombrecontacto", NombreContacto);
                                localStorage.setItem("telefono", TelefonoContacto);
                                localStorage.setItem("correo", CorreoContacto);
                                localStorage.setItem("tiposervicio", TipoServicio);
                                localStorage.setItem("datosCliente", datosCliente);
                                app.views.main.router.navigate({name: 'menuSMC'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function iniciarClienteSMC(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = localStorage.getItem("IdCte");
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = localStorage.getItem("nombreCliente");
        var tipo = localStorage.getItem("tipoServicio");
        var orden_servicio = localStorage.getItem("ordenServicio");
        var datosEquipo = localStorage.getItem("datosEquipo");
        var datosCliente = localStorage.getItem("datosCliente");
        var estatus = 0;
        if(tipo == "Levantamiento"){
            var tipoCedula = "levantamiento";
        } else if(tipo == "Mantenimiento"){
            var tipoCedula = "mantenimiento";
        } else if(tipo == "Ventas"){
            var tipoCedula = "ventaSMC";
        } else if(tipo == "Servicios"){
            var tipoCedula = "servicioSMC";
        }
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                if(tipo == "Levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addLevantamientoSMCC(id_cedula,foto_llegada,nombre_cliente,orden_servicio);
                                                    app.views.main.router.back('/recorridoSMC1/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                } else if(tipo == "Mantenimiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addMantenimientoSMCC(id_cedula,foto_llegada,nombre_cliente,orden_servicio);
                                                    app.views.main.router.back('/recorridoSMC2/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                } else if(tipo == "Ventas"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    var clienteData = datosCliente.split("/+/");
                                                    if(clienteData[0] == 0){
                                                        var rfc = "";
                                                    } else {
                                                        var rfc = clienteData[0];
                                                    }
                                                    if(clienteData[1] == 0){
                                                        var nombre = "";
                                                    } else {
                                                        var nombre = clienteData[1];
                                                    }
                                                    if(clienteData[2] == 0){
                                                        var telefono = "";
                                                    } else {
                                                        var telefono = clienteData[2];
                                                    }
                                                    if(clienteData[3] == 0){
                                                        var correo = "";
                                                    } else {
                                                        var correo = clienteData[3];
                                                    }
                                                    if(clienteData[4] == 0){
                                                        var tipo = "";
                                                    } else {
                                                        var tipo = clienteData[4];
                                                    }
                                                    productHandler.addVentaSMC(id_cedula,foto_llegada,nombre_cliente,rfc,nombre,telefono,correo,tipo);
                                                    if(datosEquipo == 0){
                                                        
                                                    } else {
                                                        var equipoData = datosEquipo.split("/+/");
                                                        var marca = equipoData[0];
                                                        var tipo_motor = equipoData[1];
                                                        var marca_motor = equipoData[2];
                                                        var modelo = equipoData[3];
                                                        var serie = equipoData[4];
                                                        var aditamentos = equipoData[5];
                                                        productHandler.addEquipoSMC(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos);
                                                    }
                                                    app.views.main.router.back('/recorridoSMC3/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                } else if(tipo == "Servicios"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    var clienteData = datosCliente.split("/+/");
                                                    if(clienteData[0] == 0){
                                                        var rfc = "";
                                                    } else {
                                                        var rfc = clienteData[0];
                                                    }
                                                    if(clienteData[1] == 0){
                                                        var nombre = "";
                                                    } else {
                                                        var nombre = clienteData[1];
                                                    }
                                                    if(clienteData[2] == 0){
                                                        var telefono = "";
                                                    } else {
                                                        var telefono = clienteData[2];
                                                    }
                                                    if(clienteData[3] == 0){
                                                        var correo = "";
                                                    } else {
                                                        var correo = clienteData[3];
                                                    }
                                                    if(clienteData[4] == 0){
                                                        var tipo = "";
                                                    } else {
                                                        var tipo = clienteData[4];
                                                    }
                                                    productHandler.addServicioSMC(id_cedula,foto_llegada,nombre_cliente,rfc,nombre,telefono,correo,tipo);
                                                    if(datosEquipo == 0){
                                                        
                                                    } else {
                                                        var equipoData = datosEquipo.split("/+/");
                                                        var marca = equipoData[0];
                                                        var tipo_motor = equipoData[1];
                                                        var marca_motor = equipoData[2];
                                                        var modelo = equipoData[3];
                                                        var serie = equipoData[4];
                                                        var aditamentos = equipoData[5];
                                                        productHandler.addEquipoSMC2(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos);
                                                    }
                                                    app.views.main.router.back('/recorridoSMC4/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }
                                
                                // app.views.main.router.navigate({name: 'menuSMC'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarLevantamientoSMC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "levantamiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addLevantamientoSMC(id_cedula,foto_llegada,nombre_cliente);
                        app.views.main.router.navigate({name: 'recorridoSMC1'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarMantenimientoSMC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "mantenimiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addMantenimientoSMC(id_cedula,foto_llegada,nombre_cliente);
                        app.views.main.router.navigate({name: 'recorridoSMC2'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarVentaSMC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let RFC = localStorage.getItem("RFC");
        let nombrecontacto = localStorage.getItem("nombrecontacto");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        let tiposervicio = localStorage.getItem("tiposervicio");
        let tipoCedula = "ventaSMC";
        var datosEquipo = localStorage.getItem("datosCliente");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){
            },
            function(){
                productHandler.addVentaSMC(id_cedula,foto_llegada,nombre_cliente,RFC,nombrecontacto,telefono,correo,tiposervicio);
                var equipoData = datosEquipo.split("/+/");
                if(equipoData[0] == "0"){
                    var marca = "";
                } else {
                    var marca = equipoData[0];
                }
                if(equipoData[1] == "0"){
                    var tipo_motor = "";
                } else {
                    var tipo_motor = equipoData[1];
                }
                if(equipoData[2] == "0"){
                    var marca_motor = "";
                } else {
                    var marca_motor = equipoData[2];
                }
                if(equipoData[3] == "0"){
                    var modelo = "";
                } else {
                    var modelo = equipoData[3];
                }
                if(equipoData[4] == "0"){
                    var serie = "";
                } else {
                    var serie = equipoData[4];
                }
                if(equipoData[5] == "0"){
                    var aditamentos = "";
                } else {
                    var aditamentos = equipoData[5];
                }
                productHandler.addEquipoSMC(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos);
                app.views.main.router.navigate({name: 'recorridoSMC3'});
            }
        );
    }
    function generarServicioSMC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let RFC = localStorage.getItem("RFC");
        let nombrecontacto = localStorage.getItem("nombrecontacto");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        let tiposervicio = localStorage.getItem("tiposervicio");
        let tipoCedula = "servicioSMC";
        var datosEquipo = localStorage.getItem("datosCliente");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addServicioSMC(id_cedula,foto_llegada,nombre_cliente,RFC,nombrecontacto,telefono,correo,tiposervicio);
                        var equipoData = datosEquipo.split("/+/");
                        if(equipoData[0] == "0"){
                            var marca = "";
                        } else {
                            var marca = equipoData[0];
                        }
                        if(equipoData[1] == "0"){
                            var tipo_motor = "";
                        } else {
                            var tipo_motor = equipoData[1];
                        }
                        if(equipoData[2] == "0"){
                            var marca_motor = "";
                        } else {
                            var marca_motor = equipoData[2];
                        }
                        if(equipoData[3] == "0"){
                            var modelo = "";
                        } else {
                            var modelo = equipoData[3];
                        }
                        if(equipoData[4] == "0"){
                            var serie = "";
                        } else {
                            var serie = equipoData[4];
                        }
                        if(equipoData[5] == "0"){
                            var aditamentos = "";
                        } else {
                            var aditamentos = equipoData[5];
                        }
                        productHandler.addEquipoSMC2(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos);
                        app.views.main.router.navigate({name: 'recorridoSMC4'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){}
        );
    }
    function guardarDatosLevantamientoSMC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var contacto = $("#nombreContacto").val();
        var telefono = $("#telefonoContacto").val();
        var correo = $("#correoContacto").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_smc SET nombre_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ? WHERE id_cedula = ?",
                    [cliente,contacto,telefono,correo,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosMantenimientoSMC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == "" || ($("#servicioC").prop("checked") == false && $("#servicioP").prop("checked") == false)){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var contacto = $("#nombreContacto").val();
        var telefono = $("#telefonoContacto").val();
        var correo = $("#correoContacto").val();
        if($("#servicioC").prop("checked") == true){
            var servicio = "1";
        } else if($("#servicioP").prop("checked")){
            var servicio = "2";
        }
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_smc SET nombre_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ?,tipo_servicio = ? WHERE id_cedula = ?",
                    [cliente,contacto,telefono,correo,servicio,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosVentaSMC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#rfc").val() == "" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == "" || $("#tipoVisita").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var rfc = $("#rfc").val();
        var nombreContacto = $("#nombreContacto").val();
        var telefonoContacto = $("#telefonoContacto").val();
        var correoContacto = $("#correoContacto").val();
        var tipoVisita = $("#tipoVisita").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET nombre_cliente = ?,rfc_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ?,tipo_visita = ? WHERE id_cedula = ?",
                    [cliente,rfc,nombreContacto,telefonoContacto,correoContacto,tipoVisita,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#rfc").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        $("#tipoVisita").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosServicioSMC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#rfc").val() == "" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == "" || $("#tipoVisita").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var rfc = $("#rfc").val();
        var nombreContacto = $("#nombreContacto").val();
        var telefonoContacto = $("#telefonoContacto").val();
        var correoContacto = $("#correoContacto").val();
        var tipoVisita = $("#tipoVisita").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET nombre_cliente = ?,rfc_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ?,tipo_visita = ? WHERE id_cedula = ?",
                    [cliente,rfc,nombreContacto,telefonoContacto,correoContacto,tipoVisita,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#rfc").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        $("#tipoVisita").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarMantenimientoSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var orden = $("#ordenServicio").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var serie = $("#numeroSerie").val();
        var descripcion = $('#descripcion').val();
        var foto = $('#imagenC').val()
        var equipo = $('#imagenC1').val()
        var fecha = new Date();
        var fase = "antes";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_smc SET orden_servicio = ?,marca = ?,modelo = ?,numero_serie = ?,foto_equipo = ? WHERE id_cedula = ?",
                    [orden,marca,modelo,serie,equipo,id_cedula],
                    function(tx, results){
                        $("#ordenServicio").css("background-color", "#FFFFFF");
                        $("#marca").css("background-color", "#FFFFFF");
                        $("#modelo").css("background-color", "#FFFFFF");
                        $("#numeroSerie").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO evidencia_mantenimiento_smc(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                                    [id_cedula,fase,descripcion,foto,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_smc",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from evidencia_mantenimiento_smc where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#descripcion").val("");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#tabla_mantenimiento tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarVentasAntesSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var comentarios = $('#comentarios').val();
        var fecha = new Date();
        var fase = "antes";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET comentario_antes = ? WHERE id_cedula = ?",
                    [comentarios,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                if(foto){
                                    tx.executeSql("INSERT INTO evidencia_venta_smc(id_cedula,fase,foto,fecha_regristro) VALUES (?,?,?,?)",
                                        [id_cedula,fase,foto,fecha_registro],
                                        function(tx, results){
                                            app.preloader.hide();
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_venta_smc",
                                                        [],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            var id_evidencia = item.Id;
                                                            app.preloader.hide();
                                                            //Consultar el producto
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("Select * from evidencia_venta_smc where id_evidencia = ?",
                                                                    [id_evidencia],
                                                                        function(tx, results){
                                                                            var item = results.rows.item(0);
                                                                            $("#smallImage").attr("src","img/blank.png");
                                                                            $('#imagenC').val("");
                                                                            $("#photoIcon").attr("src","img/camera.svg");
                                                                            $("#tabla_ventas tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                            $("#message-nr").css("display", "none");
                                                                            $('.preloader').remove();
                                                                            $('.infinite-scroll-preloader').remove();
                                                                            app.preloader.hide();
                                                                        },
                                                                        function(tx, error){
                                                                            console.log("Error al guardar cedula: " + error.message);
                                                                            app.preloader.hide();
                                                                        }
                                                                    );
                                                                },
                                                                function(error){},
                                                                function(){}
                                                            );
                                                        },
                                                        function(tx, error){
                                                            swal("Error al mostrar Registro guardado",error.message,"error");
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                            swal("","Registro guardado","success");
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            swal("Error al guardar plaga",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                } else {
                                    if(comentarios){
                                        swal("","Comentario general Actualizado","success");
                                        app.preloader.hide();
                                    } else {
                                        swal("","No hay datos para guardar, ingresa una foto o un comentario.","warning");
                                        app.preloader.hide();
                                    }
                                    
                                }
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarServicioAntesSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var comentarios = $('#comentarios').val();
        var fecha = new Date();
        var fase = "antes";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET comentario_antes = ? WHERE id_cedula = ?",
                    [comentarios,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                if(foto){
                                    tx.executeSql("INSERT INTO evidencia_servicio_smc(id_cedula,fase,foto,fecha_regristro) VALUES (?,?,?,?)",
                                        [id_cedula,fase,foto,fecha_registro],
                                        function(tx, results){
                                            app.preloader.hide();
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_servicio_smc",
                                                        [],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            var id_evidencia = item.Id;
                                                            app.preloader.hide();
                                                            //Consultar el producto
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("Select * from evidencia_servicio_smc where id_evidencia = ?",
                                                                    [id_evidencia],
                                                                        function(tx, results){
                                                                            var item = results.rows.item(0);
                                                                            $("#smallImage").attr("src","img/blank.png");
                                                                            $('#imagenC').val("");
                                                                            $("#photoIcon").attr("src","img/camera.svg");
                                                                            $("#tabla_ventas tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                            $("#message-nr").css("display", "none");
                                                                            $('.preloader').remove();
                                                                            $('.infinite-scroll-preloader').remove();
                                                                            app.preloader.hide();
                                                                        },
                                                                        function(tx, error){
                                                                            console.log("Error al guardar cedula: " + error.message);
                                                                            app.preloader.hide();
                                                                        }
                                                                    );
                                                                },
                                                                function(error){},
                                                                function(){}
                                                            );
                                                        },
                                                        function(tx, error){
                                                            swal("Error al mostrar Registro guardado",error.message,"error");
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                            swal("","Registro guardado","success");
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            swal("Error al guardar plaga",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                } else {
                                    if(comentarios){
                                        swal("","Comentario general Actualizado","success");
                                        app.preloader.hide();
                                    } else {
                                        swal("","No hay datos para guardar, ingresa una foto o un comentario.","warning");
                                        app.preloader.hide();
                                    }
                                    
                                }
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarVentasDespuesSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var comentarios = $('#comentarios').val();
        var fecha = new Date();
        var fase = "despues";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET comentario_despues = ? WHERE id_cedula = ?",
                    [comentarios,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                if(foto){
                                    tx.executeSql("INSERT INTO evidencia_venta_smc(id_cedula,fase,foto,fecha_regristro) VALUES (?,?,?,?)",
                                        [id_cedula,fase,foto,fecha_registro],
                                        function(tx, results){
                                            app.preloader.hide();
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_venta_smc",
                                                        [],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            var id_evidencia = item.Id;
                                                            app.preloader.hide();
                                                            //Consultar el producto
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("Select * from evidencia_venta_smc where id_evidencia = ?",
                                                                    [id_evidencia],
                                                                        function(tx, results){
                                                                            var item = results.rows.item(0);
                                                                            $("#smallImage").attr("src","img/blank.png");
                                                                            $('#imagenC').val("");
                                                                            $("#photoIcon").attr("src","img/camera.svg");
                                                                            $("#tabla_ventas tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                            $("#message-nr").css("display", "none");
                                                                            $('.preloader').remove();
                                                                            $('.infinite-scroll-preloader').remove();
                                                                            app.preloader.hide();
                                                                        },
                                                                        function(tx, error){
                                                                            console.log("Error al guardar cedula: " + error.message);
                                                                            app.preloader.hide();
                                                                        }
                                                                    );
                                                                },
                                                                function(error){},
                                                                function(){}
                                                            );
                                                        },
                                                        function(tx, error){
                                                            swal("Error al mostrar Registro guardado",error.message,"error");
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                            swal("","Registro guardado","success");
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            swal("Error al guardar plaga",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                } else {
                                    if(comentarios){
                                        swal("","Comentario general Actualizado","success");
                                        app.preloader.hide();
                                    } else {
                                        swal("","No hay datos para guardar, ingresa una foto o un comentario.","warning");
                                        app.preloader.hide();
                                    }
                                    
                                }
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarServicioDespuesSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var comentarios = $('#comentarios').val();
        var fecha = new Date();
        var fase = "despues";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET comentario_despues = ? WHERE id_cedula = ?",
                    [comentarios,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                if(foto){
                                    tx.executeSql("INSERT INTO evidencia_servicio_smc(id_cedula,fase,foto,fecha_regristro) VALUES (?,?,?,?)",
                                        [id_cedula,fase,foto,fecha_registro],
                                        function(tx, results){
                                            app.preloader.hide();
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_servicio_smc",
                                                        [],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            var id_evidencia = item.Id;
                                                            app.preloader.hide();
                                                            //Consultar el producto
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("Select * from evidencia_servicio_smc where id_evidencia = ?",
                                                                    [id_evidencia],
                                                                        function(tx, results){
                                                                            var item = results.rows.item(0);
                                                                            $("#smallImage").attr("src","img/blank.png");
                                                                            $('#imagenC').val("");
                                                                            $("#photoIcon").attr("src","img/camera.svg");
                                                                            $("#tabla_ventas tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                            $("#message-nr").css("display", "none");
                                                                            $('.preloader').remove();
                                                                            $('.infinite-scroll-preloader').remove();
                                                                            app.preloader.hide();
                                                                        },
                                                                        function(tx, error){
                                                                            console.log("Error al guardar cedula: " + error.message);
                                                                            app.preloader.hide();
                                                                        }
                                                                    );
                                                                },
                                                                function(error){},
                                                                function(){}
                                                            );
                                                        },
                                                        function(tx, error){
                                                            swal("Error al mostrar Registro guardado",error.message,"error");
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                            swal("","Registro guardado","success");
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            swal("Error al guardar plaga",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                } else {
                                    if(comentarios){
                                        swal("","Comentario general Actualizado","success");
                                        app.preloader.hide();
                                    } else {
                                        swal("","No hay datos para guardar, ingresa una foto o un comentario.","warning");
                                        app.preloader.hide();
                                    }
                                    
                                }
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarEquipoSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var orden = $("#ordenServicio").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var serie = $("#numeroSerie").val();
        var motor = $("#tipoMotor").val();
        var boquilla = $("#tipoBoquilla").val();
        var combustible = $("#tipoCombustible").val();
        var mastil = $("#tipoMastil").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_smc SET orden_servicio = ?,marca = ?,modelo = ?,numero_serie = ?,tipo_motor = ?,tipo_boquilla = ?,tipo_combustible = ?,tipo_mastil = ? WHERE id_cedula = ?",
                    [orden,marca,modelo,serie,motor,boquilla,combustible,mastil,id_cedula],
                    function(tx, results){
                        $("#ordenServicio").css("background-color", "#FFFFFF");
                        $("#marca").css("background-color", "#FFFFFF");
                        $("#modelo").css("background-color", "#FFFFFF");
                        $("#numeroSerie").css("background-color", "#FFFFFF");
                        $("#tipoMotor").css("background-color", "#FFFFFF");
                        $("#tipoBoquilla").css("background-color", "#FFFFFF");
                        $("#tipoCombustible").css("background-color", "#FFFFFF");
                        $("#tipoMastil").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarLevantamientoSMC(){
        app.preloader.show('blue');
        if($("#comentariosEquipo").val() == "" || $('#lugarReparacion').val() == "0" || ($("#reparadoSi").prop("checked") == false && $("#reparadoNo").prop("checked") == false) || $('#observaciones').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var comentariosEquipo = $("#comentariosEquipo").val();
        var lugarReparacion = $('#lugarReparacion').val()
        if($("#reparadoSi").prop("checked") == true){
            var reparado = "1";
        } else if($("#reparadoNo").prop("checked")){
            var reparado = "2";
        }
        var observaciones = $('#observaciones').val();
        var foto = $('#imagenC').val()
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_smc SET comentario_equipo = ?,lugar_reparacion = ?,reparo_visita = ? WHERE id_cedula = ?",
                    [comentariosEquipo,lugarReparacion,reparado,id_cedula],
                    function(tx, results){
                        $("#comentariosEquipo").css("background-color", "#FFFFFF");
                        $("#lugarReparacion").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO evidencia_levantamiento_smc(id_cedula,observacion,foto_observacion,fecha_regristro) VALUES (?,?,?,?)",
                                    [id_cedula,observaciones,foto,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_levantamiento_smc",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from evidencia_levantamiento_smc where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#observaciones").val("");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#tabla_levantamiento tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_observacion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.observacion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarProspeccionSMC(){
        app.preloader.show('blue');
        if($("#objetivo").val() == "" ||
            $("#necesidad").val() == "" || 
            $("#marca").val() == "" || 
            $("#numeroActivo").val() == ""||
            $("#marcall").val()== "" ||
            $("#llantas").val()== "" ||
            $("#medidas").val()== "" ||
            $("#porque").val()== "" ||
            $("#competencia").val()== "" ||
            $("#sugerencia").val()== "" || 
            $("#comentarios").val()== ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var objetivo = $("#objetivo").val();
        var necesidad = $("#necesidad").val();
        var marca = $("#marca").val();
        var numero = $("#numeroActivo").val();
        var pregunta1 = $('input:radio[name=pregunta1]:checked').val();
        var cuandoc = $("#demo-calendar-modal").val();
        var marcall = $("#marcall").val();
        var llantas = $("#llantas").val();
        var medidas = $("#medidas").val();
        var pregunta2 = $('input:radio[name=pregunta2]:checked').val();
        var porque = $("#porque").val();
        var pregunta3 = $('input:radio[name=pregunta3]:checked').val();
        var cuando = $("#demo-calendar-modal1").val();
        var pregunta4 = $('input:radio[name=pregunta4]:checked').val();
        var cuales = $("#cuales").val();
        var competencia = $("#competencia").val();
        var sugerencia = $("#sugerencia").val();
        var comentarios = $("#comentarios").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET objetivo_prospeccion = ?,necesidad_prospeccion = ?,marca_montacargas_prospeccion = ?,numero_montacargas_prospeccion = ?,status_montacarga_prospeccion = ?,venc_contrato = ?,marca_llantas_prospeccion = ?,tipo_llantas_prospeccion = ?,mediadas_prospeccion = ?,resolvio_prospeccion = ?,por_que_prospeccion = ?,vista_prospeccion = ?,cuando_prospeccion =?, presente_prospeccion = ?,cuales_prospeccion = ?,copetencia_prospeccion = ?,sugerencia_prospeccion = ?,comentarios_prospeccion = ? WHERE id_cedula = ?",
                    [objetivo,necesidad,marca,numero,pregunta1,cuandoc,marcall,llantas,medidas,pregunta2,porque,pregunta3,cuando,pregunta4,cuales,competencia,sugerencia,comentarios,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                swal("","Registro guardado","success");
                                app.preloader.hide();
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosMantenimientoSMC(){
        app.preloader.show('blue');
        if($("#observaciones").val() == "" || $('#estadoGeneral').val() == "0" || $('#numeroMontacargas').val() == "0" || ($("#tipo1").prop("checked") == false && $("#tipo0").prop("checked") == false) || $('#marca').val() == "" || $('#requiereMantenimiento').val() == "0"){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var observaciones = $("#observaciones").val();
        var estadoGeneral = $('#estadoGeneral').val();
        var numeroMontacargas = $('#numeroMontacargas').val();
        if($("#tipo1").prop("checked") == true){
            var tipo = "1";
        } else if($("#tipo0").prop("checked")){
            var tipo = "0";
        }
        var marca = $('#marca').val();
        var requiereMantenimiento = $('#requiereMantenimiento').val()
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET observaciones_prospeccion = ?,estado_monta = ?,numero_monta = ?,tipo_monta = ?,marca = ?,mantenimiento = ? WHERE id_cedula = ?",
                    [observaciones,estadoGeneral,numeroMontacargas,tipo,marca,requiereMantenimiento,id_cedula],
                    function(tx, results){
                        $("#observaciones").css("background-color", "#FFFFFF");
                        $("#estadoGeneral").css("background-color", "#FFFFFF");
                        $("#numeroMontacargas").css("background-color", "#FFFFFF");
                        $("#marca").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                swal("","Registro guardado","success");
                                app.preloader.hide();
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarValoresVentaSMC(){
        app.preloader.show('blue');
        if($("#numeroActivo").val() == "" || $('#numeroContrato').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var numeroActivo = $("#numeroActivo").val();
        var numeroContrato = $('#numeroContrato').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET no_activo = ?,no_contrato = ? WHERE id_cedula = ?",
                    [numeroActivo,numeroContrato,id_cedula],
                    function(tx, results){
                        $("#numeroActivo").css("background-color", "#FFFFFF");
                        $("#numeroContrato").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                swal("","Registro guardado","success");
                                app.preloader.hide();
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarValoresServicioSMC(){
        app.preloader.show('blue');
        if($("#numeroActivo").val() == "" || $('#numeroContrato').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var numeroActivo = $("#numeroActivo").val();
        var numeroContrato = $('#numeroContrato').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET no_activo = ?,no_contrato = ? WHERE id_cedula = ?",
                    [numeroActivo,numeroContrato,id_cedula],
                    function(tx, results){
                        $("#numeroActivo").css("background-color", "#FFFFFF");
                        $("#numeroContrato").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                swal("","Registro guardado","success");
                                app.preloader.hide();
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarEquipoVentaSMC(){
        app.preloader.show('blue');
        if($("#marca").val() == "" || $('#tipoMotor').val() == "" || $('#marcaMotor').val() == "" || $('#modelo').val() == "" || $('#serie').val() == "" || $('#aditamentos').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var marca = $("#marca").val();
        var tipoMotor = $('#tipoMotor').val();
        var marcaMotor = $('#marcaMotor').val();
        var modelo = $('#modelo').val();
        var serie = $('#serie').val();
        var aditamentos = $('#aditamentos').val();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_equipo_smc(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos) VALUES (?,?,?,?,?,?,?)",
                    [id_cedula,marca,tipoMotor,marcaMotor,modelo,serie,aditamentos],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_equipo) as Id from datos_equipo_smc",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_equipo = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from datos_equipo_smc where id_equipo = ?",
                                                [id_equipo],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#marca").css("background-color", "#FFFFFF");
                                                        $("#tipoMotor").css("background-color", "#FFFFFF");
                                                        $("#marcaMotor").css("background-color", "#FFFFFF");
                                                        $("#modelo").css("background-color", "#FFFFFF");
                                                        $("#serie").css("background-color", "#FFFFFF");
                                                        $("#aditamentos").css("background-color", "#FFFFFF");
                                                        
                                                        $("#marca").val("");
                                                        $("#tipoMotor").val("");
                                                        $("#marcaMotor").val("");
                                                        $("#modelo").val("");
                                                        $("#serie").val("");
                                                        $("#aditamentos").val("");
                                                        $("#tabla_equipos tbody").append("<tr id='fila"+ item.id_equipo +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_equipo +",7);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + unescape(item.marca) + "</td><td style='text-align: center;'>" + unescape(item.tipo_motor) + "</td><td style='text-align: center;'>" + unescape(item.marca_motor) + "</td><td style='text-align: center;'>" + unescape(item.modelo) + "</td><td style='text-align: center;'>" + unescape(item.serie) + "</td><td style='text-align: center;'>" + unescape(item.aditamentos) + "</td></tr>");
                                                        
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
        // databaseHandler.db.transaction(
        //     function(tx1){
        //         tx1.executeSql(
        //             "Select id_cedula from datos_equipo_smc where id_cedula= ?",
        //             [id_cedula],
        //             function(tx, results){
        //                 var item = results.rows.item(0);
        //                 if(item){
        //                     databaseHandler.db.transaction(
        //                         function(tx){
        //                             tx.executeSql("UPDATE datos_equipo_smc SET marca = ?,tipo_motor = ?,marca_motor = ?,modelo = ?,serie = ?,aditamentos = ? WHERE id_cedula = ?",
        //                                 [marca,tipoMotor,marcaMotor,modelo,serie,aditamentos,id_cedula],
        //                                 function(tx, results){
        //                                     $("#marca").css("background-color", "#FFFFFF");
        //                                     $("#tipoMotor").css("background-color", "#FFFFFF");
        //                                     $("#marcaMotor").css("background-color", "#FFFFFF");
        //                                     $("#modelo").css("background-color", "#FFFFFF");
        //                                     $("#serie").css("background-color", "#FFFFFF");
        //                                     $("#aditamentos").css("background-color", "#FFFFFF");
        //                                     databaseHandler.db.transaction(
        //                                         function(tx){
        //                                             swal("","Registro actualizado","success");
        //                                             app.preloader.hide();
        //                                         },
        //                                         function(error){},
        //                                         function(){}
        //                                     );
        //                                 },
        //                                 function(tx, error){
        //                                     swal("Error al guardar",error.message,"error");
        //                                     app.preloader.hide();
        //                                 }
        //                             );
        //                         },
        //                         function(error){},
        //                         function(){}
        //                     );
        //                 } else {
        //                     databaseHandler.db.transaction(
        //                         function(tx){
        //                             tx.executeSql("INSERT INTO datos_equipo_smc(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos) VALUES (?,?,?,?,?,?,?)",
        //                                 [id_cedula,marca,tipoMotor,marcaMotor,modelo,serie,aditamentos],
        //                                 function(tx, results){
        //                                     $("#marca").css("background-color", "#FFFFFF");
        //                                     $("#tipoMotor").css("background-color", "#FFFFFF");
        //                                     $("#marcaMotor").css("background-color", "#FFFFFF");
        //                                     $("#modelo").css("background-color", "#FFFFFF");
        //                                     $("#serie").css("background-color", "#FFFFFF");
        //                                     $("#aditamentos").css("background-color", "#FFFFFF");
        //                                     databaseHandler.db.transaction(
        //                                         function(tx){
        //                                             swal("","Registro guardado","success");
        //                                             app.preloader.hide();
        //                                         },
        //                                         function(error){},
        //                                         function(){}
        //                                     );
        //                                 },
        //                                 function(tx, error){
        //                                     swal("Error al guardar",error.message,"error");
        //                                     app.preloader.hide();
        //                                 }
        //                             );
        //                         },
        //                         function(error){},
        //                         function(){}
        //                     );
        //                 }
        //             },
        //             function(tx, error){
        //                 console.log("Error al consultar: " + error.message);
        //             }
        //         );
        //     },
        //     function(error){},
        //     function(){}
        // );
    }
    function guardarEquipoServicioSMC(){
        app.preloader.show('blue');
        if($("#marca").val() == "" || $('#tipoMotor').val() == "" || $('#marcaMotor').val() == "" || $('#modelo').val() == "" || $('#serie').val() == "" || $('#aditamentos').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var marca = $("#marca").val();
        var tipoMotor = $('#tipoMotor').val();
        var marcaMotor = $('#marcaMotor').val();
        var modelo = $('#modelo').val();
        var serie = $('#serie').val();
        var aditamentos = $('#aditamentos').val();
        databaseHandler.db.transaction(
            function(tx1){
                tx1.executeSql(
                    "Select id_cedula from datos_servicio_smc where id_cedula= ?",
                    [id_cedula],
                    function(tx, results){
                        var item = results.rows.item(0);
                        if(item){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE datos_servicio_smc SET marca = ?,tipo_motor = ?,marca_motor = ?,modelo = ?,serie = ?,aditamentos = ? WHERE id_cedula = ?",
                                        [marca,tipoMotor,marcaMotor,modelo,serie,aditamentos,id_cedula],
                                        function(tx, results){
                                            $("#marca").css("background-color", "#FFFFFF");
                                            $("#tipoMotor").css("background-color", "#FFFFFF");
                                            $("#marcaMotor").css("background-color", "#FFFFFF");
                                            $("#modelo").css("background-color", "#FFFFFF");
                                            $("#serie").css("background-color", "#FFFFFF");
                                            $("#aditamentos").css("background-color", "#FFFFFF");
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    swal("","Registro actualizado","success");
                                                    app.preloader.hide();
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        } else {
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO datos_servicio_smc(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos) VALUES (?,?,?,?,?,?,?)",
                                        [id_cedula,marca,tipoMotor,marcaMotor,modelo,serie,aditamentos],
                                        function(tx, results){
                                            $("#marca").css("background-color", "#FFFFFF");
                                            $("#tipoMotor").css("background-color", "#FFFFFF");
                                            $("#marcaMotor").css("background-color", "#FFFFFF");
                                            $("#modelo").css("background-color", "#FFFFFF");
                                            $("#serie").css("background-color", "#FFFFFF");
                                            $("#aditamentos").css("background-color", "#FFFFFF");
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    swal("","Registro guardado","success");
                                                    app.preloader.hide();
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        }
                    },
                    function(tx, error){
                        console.log("Error al consultar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedSMC(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoSMC1'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoSMC2'});
        } else if(tipo == 3){
            app.views.main.router.navigate({ name: 'recorridoSMC3'});
        } else if(tipo == 4){
            app.views.main.router.navigate({ name: 'recorridoSMC4'});
        }
    }
    function eliminarFilaSMC(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_levantamiento_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 4) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 5) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_venta_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 6) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_servicio_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 7) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM datos_equipo_smc WHERE id_equipo = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarPiezaSMC(){
        app.preloader.show('blue');
        if($("#pieza").val() == "" || $('#imagenC1').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var pieza = $("#pieza").val();
        var foto = $('#imagenC1').val();
        var fase = "pieza";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_mantenimiento_smc(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,pieza,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_smc",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_mantenimiento_smc where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage1").attr("src","img/blank.png");
                                                        $("#pieza").val("");
                                                        $('#imagenC1').val("");
                                                        $("#photoIcon1").attr("src","img/camera.svg");
                                                        $("#pieza").css("background-color", "#FFFFFF");
                                                        $("#tabla_pieza tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr1").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Pieza guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCambioSMC(){
        app.preloader.show('blue');
        if($("#cambio").val() == "" || $('#imagenC').val() == "" || ($("#piezaChk").prop("checked") == false && $("#cambioChk").prop("checked") == false)){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var pieza = $("#cambio").val();
        var foto = $('#imagenC').val();
        if($("#piezaChk").prop("checked") == true){
            var fase = "pieza";
        } else {
            var fase = "cambio";
        }
        // var fase = "cambio";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_mantenimiento_smc(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,pieza,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_smc",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_mantenimiento_smc where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#cambio").val("");
                                                        $('#imagenC').val("");
                                                        $("#cambioChk").prop("checked", false);
                                                        $("#piezaChk").prop("checked", false);
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#cambio").css("background-color", "#FFFFFF");
                                                        $("#tabla_cambio tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Pieza guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreLevantamientoSMC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_smc SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoylevantamientoSMC/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreMantenimientoSMC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_smc SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoymantenimientoSMC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreServicioSMC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <=  '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyservicioSMC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreVentaSMC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <=  '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyventaSMC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarLevantamientoSMC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_smc SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarMantenimientooSMC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_smc SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarVentaSMC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarServicioSMC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function singleCheck1(valor){
        if($("#reparadoNo").prop("checked") === true){
            $("#reparadoNo").prop("checked", false);
        }
    }
    function singleCheck2(valor){
        if($("#reparadoSi").prop("checked") === true){
            $("#reparadoSi").prop("checked", false);
        }
    }
    function datosCheck1(valor){
        if($("#servicioP").prop("checked") === true){
            $("#servicioP").prop("checked", false);
        }
    }
    function datosCheck2(valor){
        if($("#servicioC").prop("checked") === true){
            $("#servicioC").prop("checked", false);
        }
    }
    function ingressCheck1(valor){
        if($("#cambioChk").prop("checked") === true){
            $("#cambioChk").prop("checked", false);
        }
    }
    function ingressCheck2(valor){
        if($("#piezaChk").prop("checked") === true){
            $("#piezaChk").prop("checked", false);
        }
    }
    function startFromProgram(nombre,tipo,orden,descripcion,datosEquipo,datosCliente,id_cliente,client_rfc,contact_name,contact_phone,contact_mail,type_Service,brand,motoy_type){
        localStorage.setItem("nombreCliente", nombre);
        localStorage.setItem("tipoServicio", tipo);
        localStorage.setItem("ordenServicio", orden);
        localStorage.setItem("descripcion", descripcion);
        localStorage.setItem("datosEquipo", datosEquipo);
        localStorage.setItem("datosCliente", datosCliente);
        localStorage.setItem("IdCte", id_cliente);
        app.views.main.router.navigate({name: 'yallegueSMC2'});
    }
    function sonRentados(){
        if($('input:radio[name=pregunta1]:checked').val() == 0){
            $("#contrato").css("display","block")
        } else {
            $("#contrato").css("display","none")
        }
    }
    function siguienteVisita(){
        if($('input:radio[name=pregunta3]:checked').val()== 1){
            $("#siguienteVisita").css("display","block")
        } else {
            $("#siguienteVisita").css("display","none")
        }
    }
    function dejaPresente(){
        if($('input:radio[name=pregunta4]:checked').val()== 1){
            $("#presente").css("display","block")
        } else {
            $("#presente").css("display","none")
        }
    }
    function mayusculas(e) {
        e.value = e.value.toUpperCase();
    }
    //SMC Fin
    // AyB Inicio
    function buscarCliente(){
        app.preloader.show('blue');
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $('#id_cliente').val();
        var nombre_cliente = $("#nombre_cliente").val();
        var hora_programada = $("#horario_programado").val();
        var foto_llegada = $("#imagenC").val();
        var sucursal = $("#sucursal").val();
        var direccion = $("#direccion").val();
        var personaRecibe = $("#persona_recibe").val();
        var documentoIngresar = $("#documento_ingresar").val();
        var codigoPostal = $("#codigo_postal").val();
        var alcance = $("#alcance").val();
        var estatus = 0;
        // var correo = $("#correo").val(); //----
        if(localStorage.getItem("IdCedula"))
        {
            app.preloader.hide();
            var cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [cedula],
                        function(tx5, results){
                            var item = results.rows.item(0);
                            if(nombre_cliente != item.nombre_cliente || foto_llegada != localStorage.getItem("foto_llegada")){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET id_usuario = ?,nombre_usuario = ?,fecha_entrada = ?,geolocalizacion_entrada = ?,id_cliente = ?,nombre_cliente = ?,horario_programado = ? WHERE id_cedula = ?",
                                            [id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,hora_programada,cedula],
                                            function(tx, results){
                                                app.views.main.router.navigate({name: 'recorrido1'});
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else {
                                app.views.main.router.navigate({name: 'recorrido1'});
                            }

                        },
                        function(tx5, error){
                            console.error("Error al consultar bandeja de salida: " + error.message);
                        }
                    );
                },
            function(error){},
            function(){}
            );
        } else {
            var NomDescCli = "Clientes";
            if(foto_llegada != ''){
                app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", { IdCed: id_usuario}, function (data) {
                    var content = JSON.parse(data);
                    var aux = 0;
                    for(var i=0; i < content.length; i++){
                        for (var i = 0; i < content.length; i++) {
                            if(content[i].IdCte == id_cliente){
                                aux = 1;
                                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,hora_programada,estatus);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                            [],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                localStorage.setItem("IdCedula", item.Id);
                                                localStorage.setItem("nombreCliente", nombre_cliente);
                                                localStorage.setItem("IdCte", id_cliente);
                                                localStorage.setItem("foto_llegada", foto_llegada);
                                                localStorage.setItem("sucursal", sucursal);
                                                localStorage.setItem("personaRecibe", personaRecibe);
                                                localStorage.setItem("direccion", direccion);
                                                localStorage.setItem("documentoIngresar", documentoIngresar);
                                                localStorage.setItem("codigoPostal", codigoPostal);
                                                localStorage.setItem("alcance", alcance);
                                                // localStorage.setItem("correo", correo);
                                                app.views.main.router.navigate({name: 'recorrido1'});
                                                app.preloader.hide();
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        }
                    }
                    if(aux == 0){
                        app.preloader.hide();
                        swal("Cliente no encontrado", "No se tiene registro de ese cliente, Por favor sincroniza tus datos!" ,"error");
                    }
                });
            } else {
                swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        }
    }
    //Generar tipos de cedula
    function generarLevantamiento(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let direccion = localStorage.getItem("direccion");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let tipoCedula = "levantamiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addLevantamiento(id_cedula,foto_llegada,nombre_cliente,direccion);
                        app.views.main.router.navigate({name: 'recorrido3'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarFumigacion(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let sucursal = localStorage.getItem("sucursal");
        let direccion = localStorage.getItem("direccion");
        let persona_recibe = localStorage.getItem("personaRecibe");
        let documento_ingresar = localStorage.getItem("documentoIngresar");
        let alcance_servicio = localStorage.getItem("alcance");
        let tipoCedula = "fumigacion";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addFumigacion(id_cedula,foto_llegada,sucursal,direccion,persona_recibe,documento_ingresar,alcance_servicio);
                        app.views.main.router.navigate({name: 'recorrido'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarSanitizacion(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let sucursal = localStorage.getItem("sucursal");
        let direccion = localStorage.getItem("direccion");
        let persona_recibe = localStorage.getItem("personaRecibe");
        let documento_ingresar = localStorage.getItem("documentoIngresar");
        let tipoCedula = "sanitizacion";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addSanitizacion(id_cedula,foto_llegada,sucursal,direccion,persona_recibe,documento_ingresar);
                        app.views.main.router.navigate({name: 'recorrido2'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    //Fin Generar tipos de cedula
    function guardarDatosLevantamiento(){
        app.preloader.show('blue');
        if($("#colonia").val() =="" || $("#revision").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var colonia = $("#colonia").val();
        var revision = $("#revision").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_servicio SET colonia = ?,revision = ? WHERE id_cedula = ?",
                    [colonia,revision,id_cedula],
                    function(tx, results){
                        $("#colonia").css("background-color", "#FFFFFF");
                        $("#revision").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarLevantamiento(){
        app.preloader.show('blue');
        if($("#area").val() == "" || $('#imagenC').val() == "" || $('#plaga').val() == "" || $('#observaciones').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#area").val();
        var foto_plaga = $('#imagenC').val();
        var plaga = $('#plaga').val();
        var observaciones = $('#observaciones').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO levantamiento_evidencia(id_cedula,area,foto_plaga,descripcion_plaga,observacion,fecha_regristro) VALUES (?,?,?,?,?,?)",
                    [id_cedula,area,foto_plaga,plaga,observaciones,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_levantamiento_foto) as Id from levantamiento_evidencia",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from levantamiento_evidencia where id_levantamiento_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#area").val("");
                                                        $("#plaga").val("");
                                                        $("#observaciones").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#area").css("background-color", "#FFFFFF");
                                                        $("#plaga").css("background-color", "#FFFFFF");
                                                        $("#observaciones").css("background-color", "#FFFFFF");
                                                        $("#tabla_levantamiento tbody").append("<tr id='fila"+ item.id_levantamiento_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_levantamiento_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_plaga+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.area + "</td><td style='text-align: center;'>" + unescape(item.descripcion_plaga) + "</td><td style='text-align: center;'>"+ item.observacion + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function saveGradoLevantamiento(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if(valor == 1){
            var message = "BAJA: SERVICIO BÁSICO,ASPERSIÓN,POLVO,PRESENCIA EN 1 ÁREA";
            $("#descripcion_infeccion").val(message);
        } else if(valor == 2){
            var message = "MEDIA: SERVICIO REGULAR,ASPERSIÓN,GEL,POLVO,PRESENCIA EN 2 ÁREAS";
            $("#descripcion_infeccion").val(message);
        } else if(valor == 3){
            var message = "ALTA: SERVICIO PREMIUM ,MICRO INYECCIÓN ,ASPERSIÓN,GEL,POLVO,PRESENCIA EN TODAS LAS ÁREAS";
            $("#descripcion_infeccion").val(message);
        } else {
            var message = "";
            $("#descripcion_infeccion").val("");
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_servicio SET grado_infeccion = ?,descripcion = ? WHERE id_cedula = ?",
                    [valor,message,id_cedula],
                    function(tx, results){
                        if(valor == 0){
                            swal("","Debes seleccionar un grado de infestacíon valido","warning");
                        } else {
                            swal("", "Se guardo el grado de infestación","success");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function regresarLevantamiento(){
        let infestacion = $("#descripcion_infeccion").val();
        if(infestacion == ""){
            swal({
                title: "Aviso",
                text: "Aun no agregas el grado de infestación, ¿Estas seguro que deseas regresar?",
                icon: "warning",
                buttons: true,
                dangerMode: false,
            })
            .then((willGoBack) => {
                if (willGoBack){
                    app.views.main.router.back('/recorrido3/', {force: true, ignoreCache: true, reload: true});
                } else {}
            });
        } else {
            app.views.main.router.back('/recorrido3/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function guardarCierreLevantamiento(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var comentarios = $("#comentarios").val();
        var nombreComentario = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_servicio SET comentarios_tecnico = ?,firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [comentarios,firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        app.views.main.router.back('/yamevoylevantamiento/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET nombre_evalua = ? WHERE id_cedula = ?",
                    [nombreComentario,id_cedula],
                    function(tx, results){
                        app.views.main.router.back('/yamevoylevantamiento/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreFumigacion(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET firma_evalua = ?,fecha_firma = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyfumigacion/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreSanitizacion(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET firma_evalua = ?,fecha_firma = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoylevantamientoSMC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarLevantamiento(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_servicio SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarFumigacion(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarSanitizacion(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCed(id_cliente, id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("IdCte",id_cliente);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorrido3'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorrido'});
        } else if(tipo == 3) {
            app.views.main.router.navigate({ name: 'recorrido2'});
        }
    }
    function EliminarReg(id_cedula,tipo_cedula){
        swal({
            title: "Aviso",
            text: "Estas apunto de eliminar todos los datos de la cedula, ¿Estas seguro continuar con la acción?",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
        .then((willGoBack) => {
            if (willGoBack){
                var empresa = localStorage.getItem("nombre_empresa");
                console.log(empresa,tipo_cedula)
                if(empresa == "SMC"){
                    if(tipo_cedula == "levantamiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM levantamiento_smc WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_levantamiento_smc WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "mantenimiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM mantenimiento_smc WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_mantenimiento_smc WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "ventaSMC"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM ventaSMC WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_venta_smc WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM datos_equipo_smc WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        $("#conc" + id_cedula).remove();
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "servicioSMC"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM servicioSMC WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_servicio_smc WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM datos_servicio_smc WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        $("#conc" + id_cedula).remove();
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                } else if(empresa == "Field"){
                    if(tipo_cedula == "levantamiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM levantamiento_Field WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_levantamiento_Field WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "mantenimiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM mantenimiento_Field WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_mantenimiento_Field WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                } else if(empresa == "DIPREC"){
                    if(tipo_cedula == "reporteTecnico"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM servicio_tecnico WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM datos_equipo WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM evidencia_equipo WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("DELETE FROM datos_equipo_antes WHERE id_cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function(tx, results){
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function(tx){
                                                                                                                tx.executeSql("DELETE FROM evidencia_refacciones WHERE id_cedula = ?",
                                                                                                                    [id_cedula],
                                                                                                                    function(tx, results){
                                                                                                                        databaseHandler.db.transaction(
                                                                                                                            function(tx){
                                                                                                                                tx.executeSql("DELETE FROM check_list WHERE id_cedula = ?",
                                                                                                                                    [id_cedula],
                                                                                                                                    function(tx, results){
                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                            function(tx){
                                                                                                                                                tx.executeSql("DELETE FROM check_list2 WHERE id_cedula = ?",
                                                                                                                                                    [id_cedula],
                                                                                                                                                    function(tx, results){
                                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                                            function(tx){
                                                                                                                                                                tx.executeSql("DELETE FROM datos_equipo_despues WHERE id_cedula = ?",
                                                                                                                                                                    [id_cedula],
                                                                                                                                                                    function(tx, results){
                                                                                                                                                                        $("#conc" + id_cedula).remove();
                                                                                                                                                                    },
                                                                                                                                                                    function(tx, error){
                                                                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                                                                    }
                                                                                                                                                                );
                                                                                                                                                            },
                                                                                                                                                            function(error){},
                                                                                                                                                            function(){}
                                                                                                                                                        );
                                                                                                                                                    },
                                                                                                                                                    function(tx, error){
                                                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                                                    }
                                                                                                                                                );
                                                                                                                                            },
                                                                                                                                            function(error){},
                                                                                                                                            function(){}
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                    function(tx, error){
                                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                                    }
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(error){},
                                                                                                                            function(){}
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(tx, error){
                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                    }
                                                                                                                );
                                                                                                            },
                                                                                                            function(error){},
                                                                                                            function(){}
                                                                                                        );
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    } else {
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM minuta_coordinador WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM zonas_coordinador WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM equipos_coordinador WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("DELETE FROM datos_coordinador WHERE id_cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function(tx, results){
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function(tx){
                                                                                                                tx.executeSql("DELETE FROM observaciones WHERE id_cedula = ?",
                                                                                                                    [id_cedula],
                                                                                                                    function(tx, results){
                                                                                                                        databaseHandler.db.transaction(
                                                                                                                            function(tx){
                                                                                                                                tx.executeSql("DELETE FROM notas WHERE id_cedula = ?",
                                                                                                                                    [id_cedula],
                                                                                                                                    function(tx, results){
                                                                                                                                        $("#conc" + id_cedula).remove();
                                                                                                                                    },
                                                                                                                                    function(tx, error){
                                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                                    }
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(error){},
                                                                                                                            function(){}
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(tx, error){
                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                    }
                                                                                                                );
                                                                                                            },
                                                                                                            function(error){},
                                                                                                            function(){}
                                                                                                        );
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                } else if(empresa == "Bennetts"){
                    if(tipo_cedula == "baja"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM productos WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    $("#conc" + id_cedula).remove();
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    }
                    if(tipo_cedula == "conteo"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM inventario WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("DELETE FROM conteo WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    $("#conc" + id_cedula).remove();
                                                                },
                                                                function(tx, error){
                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    }
                } else if(empresa == "ServInd"){
                    if(tipo_cedula == "reporteGeneral"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM reporteGeneral WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("DELETE FROM evidenciasReporte WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("DELETE FROM equiposReporte WHERE id_cedula = ?",
                                                                                [id_cedula],
                                                                                function(tx, results){
                                                                                    $("#conc" + id_cedula).remove();
                                                                                },
                                                                                function(tx, error){
                                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    } else if(tipo_cedula == "checklistServ"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM checklist WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("DELETE FROM selectcheck WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    $("#conc" + id_cedula).remove();
                                                                },
                                                                function(tx, error){
                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    } else if(tipo_cedula == "AuditoriaTecnico" || tipo_cedula == "AuditoriaSupervisorTecnico" || tipo_cedula == "AuditoriaLider"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM SV_Fotos WHERE SV_ID_Cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("DELETE FROM Aud_Tec WHERE AT_ID_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("DELETE FROM Aud_General WHERE AG_ID_cedula = ?",
                                                                                [id_cedula],
                                                                                function(tx, results){
                                                                                    $("#conc" + id_cedula).remove();
                                                                                },
                                                                                function(tx, error){
                                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    }
                } else if(empresa == "SURO"){
                    if (tipo_cedula == "sanitizacionSURO") {
                        databaseHandler.db.transaction(
                          function (tx) {
                            tx.executeSql(
                              "DELETE FROM cedulas_general WHERE id_cedula = ?",
                              [id_cedula],
                              function (tx, results) {
                                databaseHandler.db.transaction(
                                  function (tx) {
                                    tx.executeSql(
                                      "DELETE FROM sanitizacion_Suro WHERE id_cedula = ?",
                                      [id_cedula],
                                      function (tx, results) {
                                        databaseHandler.db.transaction(
                                            function (tx) {
                                              tx.executeSql(
                                                "DELETE FROM evidencia WHERE id_cedula = ?",
                                                [id_cedula],
                                                function (tx, results) {
                                                    databaseHandler.db.transaction(
                                                        function (tx) {
                                                          tx.executeSql(
                                                            "DELETE FROM grupos WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function (tx, results) {
                                                              $("#conc" + id_cedula).remove();
                                                            },
                                                            function (tx, error) {
                                                              swal(
                                                                "Error al eliminar sanitizacion ",
                                                                error.message,
                                                                "error"
                                                              );
                                                            }
                                                          );
                                                        },
                                                        function (error) { },
                                                        function () { }
                                                      );
                                                },
                                                function (tx, error) {
                                                  swal(
                                                    "Error al eliminar sanitizacion ",
                                                    error.message,
                                                    "error"
                                                  );
                                                }
                                              );
                                            },
                                            function (error) { },
                                            function () { }
                                          );
                                      },
                                      function (tx, error) {
                                        swal(
                                          "Error al eliminar sanitizacion ",
                                          error.message,
                                          "error"
                                        );
                                      }
                                    );
                                  },
                                  function (error) { },
                                  function () { }
                                );
                              },
                              function (tx, error) {
                                swal(
                                  "Error al eliminar cedulas_general",
                                  error.message,
                                  "error"
                                );
                              }
                            );
                          },
                          function (error) { },
                          function () { }
                        );
                      }
        
                } else {
                    if(tipo_cedula == "levantamiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM levantamiento_servicio WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM levantamiento_evidencia WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "fumigacion"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM fumigacion WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM fotos_fumigacion WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar fumigacion",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar fumigacion",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "sanitizacion"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM sanitizacion WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM fotos_sanitizacion WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar sanitizacion",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar fumigacion",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                }
            } else {

            }
        });
    }
    function EliminarRegistrosAntiguos(){
        var id_usuario = localStorage.getItem("id_usuario");
        var fecha = new Date();
        var fecha_ingreso = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        fecha_eliminar = editar_fecha(fecha_ingreso, "-11", "d","-");
        databaseHandler.db.transaction(
            function(tx5){
                tx5.executeSql("SELECT * FROM cedulas_general WHERE fecha_entrada > ? AND id_usuario = ? AND (estatus = 1 OR estatus = 2)",
                    [fecha_eliminar,id_usuario],
                    function(tx5, results){
                        var length = results.rows.length;
                        for(var i = 0; i< length; i++){
                            var item2 = results.rows.item(i);
                            var id_eliminar = item2.IdCedula;
                            databaseHandler.db.transaction(
                                function(tx4){
                                    tx4.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                        [id_eliminar],
                                        function(tx4, results){
                                        },
                                        function(tx4, error){
                                            console.error("Error al eliminar cedula_general: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                            var empresa = localStorage.getItem("nombre_empresa");
                            if(empresa == "SMC"){
                                if(tipo == "levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM levantamiento_smc WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error eliminar levantamiento SMC: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_levantamiento_smc WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al Eliminar evidencia levantamiento SMC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                                if(tipo == "mantenimiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM mantenimiento_smc WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar mantenimiento SMC: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_mantenimiento_smc WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar evidencia mantenimiento SMC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "Field"){
                                if(tipo == "levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM levantamiento_Field WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar levantamiento Field: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_levantamiento_Field WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar evidencia levantamiento Field: " +error.message);}
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }
                                if(tipo == "mantenimiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM mantenimiento_Field WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Erro al eliminar mantenimiento Field: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_mantenimiento_Field WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar evidencia mantenimiento Field: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "Bennetts"){
                                if(tipo == "baja"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM productos WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar productos Bennetts: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_productos WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos sanitizacion Bennetts: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "DIPREC"){
                                if(tipo == "reporteTecnico"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM servicio_tecnico WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar servicio tecnico DIPREC: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_equipo WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datos equipo DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_equipo WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar al eliminar evidencia equipo: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_equipo_antes WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datos equipo antes DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_refacciones WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminarevidencia refacciones diprec: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM check_list WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error eliminar al check list DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM check_list2 WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar check list 2 DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_equipo_despues WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datos equipo despues DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                                if(tipo == "minutaCoordinador"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM minuta_coordinador WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar minuta coordonador DIPREC: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM zonas_coordinador WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar zonas coordinador DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM equipos_coordinador WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar equipos coordinador DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_coordinador WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datos coordinador DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM observaciones WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar observaciones DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM notas WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar notas DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            }  else if(empresa == "SURO"){
                                if(tipo == "sanitizacionSURO"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM sanitizacion_Suro WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar sanitizacion SURO: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos sanitizacion SURO: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else {
                                if(tipo == "sanitizacion"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM sanitizacion WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar sanitizacion AYB: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM fotos_sanitizacion WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos sanitizacion AYB: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                                if(tipo == "levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM levantamiento_servicio WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar levantamiento AYB: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM levantamiento_evidencia WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos levantamiento AYB: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                                if(tipo == "fumigacion"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM fumigacion WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fumigacion AYB: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM fotos_fumigacion WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos fumigacion AYB: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            }                            
                        }
                        
                    },
                    function(tx5, error){
                        console.log("Error al depurar registros: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionAntes(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET descripcion_antes = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionAntesSani(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET descripcion_antes = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionDurante(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET descripcion_durante = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionDuranteSanitizacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET descripcion_durante = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionDespues(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET descripcion_despues = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionDespuesSanitizacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET descripcion_despues = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function capturePhotoSS1() {
        navigator.camera.getPicture(onSSinglePhotoSucceess1, onSSinglePhotoFail1, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function captureSingleSMC() {
        navigator.camera.getPicture(onSinglePhotoSMCSucceess, onSinglePhotoSMCFail, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSinglePhotoSMCSucceess(imageData) {
        var smallImage = document.getElementById('smallImage1');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC1").val(nameima);
        $("#photoIcon1").attr("src","img/reload.svg");
    }
    function onSinglePhotoSMCFail(message) {
        swal("Error al tomar foto:",message,"error");
    }
    // Imagen sola 1
    function onSSinglePhotoSucceess1(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage1');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC1").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET foto_quimico = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto quimico fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon1").attr("src","img/reload.svg");
    }
    function onSSinglePhotoFail1(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function capturePhotoSS2() {
        navigator.camera.getPicture(onSSinglePhotoSucceess2, onSSinglePhotoFail2, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSSinglePhotoSucceess2(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage2');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC2").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET foto_equipo = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto equipo fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon2").attr("src","img/reload.svg");
    }
    function onSSinglePhotoFail2(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function capturePhotoSS3() {
        navigator.camera.getPicture(onSSinglePhotoSucceess3, onSSinglePhotoFail3, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSSinglePhotoSucceess3(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage3');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC3").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET foto_reporte = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto del reporte fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon3").attr("src","img/reload.svg");
    }
    function onSSinglePhotoFail3(message) {
        swal("Error al tomar foto:",message,"error");
    }
    //Fumigacion single photo
    function capturePhotoS1() {
        navigator.camera.getPicture(onSinglePhotoSucceess1, onSinglePhotoFail1, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    // Imagen sola 1
    function onSinglePhotoSucceess1(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage1');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC1").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET foto_quimico = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto quimico fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon1").attr("src","img/reload.svg");
    }
    function onSinglePhotoFail1(message) {
        swal("Error al tomar foto:",message,"error");
    }
    // Imagen sola 2
    function capturePhotoS2() {
        navigator.camera.getPicture(onSinglePhotoSucceess2, onSinglePhotoFail2, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSinglePhotoSucceess2(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage2');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC2").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET foto_equipo = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto equipo fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon2").attr("src","img/reload.svg");
    }
    function onSinglePhotoFail2(message) {
        swal("Error al tomar foto:",message,"error");
    }
    // Imagen sola 3
    function capturePhotoS3() {
        navigator.camera.getPicture(onSinglePhotoSucceess3, onSinglePhotoFail3, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSinglePhotoSucceess3(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage3');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC3").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET foto_reporte = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto del reporte fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon3").attr("src","img/reload.svg");
    }
    function onSinglePhotoFail3(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function guardarAntesFumigacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $("#imagenC1").val() == "" || $("#imagenC2").val() == "" || $("descripcion").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "antes";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_fumigacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_fumigacion_foto) as Id from fotos_fumigacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_fumigacion where id_fumigacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla_fumigacion tbody").append("<tr id='fila"+ item.id_fumigacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_fumigacion_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarAntesSanitizacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#imagenC1').val() == "" || $('#descripcion').val() == "" || ($("#DespejadoSi").prop("checked") == false && $("#DespejadoNo").prop("checked") == false)){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "antes";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_sanitizacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_sanitizacion_foto) as Id from fotos_sanitizacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_sanitizacion where id_sanitizacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla_sanitizacion tbody").append("<tr id='fila"+ item.id_sanitizacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_sanitizacion_foto +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar area guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Area guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar area",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDuranteFumigacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#descripcion').val() == "") {
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "durante";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_fumigacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_fumigacion_foto) as Id from fotos_fumigacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_fumigacion where id_fumigacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla-durante-fumigacion tbody").append("<tr id='fila"+ item.id_fumigacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_fumigacion_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDuranteSanitizacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#descripcion').val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "durante";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_sanitizacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_sanitizacion_foto) as Id from fotos_sanitizacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_sanitizacion where id_sanitizacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla-durante-sanitizacion tbody").append("<tr id='fila"+ item.id_sanitizacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_sanitizacion_foto +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDespuesSanitizacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#imagenC3').val() == "" || $('#descripcion').val() =="" || $('#productoUtilizado').val() ==""){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "despues";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_sanitizacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_sanitizacion_foto) as Id from fotos_sanitizacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_sanitizacion where id_sanitizacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla-despues-sanitizacion tbody").append("<tr id='fila"+ item.id_sanitizacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_sanitizacion_foto +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDespuesFumigacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#descripcion').val() == "" || $('#productoUtilizado').val() == "" || $('#imagenC3').val() == "" || $('#tipoAplicacion').val() == "0" || $('#gradoInfestacion').val() == "0" || ($("#MantenimientoSi").prop("checked") == false && $("#MantenimientoNo").prop("checked") == false)){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "despues";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_fumigacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_fumigacion_foto) as Id from fotos_fumigacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_fumigacion where id_fumigacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla-despues-fumigacion tbody").append("<tr id='fila"+ item.id_fumigacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_fumigacion_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarProductoFumigacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var productoUtilizado = $('#productoUtilizado').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET producto_utilizado = ? WHERE id_cedula = ?",
                    [productoUtilizado,id_cedula],
                    function(tx, results){
                        swal("","El producto utilizado fue guardado correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function saveTipoAplicacion(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if(valor == 1){
            var message = "Aspersión";
            $("#tipo_aplicacion").val(message);
        } else if(valor == 2){
            var message = "Microinyección";
            $("#tipo_aplicacion").val(message);
        } else if(valor == 3){
            var message = "Nebulización";
            $("#tipo_aplicacion").val(message);
        } else if(valor == 4){
            var message = "Espolvoreo";
            $("#tipo_aplicacion").val(message);
        } else if(valor == 5){
            var message = "Gel";
            $("#tipo_aplicacion").val(message);
        } else {
            var message = "";
            $("#tipo_aplicacion").val("");
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET tipo_aplicacion = ?,descripcion_tipo = ? WHERE id_cedula = ?",
                    [valor,message,id_cedula],
                    function(tx, results){
                        if(valor == 0){
                            swal("","Debes seleccionar un tipo de aplicación valido","warning");
                        } else {
                            swal("", "Se guardo el tipo de aplicación","success");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function saveGradoInfestacion(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if(valor == 1){
            var message = "Sin Actividad";
            $("#grado_infestacion").val(message);
        } else if(valor == 2){
            var message = "Baja";
            $("#grado_infestacion").val(message);
        } else if(valor == 3){
            var message = "Media";
            $("#grado_infestacion").val(message);
        } else if(valor == 4){
            var message = "Alta";
            $("#grado_infestacion").val(message);
        } else {
            var message = "";
            $("#grado_infestacion").val("");
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET grado_infestacion = ?,descripcion_infestacion = ? WHERE id_cedula = ?",
                    [valor,message,id_cedula],
                    function(tx, results){
                        if(valor == 0){
                            swal("","Debes seleccionar un grado de infestación valido","warning");
                        } else {
                            swal("", "Se guardo el el grado de infestación","success");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function mantenimientoSi(valor){
        if($("#MantenimientoNo").prop("checked") === true){
            $("#MantenimientoNo").prop("checked", false);
        }
        if(!$(valor).prop('checked')){
            $('#detalle_container').css("display","none");
        }else{
            $('#detalle_container').css("display","block");
        }
    }
    function guardarDetalleMantenimiento(){
        var id_cedula = localStorage.getItem("IdCedula");
        var mantenimiento = 1;
        var detalle = $('#detalle').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET mantenimiento = ?,detalle_mantenimiento = ? WHERE id_cedula = ?",
                    [mantenimiento,detalle,id_cedula],
                    function(tx, results){
                        swal("", "Se guardo el mantenimiento","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function mantenimientoNo(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#MantenimientoSi").prop("checked") === true){
            $("#MantenimientoSi").prop("checked", false);
            $('#detalle_container').css("display","none");
        }
        if(!$(valor).prop('checked')){

        }else{
            var mantenimiento = 0;
            var detalle = "";
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE fumigacion SET mantenimiento = ?,detalle_mantenimiento = ? WHERE id_cedula = ?",
                        [mantenimiento,detalle,id_cedula],
                        function(tx, results){
                            swal("", "Se guardo el mantenimiento","success");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function despejadoSi(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#DespejadoNo").prop("checked") === true){
            $("#DespejadoNo").prop("checked", false);
        }
        if(!$(valor).prop('checked')){

        }else{
            var despejado = 1;
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE sanitizacion SET areas_despejadas = ? WHERE id_cedula = ?",
                        [despejado,id_cedula],
                        function(tx, results){
                            swal("", "Se guardo el estado area y limpieza","success");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function despejadoNo(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#DespejadoSi").prop("checked") === true){
            $("#DespejadoSi").prop("checked", false);
        }
        if(!$(valor).prop('checked')){

        }else{
            var despejado = 0;
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE sanitizacion SET areas_despejadas = ? WHERE id_cedula = ?",
                        [despejado,id_cedula],
                        function(tx, results){
                            swal("", "Se guardo el estado area y limpieza","success");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarRecomendacionesFumigacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var recomendaciones = $('#recomendaciones').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET recomendaciones = ? WHERE id_cedula = ?",
                    [recomendaciones,id_cedula],
                    function(tx, results){
                        swal("", "Se guardo la recomendacion","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarRecomendacionesSanitizacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var recomendaciones = $('#recomendaciones').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET recomendaciones = ? WHERE id_cedula = ?",
                    [recomendaciones,id_cedula],
                    function(tx, results){
                        swal("", "Se guardo la recomendacion","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function llevarTodo(id_cedula,tipo_cedula){
        swal("Enviando!", "Puedes serguir usando la aplicación!", "success");
        var empresa = localStorage.getItem("nombre_empresa");
        if(empresa == "SMC"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosLevantamiento = new Array();
            var evidenciaLevantamiento = new Array();
            var levantamiento = 0;
            var evidencialeva = 0;

            var datosMantenimiento = new Array();
            var evidenciaMantenimiento = new Array();
            var mantenimiento = 0;
            var evidenciamant = 0;

            var datosVenta = new Array();
            var evidenciaVenta = new Array();
            var datosEquipoVenta = new Array();

            var datosServicio = new Array();
            var evidenciaServicio = new Array();
            var datosEquipoServicio = new Array();

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "levantamiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM levantamiento_smc WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosLevantamiento[levantamiento] = {'Valor':levantamiento,'id_levantamiento':item2.id_levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'orden_servicio':item2.orden_servicio,'marca':item2.marca,'modelo':item2.modelo,'numero_serie':item2.numero_serie,'tipo_motor':item2.tipo_motor,'tipo_boquilla':item2.tipo_boquilla,'tipo_combustible':item2.tipo_combustible,'tipo_mastil':item2.tipo_mastil,'comentario_equipo':item2.comentario_equipo,'lugar_reparacion':item2.lugar_reparacion,'reparo_visita':item2.reparo_visita,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    levantamiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_levantamiento_smc WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaLevantamiento[evidencialeva] = {'Valor':evidencialeva,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'observacion': item3.observacion,'foto_observacion': item3.foto_observacion,'fecha_regristro': item3.fecha_regristro};
                                                                    evidencialeva++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarLevantamientoSMC.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosLevantamiento': JSON.stringify(datosLevantamiento),'evidenciaLevantamiento': JSON.stringify(evidenciaLevantamiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion con el servidor");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar levantamiento_smc: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "mantenimiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM mantenimiento_smc WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosMantenimiento[mantenimiento] = {'Valor':mantenimiento,'id_levantamiento':item2.id_levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'tipo_servicio':item2.tipo_servicio,'orden_servicio':item2.orden_servicio,'marca':item2.marca,'modelo':item2.modelo,'numero_serie':item2.numero_serie,'foto_equipo':item2.foto_equipo,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    mantenimiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_mantenimiento_smc WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaMantenimiento[evidenciamant] = {'Valor':evidenciamant,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'fase': item3.fase,'descripcion': item3.descripcion,'foto_decripcion': item3.foto_decripcion,'fecha_regristro': item3.fecha_regristro};
                                                                    evidenciamant++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarMantenimientoSMC.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosMantenimiento': JSON.stringify(datosMantenimiento),'evidenciaMantenimiento': JSON.stringify(evidenciaMantenimiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "ventaSMC"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM ventaSMC WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosVenta[i] = {'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'rfc_cliente':item2.rfc_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'tipo_visita':item2.tipo_visita,'comentario_antes':item2.comentario_antes,'comentario_despues':item2.comentario_despues,'objetivo_prospeccion': item2.objetivo_prospeccion, 'necesidad_prospeccion': item2.necesidad_prospeccion, 'marca_montacargas_prospeccion': item2.marca_montacargas_prospeccion,'numero_montacargas_prospeccion': item2.numero_montacargas_prospeccion,'status_montacarga_prospeccion': item2.status_montacarga_prospeccion,'venc_contrato':item2.venc_contrato, 'marca_llantas_prospeccion': item2.marca_llantas_prospeccion,'tipo_llantas_prospeccion': item2.tipo_llantas_prospeccion,'mediadas_prospeccion': item2.mediadas_prospeccion,'resolvio_prospeccion': item2.resolvio_prospeccion,'por_que_prospeccion':item2.por_que_prospeccion,'vista_prospeccion': item2.vista_prospeccion, 'cuando_prospeccion': item2.cuando_prospeccion,'presente_prospeccion': item2.presente_prospeccion, 'cuales_prospeccion': item2.cuales_prospeccion,'copetencia_prospeccion': item2.copetencia_prospeccion,'sugerencia_prospeccion': item2.sugerencia_prospeccion,'comentarios_prospeccion': item2.comentarios_prospeccion,'no_activo':item2.no_activo,'no_contrato':item2.no_contrato,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_venta_smc WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaVenta[i] = {'id_cedula': item3.id_cedula,'fase': item3.fase,'descripcion': item3.descripcion,'foto': item3.foto,'fecha_regristro': item3.fecha_regristro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from datos_equipo_smc WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    datosEquipoVenta[i] = {'id_cedula': item4.id_cedula,'marca': item4.marca,'tipo_motor': item4.tipo_motor,'marca_motor': item4.marca_motor,'modelo': item4.modelo,'serie': item4.serie,'aditamentos': item4.aditamentos};
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarVentaSMC.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosVenta': JSON.stringify(datosVenta),'evidenciaVenta': JSON.stringify(evidenciaVenta),'datosEquipoVenta': JSON.stringify(datosEquipoVenta)},
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "servicioSMC"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM servicioSMC WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosServicio[i] = {'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'rfc_cliente':item2.rfc_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'tipo_visita':item2.tipo_visita,'comentario_antes':item2.comentario_antes,'comentario_despues':item2.comentario_despues,'observaciones_prospeccion':item2.observaciones_prospeccion,'estado_monta':item2.estado_monta,'numero_monta':item2.numero_monta,'tipo_monta':item2.tipo_monta,'marca':item2.marca,'mantenimiento':item2.mantenimiento,'no_activo':item2.no_activo,'no_contrato':item2.no_contrato,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_servicio_smc WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaServicio[i] = {'id_cedula': item3.id_cedula,'fase': item3.fase,'descripcion': item3.descripcion,'foto': item3.foto,'fecha_regristro': item3.fecha_regristro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from datos_servicio_smc WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    datosEquipoServicio[i] = {'id_cedula': item4.id_cedula,'marca': item4.marca,'tipo_motor': item4.tipo_motor,'marca_motor': item4.marca_motor,'modelo': item4.modelo,'serie': item4.serie,'aditamentos': item4.aditamentos};
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarServicioSMC.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosServicio': JSON.stringify(datosServicio),'evidenciaServicio': JSON.stringify(evidenciaServicio),'datosEquipoServicio': JSON.stringify(datosEquipoServicio)},
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "Field"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosLevantamiento = new Array();
            var evidenciaLevantamiento = new Array();
            var levantamiento = 0;
            var evidencialeva = 0;

            var datosMantenimiento = new Array();
            var evidenciaMantenimiento = new Array();
            var mantenimiento = 0;
            var evidenciamant = 0;

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "levantamiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM levantamiento_Field WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosLevantamiento[levantamiento] = {'Valor':levantamiento,'id_levantamiento':item2.id_levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'orden_servicio':item2.orden_servicio,'marca':item2.marca,'modelo':item2.modelo,'numero_serie':item2.numero_serie,'tipo_motor':item2.tipo_motor,'tipo_boquilla':item2.tipo_boquilla,'tipo_combustible':item2.tipo_combustible,'tipo_mastil':item2.tipo_mastil,'comentario_equipo':item2.comentario_equipo,'lugar_reparacion':item2.lugar_reparacion,'reparo_visita':item2.reparo_visita,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    levantamiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_levantamiento_Field WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaLevantamiento[evidencialeva] = {'Valor':evidencialeva,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'observacion': item3.observacion,'foto_observacion': item3.foto_observacion,'fecha_regristro': item3.fecha_regristro};
                                                                    evidencialeva++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarLevantamientoField.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosLevantamiento': JSON.stringify(datosLevantamiento),'evidenciaLevantamiento': JSON.stringify(evidenciaLevantamiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion con el servidor");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar levantamiento_smc: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "mantenimiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM mantenimiento_Field WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosMantenimiento[mantenimiento] = {'Valor':mantenimiento,'id_levantamiento':item2.id_levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'tipo_servicio':item2.tipo_servicio,'orden_servicio':item2.orden_servicio,'marca':item2.marca,'modelo':item2.modelo,'numero_serie':item2.numero_serie,'foto_equipo':item2.foto_equipo,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    mantenimiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_mantenimiento_Field WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaMantenimiento[evidenciamant] = {'Valor':evidenciamant,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'fase': item3.fase,'descripcion': item3.descripcion,'foto_decripcion': item3.foto_decripcion,'fecha_regristro': item3.fecha_regristro};
                                                                    evidenciamant++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarMantenimientoField.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosMantenimiento': JSON.stringify(datosMantenimiento),'evidenciaMantenimiento': JSON.stringify(evidenciaMantenimiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "Bennetts"){
            var datosCedulaGeneral = new Array();
            var productos = new Array();
            var datosProductos = new Array();
            var inventario = new Array();
            var conteo = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "baja"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM productos WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    productos[i] = {'Valor':i,'codigo_producto':item2.codigo_producto,'descripcion_producto':item2.descripcion_producto,'cantidad_producto':item2.cantidad_producto,'aplica':item2.aplica,'motivo':item2.motivo,'evidencia_foto_antes':item2.evidencia_foto_antes,'evidencia_foto_despues':item2.evidencia_foto_despues,'fecha':item2.fecha};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from datos_productos WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datosProductos[i] = {'Valor':i,'puesto': item3.puesto,'firma_cliente': item3.firma_cliente,'correo': item3.correo};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarBajaBennetts.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'productos': JSON.stringify(productos),'datosProductos': JSON.stringify(datosProductos)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else if(tipo == "conteo"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM inventario WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    inventario[i] = {'Valor':i,'id_inventario':item2.id_inventario,'id_cedula':item2.id_cedula,'id_conteo_general':item2.id_conteo_general,'numero_conteo':item2.numero_conteo,'empresa':item2.empresa,'pareja_almacen':item2.pareja_almacen,'almacen':item2.almacen,'fecha':item2.fecha};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from conteo WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    conteo[i] = {'Valor':i,'id_conteo_general': item3.id_conteo_general,'numero_conteo': item3.numero_conteo,'codigo_proveedor': item3.codigo_proveedor,'codigo_sap': item3.codigo_sap,'ubicacion': item3.ubicacion,'descripcion': item3.descripcion,'inventario': item3.inventario,'familia': item3.familia,'costo_unitario': item3.costo_unitario,'usuario': item3.usuario,'estatus_diferencia': item3.estatus_diferencia,'fisico': item3.fisico,'enviado': item3.enviado};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarConteoBennetts.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'inventario': JSON.stringify(inventario),'conteo': JSON.stringify(conteo)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "DIPREC"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var servicioTecnico = new Array();
            var datosEquipo = new Array();
            var evidenciaEquipo = new Array();
            var datosEquipoAntes = new Array();
            var evidenciaRefacciones = new Array();
            var checkList = new Array();
            var checkList2 = new Array();
            var datosEquipoDespues = new Array();
            var reporteTecnico = 0;

            var minutaCoordinador = new Array();
            var zonasCoordinador = new Array();
            var equiposCoordinador = new Array();
            var datosCoordinador = new Array();
            var observaciones = new Array();
            var notas = new Array();
            var minutCoordinador = 0;

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "reporteTecnico"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM servicio_tecnico WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    servicioTecnico[i] = {'Valor':reporteTecnico,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'atencion':item2.atencion,'documento_ingresar':item2.documento_ingresar,'direccion':item2.direccion,'telefono':item2.telefono,'email':item2.email,'tipo_servicio':item2.tipo_servicio,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'puesto':item2.puesto,'fecha_envio':fecha_envio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from datos_equipo WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datosEquipo[i] = {'Valor':reporteTecnico,'equipo': item3.equipo,'marca': item3.marca,'modelo': item3.modelo,'no_serie': item3.no_serie,'fecha_registro': item3.fecha_registro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from evidencia_equipo WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    evidenciaEquipo[i] = {'Valor':i,'fase': item4.fase,'foto': item4.foto,'equipo': item4.equipo,'fecha_regristro': item4.fecha_regristro};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from datos_equipo_antes WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    datosEquipoAntes[i] = {'Valor':reporteTecnico,'equipo': item5.equipo,'voltaje': item5.voltaje,'estado_voltaje': item5.estado_voltaje,'evidencia_voltaje': item5.evidencia_voltaje,'corriente': item5.corriente,'estado_corriente': item5.estado_corriente,'evidencia_corriente': item5.evidencia_corriente,'fases': item5.fases,'estado_fase': item5.estado_fase,'evidencia_fase': item5.evidencia_fase,'tipo_gas': item5.tipo_gas,'estado_gas': item5.estado_gas,'evidencia_gas': item5.evidencia_gas,'presion_gas': item5.presion_gas,'estado_presion_gas': item5.estado_presion_gas,'evidencia_presion_gas': item5.evidencia_presion_gas,'presion_vapor': item5.presion_vapor,'estado_presion_vapor': item5.estado_presion_vapor,'evidencia_presion_vapor': item5.evidencia_presion_vapor,'temperatura': item5.temperatura,'estado_temperatura': item5.estado_temperatura,'evidencia_estado_temperatura': item5.evidencia_estado_temperatura,'falla_reportada': item5.falla_reportada};
                                                                                                }         
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from evidencia_refacciones WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item6 = results.rows.item(i);
                                                                                                                    evidenciaRefacciones[i] = {'Valor':reporteTecnico,'fase': item6.fase,'clave': item6.clave,'cantidad': item6.cantidad,'descripcion': item6.descripcion,'foto': item6.foto,'fecha_regristro': item6.fecha_regristro};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from check_list WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item7 = results.rows.item(i);
                                                                                                                                    checkList[i] = {'Valor':reporteTecnico,'equipo': item7.equipo,'gabinete_exterior': item7.gabinete_exterior,'gabinete_interior': item7.gabinete_interior,'quemadores': item7.quemadores,'paneles': item7.paneles,'parillas': item7.parillas,'vulvas_espreas': item7.vulvas_espreas,'paneles_control': item7.paneles_control,'condensador': item7.condensador,'evaporador': item7.evaporador,'motores': item7.motores,'compresor': item7.compresor,'flautas': item7.flautas,'sistema_hidraulico': item7.sistema_hidraulico,'sistema_lavado': item7.sistema_lavado,'empaques': item7.empaques,'dereccion_fugas': item7.dereccion_fugas,'ajuste_electrico': item7.ajuste_electrico,'libricacion': item7.libricacion,'revision_operacion': item7.revision_operacion,'filtro_aire': item7.filtro_aire};
                                                                                                                                }
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function(tx){
                                                                                                                                        tx.executeSql("SELECT * from check_list2 WHERE id_cedula = ?",
                                                                                                                                            [id_cedula],
                                                                                                                                            function(tx, results){
                                                                                                                                                var length = results.rows.length;
                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                    var item8 = results.rows.item(i);
                                                                                                                                                    checkList2[i] = {'Valor':reporteTecnico,'equipo': item8.equipo,'vulvas': item8.vulvas,'termostato': item8.termostato,'control_presion': item8.control_presion,'sensor_flama': item8.sensor_flama,'quemadores': item8.quemadores,'turbinas': item8.turbinas,'resistencias': item8.resistencias,'sondas': item8.sondas,'tarjeta_electronica': item8.tarjeta_electronica,'compresor': item8.compresor,'motor_difusores': item8.motor_difusores,'aspas': item8.aspas,'contractores': item8.contractores,'fuga_tuberia': item8.fuga_tuberia,'aislante_tuberia': item8.aislante_tuberia,'condfensador': item8.condfensador,'iluminacion': item8.iluminacion,'empaques': item8.empaques,'fuga': item8.fuga};
                                                                                                                                                }
                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                    function(tx){
                                                                                                                                                        tx.executeSql("SELECT * from datos_equipo_despues WHERE id_cedula = ?",
                                                                                                                                                            [id_cedula],
                                                                                                                                                            function(tx, results){
                                                                                                                                                                var length = results.rows.length;
                                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                                    var item9 = results.rows.item(i);
                                                                                                                                                                    datosEquipoDespues[i] = {'Valor':reporteTecnico,'equipo': item9.equipo,'voltaje': item9.voltaje,'estado_voltaje': item9.estado_voltaje,'evidencia_voltaje': item9.evidencia_voltaje,'corriente': item9.corriente,'estado_corriente': item9.estado_corriente,'evidencia_corriente': item9.evidencia_corriente,'fases': item9.fases,'estado_fase': item9.estado_fase,'evidencia_fase': item9.evidencia_fase,'tipo_gas': item9.tipo_gas,'estado_gas': item9.estado_gas,'evidencia_gas': item9.evidencia_gas,'presion_gas': item9.presion_gas,'estado_presion_gas': item9.estado_presion_gas,'evidencia_presion_gas': item9.evidencia_presion_gas,'presion_vapor': item9.presion_vapor,'estado_presion_vapor': item9.estado_presion_vapor,'evidencia_presion_vapor': item9.evidencia_presion_vapor,'temperatura': item9.temperatura,'estado_temperatura': item9.estado_temperatura,'evidencia_estado_temperatura': item9.evidencia_estado_temperatura,'falla_reportada': item9.falla_reportada};
                                                                                                                                                                }
                                                                                                                                                                $.ajax({
                                                                                                                                                                    type: "POST",
                                                                                                                                                                    async : true,
                                                                                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarReporteDIPREC.php",
                                                                                                                                                                    dataType: 'html',
                                                                                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'servicioTecnico': JSON.stringify(servicioTecnico),'datosEquipo': JSON.stringify(datosEquipo),'evidenciaEquipo': JSON.stringify(evidenciaEquipo),'datosEquipoAntes': JSON.stringify(datosEquipoAntes),'evidenciaRefacciones': JSON.stringify(evidenciaRefacciones),'checkList': JSON.stringify(checkList),'checkList2': JSON.stringify(checkList2),'datosEquipoDespues': JSON.stringify(datosEquipoDespues)},
                                                                                                                                                                    success: function(respuesta){
                                                                                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                                                                                        var dat1 = respu1[0];
                                                                                                                                                                        var dat2 = respu1[1];
                                                                                                                                                                        if(dat1 == "CEDULA"){
                                                                                                                                                                            if(dat2 > 0){
                                                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                                                    function(tx7){
                                                                                                                                                                                        tx7.executeSql(
                                                                                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                            [id_cedula],
                                                                                                                                                                                            function(tx7, results){
                                                                                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                            }
                                                                                                                                                                                        );
                                                                                                                                                                                    }
                                                                                                                                                                                );
                                                                                                                                                                            }
                                                                                                                                                                        }
                                                                                                                                                                    },
                                                                                                                                                                    error: function(){
                                                                                                                                                                        console.log("Error en la comunicacion");
                                                                                                                                                                    }
                                                                                                                                                                });
                                                                                                                                                            },
                                                                                                                                                            function(tx, error){
                                                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                            }
                                                                                                                                                        );
                                                                                                                                                    },
                                                                                                                                                    function(error){},
                                                                                                                                                    function(){}
                                                                                                                                                );
                                                                                                                                            },
                                                                                                                                            function(tx, error){
                                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                            }
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                    function(error){},
                                                                                                                                    function(){}
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "minutaCoordinador"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM minuta_coordinador WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    minutaCoordinador[i] = {'Valor':i,'foto_entrada':item2.foto_entrada,'empresa':item2.empresa,'coordinador_obra':item2.coordinador_obra,'nombre_cliente':item2.nombre_cliente,'proyecto':item2.proyecto,'coordonador':item2.coordonador,'direccion':item2.direccion,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'puesto':item2.puesto};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from zonas_coordinador WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    zonasCoordinador[i] = {'Valor':i,'nombre': item3.nombre,'foto': item3.foto,'fecha_registro': item3.fecha_registro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from equipos_coordinador WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    equiposCoordinador[i] = {'Valor':i,'zona': item4.zona,'equipo': item4.equipo,'foto': item4.foto,'fecha_registro': item4.fecha_registro};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from datos_coordinador WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    datosCoordinador[i] = {'Valor':reporteTecnico,'zona': item5.zona,'equipo': item5.equipo,'voltaje': item5.voltaje,'estado_voltaje': item5.estado_voltaje,'evidencia_voltaje': item5.evidencia_voltaje,'corriente': item5.corriente,'estado_corriente': item5.estado_corriente,'evidencia_corriente': item5.evidencia_corriente,'fases': item5.fases,'estado_fase': item5.estado_fase,'evidencia_fase': item5.evidencia_fase,'tipo_gas': item5.tipo_gas,'estado_gas': item5.estado_gas,'evidencia_gas': item5.evidencia_gas,'presion_gas': item5.presion_gas,'estado_presion_gas': item5.estado_presion_gas,'evidencia_presion_gas': item5.evidencia_presion_gas,'presion_vapor': item5.presion_vapor,'estado_presion_vapor': item5.estado_presion_vapor,'evidencia_presion_vapor': item5.evidencia_presion_vapor,'temperatura': item5.temperatura,'estado_temperatura': item5.estado_temperatura,'evidencia_estado_temperatura': item5.evidencia_estado_temperatura,'falla_reportada': item5.falla_reportada};
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from observaciones WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item6 = results.rows.item(i);
                                                                                                                    observaciones[i] = {'Valor':reporteTecnico,'acuerdo': item6.acuerdo,'foto': item6.foto,'fecha_registro': item6.fecha_registro};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from notas WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item7 = results.rows.item(i);
                                                                                                                                    notas[i] = {'Valor':reporteTecnico,'nota': item7.nota,'foto': item7.foto,'fecha_registro': item7.fecha_registro};
                                                                                                                                }
                                                                                                                                $.ajax({
                                                                                                                                    type: "POST",
                                                                                                                                    async : true,
                                                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarMinutaDIPREC.php",
                                                                                                                                    dataType: 'html',
                                                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'minutaCoordinador': JSON.stringify(minutaCoordinador),'zonasCoordinador': JSON.stringify(zonasCoordinador),'equiposCoordinador': JSON.stringify(equiposCoordinador),'datosCoordinador': JSON.stringify(datosCoordinador),'observaciones': JSON.stringify(observaciones),'notas': JSON.stringify(notas)},
                                                                                                                                    success: function(respuesta){
                                                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                                                        var dat1 = respu1[0];
                                                                                                                                        var dat2 = respu1[1];
                                                                                                                                        if(dat1 == "CEDULA"){
                                                                                                                                            if(dat2 > 0){
                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                    function(tx7){
                                                                                                                                                        tx7.executeSql(
                                                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                            [id_cedula],
                                                                                                                                                            function(tx7, results){
                                                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                            }
                                                                                                                                                        );
                                                                                                                                                    }
                                                                                                                                                );
                                                                                                                                            }
                                                                                                                                        }
                                                                                                                                    },
                                                                                                                                    error: function(){
                                                                                                                                        console.log("Error en la comunicacion");
                                                                                                                                    }
                                                                                                                                });
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );

        }  else if(empresa == "SURO"){
            var datosCedulaGeneral = new Array();
            var sanitizacion = new Array();
            var evidenciaSanitizacion = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "sanitizacionSURO"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM sanitizacion_Suro WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    sanitizacion[i] = {'Valor':i,'nombre_cliente':item2.nombre_cliente,'foto_entrada':item2.foto_entrada,'sucursal':item2.sucursal,'direccion':item2.direccion,'correo':item2.correo,'nombre_usuario':item2.nombre_usuario,'foto_epp':item2.foto_epp,'foto_maquina':item2.foto_maquina,'foto_aspersor':item2.foto_aspersor,'foto_quimico':item2.foto_quimico,'foto_accesos':item2.foto_accesos,'foto_delimita_area':item2.foto_delimita_area,'fecha_foto_epp':item2.fecha_foto_epp,'fecha_foto_maquina':item2.fecha_foto_maquina,'fecha_foto_aspersor':item2.fecha_foto_aspersor,'fecha_foto_quimico':item2.fecha_foto_quimico,'fecha_foto_acceso':item2.fecha_foto_acceso,'fecha_foto_area':item2.fecha_foto_area,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'puesto':item2.puesto};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaSanitizacion[i] = {'Valor':i,'nombre_grupo': item3.nombre_grupo,'foto_evidencia': item3.foto_evidencia,'fases': item3.fases,'fecha_foto': item3.fecha_foto};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarSanitizacionSURO.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'sanitizacion': JSON.stringify(sanitizacion),'datosProductos': JSON.stringify(evidenciaSanitizacion)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }  else if(empresa == "MerGroup"){
            var datosCedulaGeneral = new Array();
            var reporteFotografico = new Array();
            var evidenciaFotografica = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "reporteFotografico"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM reporteFotografico WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    reporteFotografico[i] = {'Valor':i,'id_visita':item2.id_visita,'foto_entrada':item2.foto_entrada,'orden_compra':item2.orden_compra,'nombre_cliente':item2.nombre_cliente,'sitio':item2.sitio,'contratista':item2.contratista,'tipo_proyecto':item2.tipo_proyecto,'region':item2.region,'torre':item2.torre,'proceso':item2.proceso,'foto_salida':item2.foto_salida,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidenciaFotografica WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaFotografica[i] = {'Valor':i,'titulo': item3.titulo,'observacion': item3.observacion,'foto': item3.foto,'fecha_registro': item3.fecha_registro};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarReporteFotograficoMerGroup.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'reporteFotografico': JSON.stringify(reporteFotografico),'evidenciaFotografica': JSON.stringify(evidenciaFotografica)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "ServInd"){
            var datosCedulaGeneral = new Array();
            var reporteGeneral = new Array();
            var evidenciaReporteGeneral = new Array();
            var equiposReporteGeneral = new Array();

            var checkList = new Array();
            var evidenciaCheckList = new Array();

            var fotosAuditoria = new Array();
            var auditoriaDatos1 = new Array();
            var auditoriaDatos2 = new Array();
            
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "reporteGeneral"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM reporteGeneral WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    reporteGeneral[i] = {'Valor':i,'id_visita':item2.id_visita,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'orden_servicio':item2.orden_servicio,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_comercial':item2.nombre_comercial,'sucursal':item2.sucursal,'folio_interno':item2.folio_interno,'direccion':item2.direccion,'telefono':item2.telefono,'correo':item2.correo,'equipo':item2.equipo,'marca':item2.marca,'modelo':item2.modelo,'serie':item2.serie,'tipo_servicio':item2.tipo_servicio,'tipo_servicio':item2.tipo_servicio,'ciudad':item2.ciudad,'voltaje':item2.voltaje,'amp':item2.amp,'wc':item2.wc,'tierra_fisica':item2.tierra_fisica,'razon_servicio':item2.razon_servicio,'trabajo_realizado':item2.trabajo_realizado,'equipo_encontrado':item2.equipo_encontrado,'diagnostico':item2.diagnostico,'estatus_reporte':item2.estatus_reporte,'equipo_entrego':item2.equipo_entrego,'comentario':item2.comentario,'horas_activas':item2.horas_activas,'horas_viaje':item2.horas_viaje,'horas_espera':item2.horas_espera,'horas_totales':item2.horas_totales,'cotizacion':item2.cotizacion,'viaticos':item2.viaticos,'refacciones':item2.refacciones,'foto_salida':item2.foto_salida};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from equiposReporte WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    equiposReporteGeneral[i] = {'Valor':i,'origin': item3.origin,'numero_parte': item3.numero_parte,'descripcion': item3.descripcion,'prioridad': item3.prioridad,'cantidad': item3.cantidad,'fecha_registro': item3.fecha_registro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from evidenciasReporte WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item3 = results.rows.item(i);
                                                                                    evidenciaReporteGeneral[i] = {'Valor':i,'fase': item3.fase,'titulo': item3.titulo,'foto': item3.foto,'fecha_registro': item3.fecha_registro};
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarReporteGeneralServInd.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'reporteGeneral': JSON.stringify(reporteGeneral),'equiposReporteGeneral': JSON.stringify(equiposReporteGeneral),'evidenciaReporteGeneral': JSON.stringify(evidenciaReporteGeneral)},
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "checklistServ"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM checklist WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    checkList[i] = {'Valor':i,'id_visita':item2.id_visita,'orden_servicio':item2.orden_servicio,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_comercial':item2.nombre_comercial,'sucursal':item2.sucursal,'tienda':item2.nombre_comercial,'tienda':item2.sucursal,'direccion':item2.direccion,'modelo':item2.modelo,'serie':item2.serie,'voltaje':item2.voltaje,'amperaje':item2.amperaje,'breaker':item2.breaker,'presion':item2.presion,'dinamica':item2.dinamica,'estatica':item2.estatica,'amp1':item2.amp1,'amp2':item2.amp2,'amp3':item2.amp3,'amp4':item2.amp4,'amp5':item2.amp5,'amp6':item2.amp6,'amp7':item2.amp7,'amp8':item2.amp8,'temperatura':item2.temperatura,'nivel':item2.nivel,'magneto':item2.magneto,'magnetron':item2.magnetron,'transformadorhv':item2.transformadorhv,'diodohv':item2.diodohv,'capacitorhv':item2.capacitorhv,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida};
                                                }
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("SELECT * from selectcheck WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    var length = results.rows.length;
                                                                    for(var i = 0; i< length; i++){
                                                                        var item3 = results.rows.item(i);
                                                                        evidenciaCheckList[i] = {'Valor':i,'fase': item3.fase,'opcion': item3.opcion,'valor': item3.valor};
                                                                    }
                                                                    $.ajax({
                                                                        type: "POST",
                                                                        async : true,
                                                                        url: "http://www.appbennetts.com/FWM2/app/guardarChecklistServInd.php",
                                                                        dataType: 'html',
                                                                        data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'checkList': JSON.stringify(checkList),'evidenciaCheckList': JSON.stringify(evidenciaCheckList)},
                                                                        success: function(respuesta){
                                                                            var respu1 = respuesta.split("._.");
                                                                            var dat1 = respu1[0];
                                                                            var dat2 = respu1[1];
                                                                            if(dat1 == "CEDULA"){
                                                                                if(dat2 > 0){
                                                                                    databaseHandler.db.transaction(
                                                                                        function(tx7){
                                                                                            tx7.executeSql(
                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                [id_cedula],
                                                                                                function(tx7, results){
                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                }
                                                                                            );
                                                                                        }
                                                                                    );
                                                                                }
                                                                            }
                                                                        },
                                                                        error: function(){
                                                                            console.log("Error en la comunicacion");
                                                                        }
                                                                    });
                                                                },
                                                                function(tx, error){
                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "AuditoriaTecnico" || tipo == "AuditoriaSupervisorTecnico" || tipo == "AuditoriaLider"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM SV_Fotos WHERE SV_ID_Cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    fotosAuditoria[i] = {'Valor':i,'SV_Recorrido':item2.SV_Recorrido,'SV_Proceso':item2.SV_Proceso,'SV_titulo':item2.SV_titulo,'SV_FechaHora':item2.SV_FechaHora,'SV_Foto':item2.SV_Foto};
                                                }
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("SELECT * from Aud_Tec WHERE AT_ID_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    var length = results.rows.length;
                                                                    for(var i = 0; i< length; i++){
                                                                        var item3 = results.rows.item(i);
                                                                        auditoriaDatos1[i] = {'Valor':i,'AT_Pregunta': item3.AT_Pregunta,'AT_Resp1': item3.AT_Resp1,'AT_Resp2': item3.AT_Resp2,'AT_Resp3': item3.AT_Resp3,'AT_Resp4': item3.AT_Resp4,'AT_Resp5': item3.AT_Resp5,'AT_Resp6': item3.AT_Resp6,'AT_Resp7': item3.AT_Resp7,'AT_Resp8': item3.AT_Resp8,'AT_Resp9': item3.AT_Resp9,'AT_Resp10': item3.AT_Resp10,'AT_Resp11': item3.AT_Resp11,'AT_Resp12': item3.AT_Resp12,'AT_Resp13': item3.AT_Resp13,'AT_Resp14': item3.AT_Resp14,'AT_Resp15': item3.AT_Resp15,'AT_Resp16': item3.AT_Resp16,'AT_Resp17': item3.AT_Resp17,'AT_Total': item3.AT_Total};
                                                                    }
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("SELECT * from Aud_General WHERE AG_ID_cedula = ?",
                                                                                [id_cedula],
                                                                                function(tx, results){
                                                                                    var length = results.rows.length;
                                                                                    for(var i = 0; i< length; i++){
                                                                                        var item3 = results.rows.item(i);
                                                                                        auditoriaDatos2[i] = {'Valor':i,'AG_Auditoria': item3.AG_Auditoria,'AG_CaliGen': item3.AG_CaliGen,'AG_Cali': item3.AG_Cali,'AG_PorcentajeM': item3.AG_PorcentajeM,'AG_Obse': item3.AG_Obse,'AG_correo': item3.AG_correo,'AG_ID_Tecnico': item3.AG_ID_Tecnico,'AG_Tecnico': item3.AG_Tecnico,'AG_Puesto': item3.AG_Puesto};
                                                                                    }
                                                                                    $.ajax({
                                                                                        type: "POST",
                                                                                        async : true,
                                                                                        url: "http://www.appbennetts.com/FWM2/app/guardarAuditoriaServInd.php",
                                                                                        dataType: 'html',
                                                                                        data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'fotosAuditoria': JSON.stringify(fotosAuditoria),'auditoriaDatos1': JSON.stringify(auditoriaDatos1),'auditoriaDatos2': JSON.stringify(auditoriaDatos2)},
                                                                                        success: function(respuesta){
                                                                                            var respu1 = respuesta.split("._.");
                                                                                            var dat1 = respu1[0];
                                                                                            var dat2 = respu1[1];
                                                                                            if(dat1 == "CEDULA"){
                                                                                                if(dat2 > 0){
                                                                                                    databaseHandler.db.transaction(
                                                                                                        function(tx7){
                                                                                                            tx7.executeSql(
                                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                [id_cedula],
                                                                                                                function(tx7, results){
                                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                }
                                                                                                            );
                                                                                                        }
                                                                                                    );
                                                                                                }
                                                                                            }
                                                                                        },
                                                                                        error: function(){
                                                                                            console.log("Error en la comunicacion");
                                                                                        }
                                                                                    });
                                                                                },
                                                                                function(tx, error){
                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else {
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosSanitizacion = new Array();
            var evidenciaSanitizacion = new Array();
            var sanitizacion = 0;
            var evidenciaSani = 0;

            var datosLevantamiento = new Array();
            var evidenciaLevantamiento = new Array();
            var levantamiento = 0;
            var evidencialeva = 0;

            var datosFumigacion = new Array();
            var evidenciaFumigacion = new Array();
            var fumigacion = 0;
            var evidenciafumi = 0;

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "sanitizacion"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM sanitizacion WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosSanitizacion[sanitizacion] = {'Valor':sanitizacion,'id_sanitizacion': item2.id_sanitizacion,'id_cedula': item2.id_cedula,'foto_entrada':item2.foto_entrada,'sucursal':item2.sucursal,'direccion':item2.direccion,'persona_recibe':item2.persona_recibe,'documento_ingresar':item2.documento_ingresar,'descripcion_antes':item2.descripcion_antes,'foto_quimico':item2.foto_quimico,'foto_equipo':item2.foto_equipo,'areas_despejadas':item2.areas_despejadas,'descripcion_durante':item2.descripcion_durante,'descripcion_despues':item2.descripcion_despues,'foto_reporte':item2.foto_reporte,'recomendaciones':item2.recomendaciones,'firma_evalua':item2.firma_evalua,'fecha_firma':item2.fecha_firma,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    sanitizacion++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from fotos_sanitizacion WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                var fecha = new Date();
                                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaSanitizacion[evidenciaSani] = {'Valor':evidenciaSani,'id_sanitizacion_foto': item3.id_sanitizacion_foto,'id_cedula': item3.id_cedula,'fase':item3.fase,'foto_area':item3.foto_area,'nombre_area':item3.nombre_area,'fecha_foto':item3.fecha_foto,'fecha_envio':fecha_envio};
                                                                    evidenciaSani++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarSanitizacion.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosSanitizacion': JSON.stringify(datosSanitizacion),'evidenciaSanitizacion': JSON.stringify(evidenciaSanitizacion)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "levantamiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM levantamiento_servicio WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosLevantamiento[levantamiento] = {'Valor':levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'direccion':item2.direccion,'colonia':item2.colonia,'revision':item2.revision,'grado_infeccion':item2.grado_infeccion,'descripcion':item2.descripcion,'comentarios_tecnico':item2.comentarios_tecnico,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    levantamiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from levantamiento_evidencia WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                var fecha = new Date();
                                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaLevantamiento[evidencialeva] = {'Valor':evidencialeva,'id_cedula': item3.id_cedula,'area': item3.area,'foto_plaga': item3.foto_plaga,'descripcion_plaga': item3.descripcion_plaga,'observacion': item3.observacion,'fecha_regristro': item3.fecha_regristro,'fecha_envio':fecha_envio};
                                                                    evidencialeva++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarLevantamiento.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosLevantamiento': JSON.stringify(datosLevantamiento),'evidenciaLevantamiento': JSON.stringify(evidenciaLevantamiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "fumigacion"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM fumigacion WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosFumigacion[fumigacion] = {'Valor':fumigacion,'foto_entrada': item2.foto_entrada,'sucursal': item2.sucursal,'direccion': item2.direccion,'persona_recibe': item2.persona_recibe,'documento_ingresar': item2.documento_ingresar,'alcance_servicio': item2.alcance_servicio,'foto_quimico': item2.foto_quimico,'foto_equipo': item2.foto_equipo,'descripcion_antes': item2.descripcion_antes,'descripcion_durante': item2.descripcion_durante,'descripcion_despues': item2.descripcion_despues,'foto_reporte': item2.foto_reporte,'producto_utilizado': item2.producto_utilizado,'tipo_aplicacion': item2.tipo_aplicacion,'descripcion_tipo': item2.descripcion_tipo,'grado_infestacion': item2.grado_infestacion,'descripcion_infestacion': item2.descripcion_infestacion,'mantenimiento': item2.mantenimiento,'detalle_mantenimiento': item2.detalle_mantenimiento,'recomendaciones': item2.recomendaciones,'firma_evalua': item2.firma_evalua,'fecha_firma': item2.fecha_firma,'foto_salida': item2.foto_salida,'fecha_envio':fecha_envio};
                                                    fumigacion++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from fotos_fumigacion WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                var fecha = new Date();
                                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaFumigacion[evidenciafumi] = {'Valor':evidenciafumi,'fase': item3.fase,'foto_area': item3.foto_area,'nombre_area':item3.nombre_area,'fecha_foto':item3.fecha_foto,'fecha_envio':fecha_envio};
                                                                    evidenciafumi++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarFumigacion.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosFumigacion': JSON.stringify(datosFumigacion),'evidenciaFumigacion': JSON.stringify(evidenciaFumigacion)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    });
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    // AyB Fin
    //Suro Inicio
    function buscarClienteSURO(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#id_cliente").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#Nombre").val() + " " + $("#Sucursal").val();
        var Sucursal = $("#Sucursal").val();
        var Direccion = $("#Direccion").val();
        var correo = $("#correo").val();
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                localStorage.setItem("sucursal", Sucursal);
                                localStorage.setItem("direccion", Direccion);
                                localStorage.setItem("correo", correo);
                                app.views.main.router.navigate({name: 'menuSURO'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarSanitizacionSURO(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "sanitizacionSURO";
        let direccion = localStorage.getItem("direccion");
        let correo = localStorage.getItem("correo");
        let sucursal = localStorage.getItem("sucursal");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addSanitizacionSURO(id_cedula,foto_llegada,nombre_cliente,nombre_usuario,sucursal,direccion,correo);
                        productHandler.groupInit(id_cedula);
                        app.views.main.router.back('/recorridoSURO/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosSURO(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#sucursal").val() == "" || $("#direccion").val() == "" || $("#correo").val() == "" || $("#tecnico").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var sucursal = $("#sucursal").val();
        var direccion = $("#direccion").val();
        var correo = $("#correo").val();
        // var tipo_servicio = $("#servicio").val();
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion_Suro SET nombre_cliente = ?,sucursal = ?,direccion = ?,correo = ?, nombre_usuario =?  WHERE id_cedula = ?",
                    [cliente,sucursal,direccion,correo, nombre_usuario, id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#sucursal").css("background-color", "#FFFFFF");
                        $("#direccion").css("background-color", "#FFFFFF");
                        $("#correo").css("background-color", "#FFFFFF");
                        // $("#servicio").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedSURO(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoSURO'});
        } 
    }
    function añadirGrupoSuro(grupo) {
        console.log(grupo)
        var id_cedula = localStorage.getItem("IdCedula",id_cedula);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select MAX(indice) as Id from grupos WHERE id_cedula = ? AND fases = ?",
                    [id_cedula,grupo],
                    function(tx, results){
                        var item = results.rows.item(0);
                        var id_evidencia = item.Id;
                        id_evidencia = (id_evidencia + 1);
                        var nameaGroup = "Grupo " + id_evidencia; 
                        app.preloader.hide();
                        //Agregar nuevo grupo
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("insert into grupos(id_cedula,nombre_grupo,fases,indice) values(?,?,?,?)",
                                [id_cedula,nameaGroup,grupo,id_evidencia],
                                    function(tx, results){
                                        $('#grupo').prepend("<option value='"+ nameaGroup +"' >" + nameaGroup + "</option>");
                                        swal("","El grupo fue agregado correctamente","success");
                                        $("#grupo option[value='"+ nameaGroup +"']").attr("selected",true);
                                    },
                                    function(tx, error){
                                        console.log("Error al guardar cedula: " + error.message);
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al mostrar Registro guardado",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function regresarRecorridoSURO(){
        app.views.main.router.back('/recorridoSURO/', {force: true, ignoreCache: true, reload: true});
    }
    function startFromProgramSURO(nombre_comercial,sucursal,direccion,correo,id_cliente){
        localStorage.setItem("nombreCliente", nombre_comercial);
        localStorage.setItem("sucursal", sucursal);
        localStorage.setItem("id_cliente", id_cliente);
        localStorage.setItem("direccion", direccion);
        localStorage.setItem("correo", correo);
        app.views.main.router.navigate({name: 'yallegueSURO2'});
    }
    function iniciarClienteSURO(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = localStorage.getItem("id_cliente");
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        let tipoCedula = "sanitizacionSURO";
        var nombre_cliente = localStorage.getItem("nombreCliente") + " " + localStorage.getItem("sucursal");
        var sucursal = localStorage.getItem("sucursal");
        var direccion = localStorage.getItem("direccion");
        var correo = localStorage.getItem("correo");
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                            [tipoCedula,id_cedula],
                                            function(tx, results){
                                                productHandler.addSanitizacionSURO(id_cedula,foto_llegada,nombre_cliente,nombre_usuario,sucursal,direccion,correo);
                                                productHandler.groupInit(id_cedula);
                                                app.views.main.router.back('/recorridoSURO/', {force: true, ignoreCache: true, reload: true});
                                            },
                                            function(tx, error){
                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function guardarCierreSanitizacionSURO(){
        if($("#NombreFirma").val() == "" || $("#puesto").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var puesto = $("#puesto").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion_Suro SET firma_cliente = ?,fecha_cliente = ?,puesto = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,puesto,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoySanitizacionSURO/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarSanitizacionSURO(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion_Suro SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function eliminarFilaSURO(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function alertNotReadySURO(){
        var antes = $('#img2').prop('src');
        if(antes.includes("2")){
            
        } else {
            swal("","Debes llenar el apartado de ANTES, para poder ingresar a este apartado.","warning");
        }
    }
    //Suro Fin
    // Funcion global Inicio
    function moveProgram(){
        if(localStorage.getItem("programa") == 1){
            app.views.main.router.back('/calendar/', {force: true, ignoreCache: true, reload: true});
        } else {
            app.views.main.router.back('/excel/', {force: true, ignoreCache: true, reload: true});
        }
        
    }
    function changeCamera(check){
        if(check.includes('0')){
            localStorage.setItem("camera", "0");
            swal("","Se cambio exitosamente la configuracion de la camara.","success");
        } else {
            localStorage.setItem("camera", "1");
            swal("","Se cambio exitosamente la configuracion de la camara.","success");
        }
    }
    function changeProgram(check){
        if(check.includes('0')){
            localStorage.setItem("programa", "0");
            swal("","Se cambio exitosamente la configuracion del programa de visitas.","success");
        } else {
            localStorage.setItem("programa", "1");
            swal("","Se cambio exitosamente la configuracion del programa de visitas.","success");
        }
    }
    function capturePhoto() {
        var camera = localStorage.getItem("camera");
        if(camera == 0){
            var camera = app.popup.create({
                content: `
                <div class="popup" id="camera">
                    <div class="app">
                    <div id="deviceready camera-Field-frame">
                        <div class="top"></div>
                        <canvas id="camera-frame" style="display: none;"></canvas>
                        <video id="camera-view" autoplay playsinline class="raster" style="display: none;"></video>
                        <img src="" id="phototaked">
                        <div class="camera">
                            <div class="take" id="take" onclick="onTake()">
                                <div class="bubble-take"></div>
                            </div>
                            <div class="select popup-close" id="select" style="display: none;" onClick="onDone()"><img id="img-select" src="img/validar_camera.svg"></div>
                        </div>
                        <div class="left-action">
                            <div class="cancel popup-close" id="cancelCamera" onClick="onCancelCamera()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                            <div class="cancel " id="cancelPicure" onClick="onCancelPicture()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                        </div>
                        <div class="actions">
                            <div class="action torch" id="torch" onClick="onTorch()"><img id="flash" src="img/flash_off.svg" width="30px"></div>
                            <div class="action rotate-right" id="rotateRight" onClick="onRotateRight()" style="display:none"><img id="flash" src="img/rotate-right.svg" width="30px"></div>
                            <div class="action rotate-left" id="rotateLeft" onClick="onRotateLeft()" style="display:none"><img id="flash" src="img/rotate-left.svg" width="30px"></div>
                        </div>
                        <div class="right-action">
                            <div class="switch" id="switch" onClick="onSwitch()"><img class="image-switch" src="img/flip.svg"></div>
                        </div>
                        <audio id="audio" controls style="display: none;">
                            <source type="audio/mp3" src="img/camera.mp3">
                        </audio>
                        <input type="hidden" id="deviceOrientation" name="deviceOrientation"/>
                    </div>
                    <fwm></fwm>
                    </div>
                </div>
                `,
                on: {
                    open: function (popup) {
                        var permissions = cordova.plugins.permissions;
                        permissions.checkPermission(permissions.CAMERA, function( status ){
                            if (status.hasPermission){
                                cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                                function empresaCargada(){
                                    cameraStart(onPhotoDataSuccess)
                                }
                                function cargarEmpresa(url, callback){
                                    var pie = document.getElementsByTagName('fwm')[0];
                                    var script = document.createElement('script');
                                    script.type = 'text/javascript';
                                    script.src = url;
                                    script.id = "cameraSource";
                                    script.onload = callback;
                                    pie.appendChild(script);
                                }
                            }else{
                                permissions.requestPermission(permissions.CAMERA, success, error);
                                function error() {
                                    app.sheet.close('.popup')
                                    swal("Field Requiere los permisos","Para poder tomar las evidencias fotograficas necesitamos el permiso.","warning");
                                }
                                function success( status ){
                                    if(!status.hasPermission){
                                        error();
                                    } else {
                                        cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                                        function empresaCargada(){
                                            cameraStart(onPhotoDataSuccess)
                                        }
                                        function cargarEmpresa(url, callback){
                                            var pie = document.getElementsByTagName('fwm')[0];
                                            var script = document.createElement('script');
                                            script.type = 'text/javascript';
                                            script.src = url;
                                            script.id = "cameraSource";
                                            script.onload = callback;
                                            pie.appendChild(script);
                                        }
                                    }

                                }
                            }
                        });
                    },
                    opened: function (popup) {
                      localStorage.setItem("cameraField", "Active");
                    },
                    closed: function (popup) {
                      window.localStorage.removeItem("cameraField");
                    },
                }
            });
            camera.open();
        } else {
            navigator.camera.getPicture(onPhotoDataSuccess, onFail, {
                quality: 100,
                destinationType: destinationType.DATA_URL,
                targetWidth: 500,
                targetHeight: 500,
                correctOrientation: true,
            });
        }
    }
    //Opcion para ir a menu
    function checkStatus(check){
        if(check.includes('1')){
            var valCheck = document.getElementById(check).checked;
            if(valCheck ==true){                        
                var name = check.replace('1','');
                var otherCheck = name + '0';
                document.getElementById(otherCheck).checked = false;
            }
        } else {
            var valCheck = document.getElementById(check).checked;
            if(valCheck ==true){                        
                var name = check.replace('0','');
                var otherCheck = name + '1';
                document.getElementById(otherCheck).checked = false;
            }
        }
    }
    function moveMenu() {
        var empresa = localStorage.getItem("nombre_empresa");
        if(empresa == "SMC"){
            app.views.main.router.navigate({ name: 'yallegueSMC'});
        } else if(empresa == "DIPREC"){
            app.views.main.router.navigate({ name: 'yallegueDIPREC'});
        } else if(empresa == "Bennetts"){
            app.views.main.router.navigate({ name: 'yallegueBennetts'});
        } else if(empresa == "SURO"){
            app.views.main.router.navigate({ name: 'yallegueSURO'});
        } else if(empresa == "Field"){
            app.views.main.router.navigate({ name: 'yallegueField'});
        } else if(empresa == "PlatoLimpio"){
            app.views.main.router.navigate({ name: 'yalleguePlatoLimpio'});
        } else if(empresa == "ServInd"){
            app.views.main.router.navigate({ name: 'yallegueServInd'});
        } else if(empresa == "MerGroup"){
            app.views.main.router.navigate({ name: 'yallegueMerGroup'});
        }
        localStorage.setItem("Opcion", '1');
        app.views.main.router.navigate({ name: 'yallegue'});
    }
    function EliminarActualizacionesAntiguas(){
        var IdUsuario = localStorage.getItem("id_usuario");
        var fecha = new Date();
        var fecha_ingreso = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        fecha_eliminar = editar_fecha(fecha_ingreso, "-30", "d","-");
        databaseHandler.db.transaction(
            function(tx5){
                tx5.executeSql("SELECT * FROM Actualizaciones  WHERE Fecha < ? AND IdUsuario = ?",
                    [fecha_eliminar,IdUsuario],
                    function(tx5, results){
                        var length = results.rows.length;
                        for(var i = 0; i< length; i++){
                            var item2 = results.rows.item(i);
                            var IdEliminar = item2.idActualizacion;
                            databaseHandler.db.transaction(
                                function(tx4){
                                    tx4.executeSql(
                                        "DELETE FROM Actualizaciones WHERE idActualizacion = ?",
                                        [IdEliminar],
                                        function(tx4, results){
                                        },
                                        function(tx4, error){
                                            console.errror("Error al eliminar: " + error.message);
                                        }
                                    );
                                },
                                function(error){
                                    console.error("Error al seleccionar actualzaciones:" + error.message)
                                },
                                function(){}
                            );
                        }
                    }
                )
            }
        );
    }
    function inputLleno(id,value){
        id = "#"+id;
        if (value == "") {
            $(id).css("background-color","#ffffff");
        } else if(value == "0"){
            $(id).css("background-color","#ffffff");
        } else {
            $(id).css("background-color","#E0F8F7");
        }
    }

    function eliminarFila(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM levantamiento_evidencia WHERE id_levantamiento_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_fumigacion WHERE id_fumigacion_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_sanitizacion WHERE id_sanitizacion_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    // Funcion global Fin

    function buscarC(){
        app.preloader.show('blue');
        var opc = localStorage.getItem("Opcion");
        var Division = localStorage.getItem("Division");
        if(opc == 1){
            var icedulas = localStorage.getItem("IdCedula");
            var cte = $('#cte').val();
            var geolocation = $("#geolocation").val();
            var imagenC = $("#imagenC").val();
            var fecha = new Date();
            var fFinal = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            var ncomercial = $("#ncomercial").val();
            var ncontacto = $("#ncontacto").val();
            var telefono = $("#telefono").val();
            var correo = $("#correo").val();
            var estatusc = $("#estatusc").val();
            var Nomcte = $("#Nomcte").val();
            if(cte != ''){
                if(icedulas > 0){  //Actualizar la cedula de seguimiento
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE Cedula SET IdCte = ? WHERE IdCedula = ?",
                                [cte, icedulas],
                                function(tx, results){
                                    app.dialog.alert('El registro se actualizo correctamente.', 'Aviso');
                                    app.preloader.hide();
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("Select * from Clientes where IdCte = ? AND Division = ?",
                                                [cte, Division],
                                                function(tx, results){
                                                    var length = results.rows.length;
                                                    if(length > 0){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("UPDATE Clientes SET NomComercial = ?, NomContacto = ?, Telefono = ?, Email = ?, Estatus = ?, Cliente = ? WHERE IdCte = ? AND Division = ?",
                                                                    [ncomercial, ncontacto, telefono, correo, estatusc, Nomcte ,cte, Division],
                                                                    function(tx, results){
                                                                        app.views.main.router.navigate({name: 'recorrido1'});
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    } else {
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("INSERT INTO Clientes (NomComercial, NomContacto, Telefono, Email, IdCte, Estatus, Cliente, Division) VALUES (?,?,?,?,?,?,?,?)",
                                                                    [ncomercial, ncontacto, telefono, correo, cte, estatusc, Nomcte, Division ],
                                                                    function(tx, results){
                                                                        app.views.main.router.navigate({name: 'recorrido1'});
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    }
                                                },
                                                function(tx, error){
                                                    console.log("Error al guardar cedula: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    console.log("Error al guardar cedula: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                } else {
                    var Division = localStorage.getItem("Division");
                    if(Division == 3){
                        var NomJson ='ClientesCDC';
                        var NomDescCli = 'ClientesCDCDesc';
                    }else{
                        var NomJson = 'clientes_desc';
                        var NomDescCli = "Clientes";
                    }
                    if(imagenC != ''){//insertar la cedula
                        app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", { IdCed: cte}, function (data) {
                            var content = JSON.parse(data);
                            var valor='';
                            for(var i=0; i < content.length; i++){
                                for (var i = 0; i < data.length; i++) {
                                    if(content[i].IdCte == cte){
                                        //DATOS A GUARDAR
                                        productHandler.addCedula(IdUsuario,cte,fFinal,imagenC,geolocation);
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(IdCedula) as Id from Cedula",
                                                    [],
                                                    function(tx, results){
                                                        var length = results.rows.length;
                                                        var item = results.rows.item(0);
                                                        localStorage.setItem("IdCedula", item.Id);
                                                        localStorage.setItem("IdCte", cte);
                                                        app.preloader.hide();
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from Clientes where IdCte = ? AND Division = ?",
                                                                    [cte, Division],
                                                                    function(tx, results){
                                                                        var length = results.rows.length;
                                                                            if(length > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("UPDATE Clientes SET NomComercial = ?, NomContacto = ?, Telefono = ?, Email = ?, Estatus = ?, Cliente = ? WHERE IdCte = ? AND Division = ?",
                                                                                            [ncomercial, ncontacto, telefono, correo, estatusc, Nomcte ,cte, Division],
                                                                                            function(tx, results){
                                                                                                app.views.main.router.navigate({name: 'recorrido1'});
                                                                                                app.preloader.hide();
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al guardar cedula: " + error.message);
                                                                                                app.preloader.hide();
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            } else {
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("INSERT INTO Clientes (NomComercial, NomContacto, Telefono, Email, IdCte, Estatus, Cliente, Division) VALUES (?,?,?,?,?,?,?,?)",
                                                                                            [ncomercial, ncontacto, telefono, correo, cte, estatusc, Nomcte , Division],
                                                                                            function(tx, results){
                                                                                                app.views.main.router.navigate({name: 'recorrido1'});
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al guardar cedula: " + error.message);
                                                                                                app.preloader.hide();
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            }
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    }
                                }
                            }
                        });
                    } else {
                        app.dialog.alert('El campo: Fotograf\u00eda. Es requerido.', 'Aviso');
                        app.preloader.hide();
                    }
                }
            } else {
                app.dialog.alert('Favor de seleccionar un cliente.', 'Aviso');
                app.preloader.hide();
            }
        }
    }
function ObservacionesPe(){
    var icedula = localStorage.getItem("IdCedula");
    var observaciones = $("#Obser").val();
    databaseHandler.db.transaction(
        function(tx1){
            tx1.executeSql(
                "select * from ObservacionesPedido WHERE IdCedula= ?",
                [icedula],
                function(tx1, results){
                    var valor = results.rows.length;
                    if(valor > 0){
                        databaseHandler.db.transaction(
                            function(tx1){
                                tx1.executeSql(
                                    "UPDATE ObservacionesPedido SET Observaciones = ? WHERE IdCedula = ? ",
                                    [observaciones,icedula],
                                    function(tx1, results){
                                        var valor = results.rows.length;
                                        app.preloader.hide();
                                    }
                            )},
                            function(error){},
                            function(){}
                        );
                    }else{
                        databaseHandler.db.transaction(
                            function(tx1){
                                tx1.executeSql(
                                    "INSERT INTO ObservacionesPedido (IdCedula, Observaciones) VALUES (?,?)",
                                    [icedula,observaciones],
                                    function(tx1, results){
                                        var valor = results.rows.length;
                                        app.preloader.hide();
                                    }
                            )},
                            function(error){},
                            function(){}
                        );
                    }
                }
        )},
        function(error){},
        function(){}
    );
}

//imagen
function gimagen(){
    //IMAGEN EN BUEN ESTADO NO PEDIR NADA
    app.preloader.show('blue');
    var file_data = $('#imagenC').val();
    var icedula = localStorage.getItem("IdCedula");
    var tipoimagen = document.getElementById("tipoimagen").value;
    var cantidad = $("#cantidad").val();
    var ubicacion =  $("#ubicacion").val();
    var comentario = $("#comentario").val();
    var radio = $('input[name=demo-radio1]:checked').val();
    app.preloader.hide();
    if(tipoimagen != 0){
        if(radio == 1 || radio == 2){
            if(radio == 1){ //Buen estado
                databaseHandler.db.transaction(
                function(tx1){
                    tx1.executeSql(
                        "INSERT INTO imagen (IdTipoImagen,Cantidad, Ubicacion ,checkbox, Comentario, FotoImagen, IdCedula) VALUES (?,?,?,?,?,?,?)",
                        [tipoimagen, cantidad, ubicacion, radio,comentario, file_data, icedula ],
                        function(tx2, results){
                           //Extraer el ultimo registro
                            databaseHandler.db.transaction(
                            function(tx3){
                                tx3.executeSql(
                                "Select MAX(IdImagen) as Id from imagen",
                                [],
                                function(tx4, results){
                                    var length = results.rows.length;
                                    var item = results.rows.item(0);
                                    var IdCEq = item.Id;
                                    //Consultar el producto
                                    databaseHandler.db.transaction(
                                        function(tx5){
                                            tx5.executeSql(
                                                "Select * from imagen where IdImagen = ?",
                                                [IdCEq],
                                                function(tx5, results){
                                                    var length = results.rows.length;
                                                    var item2 = results.rows.item(0);
                                                    if(item2.IdTipoImagen == 1){ var TipoImagen = "Wallchart"; }
                                                    if(item2.IdTipoImagen == 2){ var TipoImagen = "Etiqueta"; }
                                                    if(item2.IdTipoImagen == 3){ var TipoImagen = "Imagen del cliente"; }
                                                    if(item2.IdTipoImagen == 4){ var TipoImagen = "Carpeta del cliente"; }
                                                    if(item2.IdTipoImagen == 5){ var TipoImagen = "Concentraci&oacute;n de Equipos"; }
                                                    if(item2.IdTipoImagen == 6){ var TipoImagen = "Env&iacute;o de Etiquetas"; }
                                                    if(item2.IdTipoImagen == 7){ var TipoImagen = "Env&iacute;o de FT electrónicas"; }
                                                    if(item2.checkBox == 1){ var Estado ="Imagen en buen estado"; }
                                                    if(item2.checkBox == 2){ var Estado ="Imagen en mal estado"; }
                                                    $("#tablaimagen tbody").append("<tr id='fila"+ item2.IdImagen +"'><td><a href='#' onclick='eliminarFila("+ item2.IdImagen +", 2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></td><td text-align: center;><img src='"+item2.FotoImagen+"' width='60px'/></td><td text-align: center;>" + TipoImagen + "</td><td text-align: center;>" + item2.Cantidad + "</td><td  text-align: center;>"+ item2.Ubicacion+"</td><td  text-align: center;>"+ Estado + "</td><td  text-align: center;>"+ item2.Comentario + "</td></tr>");
                                                    $("#cantidad").val('');
                                                    $("#ubicacion").val('');
                                                    $("#comentario").val('');
                                                    $('#imagenC').val('');

                                                    $("#cantidad").css("background-color", "#ffffff");
                                                    $("#ubicacion").css("background-color", "#ffffff");
                                                    $("#comentario").css("background-color", "#ffffff");
                                                    $("#tipoimagen").css("background-color", "#ffffff");
                                                    document.getElementById("BradioI").checked = false;
                                                    document.getElementById("MradioI").checked = false;

                                                    document.ready = document.getElementById("tipoimagen").value = '0';

                                                    app.preloader.hide();
                                                },
                                                function(tx5, error){
                                                    console.log("Error al guardar registro: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                        //Fin de consulgtar el producto
                                },
                                function(tx4, error){
                                    console.log("Error al guardar registro: " + error.message);
                                }
                            );
                            },
                            function(error){},
                            function(){}
                        ); //FIN DE Extraer el ultimo registro
                           app.dialog.alert('El registro se guardo correctamente.', 'Aviso');
                        },
                        function(tx2, error){
                            console.log("Error al guardar el imagen: " + error.message);

                        }
                    );
                },
                function(error){},
                function(){}
                );
            }else if(radio == 2){ //mal estado
            if(cantidad != ''){
                if(ubicacion != ''){
                    if(comentario != ''){
                        databaseHandler.db.transaction(
                            function(tx1){
                                tx1.executeSql(
                                    "INSERT INTO imagen (IdTipoImagen,Cantidad, Ubicacion ,checkbox, Comentario, FotoImagen, IdCedula) VALUES (?,?,?,?,?,?,?)",
                                    [tipoimagen, cantidad, ubicacion, radio,comentario, file_data, icedula ],
                                    function(tx2, results){
                                       //Extraer el ultimo registro
                                        databaseHandler.db.transaction(
                                        function(tx3){
                                            tx3.executeSql(
                                            "Select MAX(IdImagen) as Id from imagen",
                                            [],
                                            function(tx4, results){
                                                var length = results.rows.length;
                                                var item = results.rows.item(0);
                                                var IdCEq = item.Id;
                                                //Consultar el producto
                                                databaseHandler.db.transaction(
                                                    function(tx5){
                                                        tx5.executeSql(
                                                            "Select * from imagen where IdImagen = ?",
                                                            [IdCEq],
                                                            function(tx5, results){
                                                                var length = results.rows.length;
                                                                var item2 = results.rows.item(0);
                                                                if(item2.IdTipoImagen == 1){ var TipoImagen = "Wallchart"; }
                                                                if(item2.IdTipoImagen == 2){ var TipoImagen = "Etiqueta"; }
                                                                if(item2.IdTipoImagen == 3){ var TipoImagen = "Imagen del cliente"; }
                                                                if(item2.IdTipoImagen == 4){ var TipoImagen = "Carpeta del cliente"; }
                                                                if(item2.IdTipoImagen == 5){ var TipoImagen = "Concentraci&oacute;n de Equipos"; }
                                                                if(item2.IdTipoImagen == 6){ var TipoImagen = "Env&iacute;o de Etiquetas"; }
                                                                if(item2.IdTipoImagen == 7){ var TipoImagen = "Env&iacute;o de FT electrónicas"; }
                                                                if(item2.checkBox == 1){ var Estado ="Imagen en buen estado"; }
                                                                if(item2.checkBox == 2){ var Estado ="Imagen en mal estado"; }
                                                                $("#tablaimagen tbody").append("<tr id='fila"+ item2.IdImagen +"'><td><a href='#' onclick='eliminarFila("+ item2.IdImagen +", 2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></td><td text-align: center;><img src='"+item2.FotoImagen+"' width='60px'/></td><td text-align: center;>" + TipoImagen + "</td><td text-align: center;>" + item2.Cantidad + "</td><td  text-align: center;>"+ item2.Ubicacion+"</td><td  text-align: center;>"+ Estado + "</td><td  text-align: center;>"+ item2.Comentario + "</td></tr>");
                                                                $("#cantidad").val('');
                                                                $("#ubicacion").val('');
                                                                $("#comentario").val('');
                                                                $('#imagenC').val('');

                                                                $("#cantidad").css("background-color", "#ffffff");
                                                                $("#ubicacion").css("background-color", "#ffffff");
                                                                $("#comentario").css("background-color", "#ffffff");
                                                                $("#tipoimagen").css("background-color", "#ffffff");
                                                                document.getElementById("BradioI").checked = false;
                                                                document.getElementById("MradioI").checked = false;
                                                                document.ready = document.getElementById("tipoimagen").value = '0';
                                                                app.preloader.hide();
                                                            },
                                                            function(tx5, error){
                                                                console.log("Error al guardar registro: " + error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                                    //Fin de consulgtar el producto
                                            },
                                            function(tx4, error){
                                                console.log("Error al guardar registro: " + error.message);
                                            }
                                        );
                                        },
                                        function(error){},
                                        function(){}
                                    ); //FIN DE Extraer el ultimo registro
                                       app.dialog.alert('El registro se guardo correctamente.', 'Aviso');
                                    },
                                    function(tx2, error){
                                        console.log("Error al guardar el imagen: " + error.message);

                                    }
                                );
                            },
                            function(error){},
                            function(){}
                            );
                    } else {
                        app.dialog.alert('El campo: Comentario. Es requerido.', 'Aviso');
                        app.preloader.hide();
                    }
                } else {
                    app.dialog.alert('El campo: Ubicacion. Es requerido.', 'Aviso');
                    app.preloader.hide();
                }
            }else {
                app.dialog.alert('El campo: Cantidad. Es requerido.', 'Aviso');
                app.preloader.hide();
            }
            }
        }else {
            app.dialog.alert('Favor de seleccionar en que estado se encuentra. Es requerido.', 'Aviso');
            app.preloader.hide();
        }
    } else {
        app.dialog.alert('El campo: Tipo. Es requerido.', 'Aviso');
        app.preloader.hide();
    }

}
//entrenamiento
function gentrenamiento(){
    app.preloader.show('blue');
    var icedula = localStorage.getItem("IdCedula");
    var file_data = $('#imagenC').val();
    var personaCapacitada = $("#personaCapacitada").val();
    var puesto  = $("#puesto").val();
    var temaCapacitacion = $("#temaCapacitacion").val()
    var comentario = $("#comentario").val();
    var TipoCapacitacion = document.getElementById("TipoCapacitacion").value;

    if(TipoCapacitacion != 0) {
        if($("#personaCapacitada").val() != '' ){
            if($("#puesto").val() != ''){
                if($("#temaCapacitacion").val() != ''){
                    if($("#comentario").val() != ''){
                            databaseHandler.db.transaction(
                                function(tx1){
                                    tx1.executeSql(
                                        "INSERT INTO entrenamiento (IdCedula,PersonaCapacitada, Puesto, TemaCapacitacion, Comentario, ImagenFirma, Tipo) VALUES (?,?,?,?,?,?,?)",
                                        [icedula, personaCapacitada, puesto, temaCapacitacion, comentario, file_data, TipoCapacitacion ],
                                        function(tx2, results){
                                           //Extraer el ultimo registro
                                            databaseHandler.db.transaction(
                                            function(tx3){
                                                tx3.executeSql(
                                                    "Select MAX(IdEntrenamiento) as Id from entrenamiento",
                                                    [],
                                                    function(tx4, results){
                                                        var length = results.rows.length;
                                                        var item = results.rows.item(0);
                                                        var IdCEq = item.Id;
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx5){
                                                                tx5.executeSql(
                                                                    "Select * from entrenamiento where IdEntrenamiento = ?",
                                                                    [IdCEq],
                                                                    function(tx5, results){
                                                                        var length = results.rows.length;
                                                                        var item2 = results.rows.item(0);
                                                                        app.dialog.alert('El registro se guardo correctamente.', 'Aviso');
                                                                        $("#personaCapacitada").val('');
                                                                        $("#puesto").val('');
                                                                        $("#temaCapacitacion").val('');
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#comentario").val('');
                                                                        $('#imagenC').val('');
                                                                        if(item2.Tipo == 1){
                                                                            var TipoCap = "Capacitacion en linea";
                                                                        }
                                                                        if(item2.Tipo == 2){
                                                                            var TipoCap = "Capacitacion presencial";
                                                                        }
                                                                        $("#tablaE tbody").append("<tr id='fila"+ item2.IdEntrenamiento +"'><td><a href='#' onclick='eliminarFila("+ item2.IdEntrenamiento +", 3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item2.ImagenFirma+"' width='60px'/></td><td text-align: center;>" + TipoCap + "</td><td text-align: center;>" + item2.PersonaCapacitada+ "</td><td text-align: center;>" + item2.Puesto + "</td><td text-align: center;>" + item2.TemaCapacitacion + "</td><td text-align: center;>" + item2.Comentario + "</td></tr>");
                                                                        $("#personaCapacitada").css("background-color", "#FFFFFF");
                                                                        $("#puesto").css("background-color", "#FFFFFF");
                                                                        $("#temaCapacitacion").css("background-color", "#FFFFFF");
                                                                        $("#comentario").css("background-color", "#FFFFFF");
                                                                        app.preloader.hide();

                                                                    },
                                                                    function(tx5, error){
                                                                        console.log("Error al guardar registro: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                        //Fin de consulgtar el producto
                                                    },
                                                    function(tx4, error){
                                                        console.log("Error al guardar registro: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                            ); //FIN DE Extraer el ultimo registro
                                        },
                                        function(tx2, error){
                                            console.log("Error al guardar el imagen: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );

                    } else{
                        app.dialog.alert('El campo: Comentario. Es requerido.', 'Aviso');
                        app.preloader.hide();
                    }
                } else{
                    app.dialog.alert('El campo: Tema capacitaci\u00f3n. Es requerido.', 'Aviso');
                    app.preloader.hide();
                }
            } else{
               app.dialog.alert('El campo: Puesto. Es requerido.', 'Aviso');
               app.preloader.hide();
            }
        }else{
            app.dialog.alert('El campo: Persona capacitada. Es requerido.', 'Aviso');
            app.preloader.hide();
        }
    }else{
        app.dialog.alert('Favor de seleccionar un tipo de capacitacion.', 'Aviso');
        app.preloader.hide();
    }
}

//Pantalla vertical
function vertical(){
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
}
//Pantalla horizontal
function landsca(){
    screen.orientation.lock('landscape');
    //screen.orientation.unlock();
}
// Cerrar Popup
function gClose(){
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
}
var testFirma;

function createFirma(){
    screen.orientation.lock('landscape');
    var signaturePad = new SignaturePad(document.getElementById('signature-pad'), {
      backgroundColor: 'rgba(255, 255, 255, 0)',
      penColor: 'rgb(6, 62, 127)'
    });
    testFirma = signaturePad;
}
function gfirma(){
    var signaturePad = testFirma;
    var data = signaturePad.toDataURL('data:image/jpeg;base64,');
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
    $("#signate").val(data);
    $('#ImagenFirmaView').attr('src', data);
    $('#VolverFirmar').html("Evidencia");
    var fecha = new Date();
    var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
    var hora_firma = fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    var geo = $('#geolocation').val();
    var firma = geo + "|" + fecha_firma + "|" +hora_firma
    const firmaEn = window.btoa(geo + "|" + fecha_firma + "|" +hora_firma)
    $("#firmaElectro2").html(`<span style="color: gray;font-style: italic;">|${firma}|f-${firmaEn}-</span>`)
}
function gFotoFirmaServ(){
    var data2 = $('#imgSigPhoto').val();
    $("#signate").val(data2);
    $("#imgSigPhoto").val(data2);
    app.popup.close()
    app.popup.open(".popup-encuesta")
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
    $('#ImagenFirmaView').attr('src', data2);
 }

function cleanFirma(){
    var signaturePad = testFirma;
    signaturePad.clear();
}

// Tomar foto firma
function capturaFirma() {
    var camera = localStorage.getItem("camera");
        if(camera == 0){
          var camera = app.popup.create({
            content: `
            <div class="popup" id="camera">
                <div class="app">
                <div id="deviceready camera-Field-frame">
                    <div class="top"></div>
                    <canvas id="camera-frame" style="display: none;"></canvas>
                    <video id="camera-view" autoplay playsinline class="raster" style="display: none;"></video>
                    <img src="" id="phototaked">
                    <div class="camera">
                        <div class="take" id="take" onclick="onTake()">
                            <div class="bubble-take"></div>
                        </div>
                        <div class="select popup-close" id="select" style="display: none;" onClick="onDone()"><img id="img-select" src="img/validar_camera.svg"></div>
                    </div>
                    <div class="left-action">
                        <div class="cancel popup-close" id="cancelCamera" onClick="onCancelCamera()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                        <div class="cancel" id="cancelPicure" onClick="onCancelPicture()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                    </div>
                    <div class="actions">
                        <div class="action torch" id="torch" onClick="onTorch()"><img id="flash" src="img/flash_off.svg" width="30px"></div>
                        <div class="action rotate-right" id="rotateRight" onClick="onRotateRight()" style="display:none"><img id="flash" src="img/rotate-right.svg" width="30px"></div>
                        <div class="action rotate-left" id="rotateLeft" onClick="onRotateLeft()" style="display:none"><img id="flash" src="img/rotate-left.svg" width="30px"></div>
                    </div>
                    <div class="right-action">
                        <div class="switch" id="switch" onClick="onSwitch()"><img class="image-switch" src="img/flip.svg"></div>
                    </div>
                    <audio id="audio" controls style="display: none;">
                        <source type="audio/mp3" src="img/camera.mp3">
                    </audio>
                    <input type="hidden" id="deviceOrientation" name="deviceOrientation"/>
                </div>
                <fwm></fwm>
                </div>
            </div>
        `,
        on: {
            open: function (popup) {
                var permissions = cordova.plugins.permissions;
                permissions.checkPermission(permissions.CAMERA, function( status ){
                    if (status.hasPermission){
                        cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                        function empresaCargada(){
                            cameraStart(onPhotoSingSuccess)
                        }
                        function cargarEmpresa(url, callback){
                            var pie = document.getElementsByTagName('fwm')[0];
                            var script = document.createElement('script');
                            script.type = 'text/javascript';
                            script.src = url;
                            script.id = "cameraSource";
                            script.onload = callback;
                            pie.appendChild(script);
                        }
                    }else{
                        permissions.requestPermission(permissions.CAMERA, success, error);
                        function error() {
                            app.sheet.close('.popup')
                            swal("Field Requiere los permisos","Para poder tomar las evidencias fotograficas necesitamos el permiso.","warning");
                        }
                        function success( status ){
                            if(!status.hasPermission){
                                error();
                            } else {
                                cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                                function empresaCargada(){
                                    cameraStart(onPhotoSingSuccess)
                                }
                                function cargarEmpresa(url, callback){
                                    var pie = document.getElementsByTagName('fwm')[0];
                                    var script = document.createElement('script');
                                    script.type = 'text/javascript';
                                    script.src = url;
                                    script.id = "cameraSource";
                                    script.onload = callback;
                                    pie.appendChild(script);
                                }
                            }

                        }
                    }
                });
            },
            opened: function (popup) {
              localStorage.setItem("cameraField", "Active");
            },
            closed: function (popup) {
              window.localStorage.removeItem("cameraField");
            },
        }
            });
            camera.open();
        } else {
          navigator.camera.getPicture(onPhotoSingSuccess,onFail, {
              quality: 100,
              destinationType: destinationType.DATA_URL,
              targetWidth: 500,
              targetHeight: 500,
              correctOrientation: true
          });
        }
    $('#FotoYaLLegue').attr('src', "img/camara.png");
}
// Funcion si se logra tomar la foto a la firma
function onPhotoSingSuccess(imageData) {
    var camera = localStorage.getItem("camera");
      if(camera == 0){
        var smallImage = document.getElementById('smallImage');
        smallImage.style.display = 'flex';
        var nameima = imageData;
        smallImage.src = imageData;
        $('#imgSigPhoto').val(nameima);
        $("#photoIcon").attr("src","img/reload.svg");
      }else{
        var smallImage = document.getElementById('smallImage');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $('#imgSigPhoto').val(nameima);
        $("#photoIcon").attr("src","img/reload.svg");
      }
}

// Guarda la fotografia de la firma tomada
function gFotoFirma(){
    var data2 = $('#imgSigPhoto').val();
    $("#signate").val(data2);
    $("#imgSigPhoto").val(data2);
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
    $('#ImagenFirmaView').attr('src', data2);
    var fecha = new Date();
    var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
    var hora_firma = fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    var geo = $('#geolocation').val();
    var firma = geo + "|" + fecha_firma + "|" +hora_firma
    const firmaEn = window.btoa(geo + "|" + fecha_firma + "|" +hora_firma)
    $("#firmaElectro2").html(`<span style="color: gray;font-style: italic;">|${firma}|f-${firmaEn}-</span>`)
 }

//CIERRE
function gcierre(){
    app.preloader.show('blue');
    var IdCte = localStorage.getItem("IdCte");
    var IdCed = localStorage.getItem("IdCedula");
    var file_data = $('#signate').val();
    var estre = $("#eval").val();
    var ccte = $("#text2").val();
    var envio = $('input[name="estado"]:checked').val();
    var geo = $("#geolocation").val();
    var NombreFirma = $("#NombreFirma").val();

    var NombreCuenta = $("#NombreCuenta").val();
    var CorreoCuenta = $("#CorreoCuenta").val();

    var nombre = document.getElementById('cli').innerHTML;
    var ArCadena = nombre.split(' ');
    var cliente = ArCadena[0];
    var ClienteMin = cliente.toLowerCase();

    databaseHandler.db.transaction(
        function(tx1){
            tx1.executeSql(
                "SELECT IdCedula FROM cierre WHERE IdCedula = ?",
                [IdCed],
                function(tx1, results){
                    var length = results.rows.length;

                    if(length > 0){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql(
                                    "UPDATE cierre SET eval = ?,cfirma = ?,coment = ?,NombreFirma = ?, NombreCuenta = ?, CorreoCuenta = ? WHERE IdCedula = ?",
                                    [estre,file_data,ccte,NombreFirma,NombreCuenta,CorreoCuenta,IdCed],
                                    function(tx, results){
                                        $("#adios").html("<input type='hidden' id='imagenC' name='imagenC'/><span style='font-weight: bold; color: #00A7B5;'>Hora de Término</span><br/><br/><center><div style='background-color: white;border-radius: 20px;width: 147.76px;height: 147.76px;border: solid 3px #00A7B5;'><a href='#' onclick='capturePhoto();'><img src='img/camera.svg' id='photoIcon' width='45px' style='position: absolute;position: fixed;z-index: 100;margin-top: 50px; position: relative;'/></a></div></center><input type='image' name='smallImage' style='margin: 0px auto; width: 147.76px; height: 147.76px; border-radius: 17px; display: none; margin-top: -150.65px;' id='smallImage' src='' /><br><br><label style='font-size: 12px;'><strong>Comentario de la calificación:</strong></label><center><textarea rows='5' style='color: grey;' disabled>"+ ccte +"</textarea></center><br><br><a href='#' onclick='gcierref();' style='border: none; outline:none;'><img src='img/save2.png' width='50px' /></a>");
                                        app.preloader.hide();
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        console.log("add client error: " + error.message);
                                        app.dialog.alert('Error al enviar..', 'Error');
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        if(estre == 0){
                             app.dialog.alert('Favor de evaluar la visita.', 'Importante');
                             app.preloader.hide();
                        }else if(estre == 1 || estre ==2 || estre ==3 || (ClienteMin == 'dominos')){
                            if(ccte == ''){
                               app.dialog.alert('Favor de colocar sus comentarios.', 'Importante');
                               app.preloader.hide();
                            }  else {
                                databaseHandler.db.transaction(
                                    function(tx1){
                                        tx1.executeSql(
                                            "INSERT INTO cierre (IdCedula,eval,cfirma,geolocalizacion,Solestado,coment,NombreFirma,NombreCuenta,CorreoCuenta) VALUES (?,?,?,?,?,?,?,?,?)",
                                            [IdCed,estre,file_data,geo,envio,ccte,NombreFirma,NombreCuenta,CorreoCuenta],
                                            function(tx1, results){

                                                $('.icon-back').remove();
                                                $('.back').remove();
                                                $("#adios").html("<input type='hidden' id='imagenC' name='imagenC'/><span style='font-weight: bold; color: #00A7B5;'>Hora de Término</span><br /><br /><center><div style='background-color: white;border-radius: 20px;width: 147.76px;height: 147.76px;border: solid 3px #00A7B5;'><a href='#' onclick='capturePhoto();'><img src='img/camera.svg' id='photoIcon' width='45px' style='position: absolute;position: fixed;z-index: 100;margin-top: 50px; position: relative;'></a></div></center><input type='image' name='smallImage' style='margin: 0px auto; width: 147.76px; height: 147.76px; border-radius: 17px; display: none; margin-top: -150.65px;' id='smallImage' src='' /><br><br><label style='font-size: 12px;'><strong>Comentario de la calificación:</strong></label><center><textarea rows='5' style='color: grey;' disabled>"+ ccte +"</textarea></center><br><br><a href='#' onclick='gcierref();' style='border: none; outline:none;'><img src='img/save2.png' width='50px' /></a>");
                                                app.preloader.hide();
                                                 $("#signate").val("");
                                            },
                                            function(tx1, error){
                                                console.log("add client error: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    }
                                    );
                                }
                            }else {
                                databaseHandler.db.transaction(
                                    function(tx1){
                                        tx1.executeSql(
                                            "INSERT INTO cierre (IdCedula,eval,cfirma,geolocalizacion,Solestado,coment,NombreFirma,NombreCuenta,CorreoCuenta) VALUES (?,?,?,?,?,?,?,?,?)",
                                            [IdCed,estre,file_data,geo,envio,ccte,NombreFirma,NombreCuenta,CorreoCuenta],
                                            function(tx1, results){

                                                $('.icon-back').remove();
                                                $('.back').remove();
                                                $("#adios").html("<input type='hidden' id='imagenC' name='imagenC'/><span style='font-weight: bold; color: #00A7B5;'>Hora de Término</span><br /><br /><center><div style='background-color: white;border-radius: 20px;width: 147.76px;height: 147.76px;border: solid 3px #00A7B5;'><a href='#' onclick='capturePhoto();'><img src='img/camera.svg' id='photoIcon' width='45px' style='position: absolute;position: fixed;z-index: 100;margin-top: 50px; position: relative;'/></a></div></center><input type='image' name='smallImage' style='margin: 0px auto; width: 147.76px; height: 147.76px; border-radius: 17px; display: none; margin-top: -150.65px;' id='smallImage' src='' /><br><br><label style='font-size: 12px;'><strong>Comentario de la calificación:</strong></label><center><textarea rows='5' style='color: grey;' disabled>"+ ccte +"</textarea></center><br><br><a href='#' onclick='gcierref();' style='border: none; outline:none;'><img src='img/save2.png' width='50px' /></a>");
                                                app.preloader.hide();
                                            },
                                            function(tx1, error){
                                                console.log("add client error: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    }
                                    );
                            }
                    }
                },
                function(tx1, error){
                    console.log("add client error: " + error.message);
                    app.preloader.hide();
                }
            );
        }
    );
}
//CIERRE 2DA PARTE
function gcierref(){
    app.preloader.show('blue');
    var IdCte = localStorage.getItem("IdCte");
    var IdCed = localStorage.getItem("IdCedula");
    var imgF = $("#imagenC").val();
    var file_data = $('#imagenC').val();
    var env = 1;
    var fecha = new Date();
    var fFinal = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    //VALIDACION DE CAMPOS
    if(file_data != ''){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "UPDATE cierre SET fcierre = ?, envio = ?, FechaCierre = ? WHERE IdCedula = ?",
                    [ imgF, env , fFinal ,IdCed ],
                    function(tx, results){
                        app.dialog.alert('El registro se guardo correctamente.', 'Aviso');
                        window.localStorage.removeItem("IdCedula");
                        window.localStorage.removeItem("IdCte");
                        window.localStorage.removeItem("IdInventario");
                        app.preloader.hide();
                        window.location.href = "./menu.html";
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("add client error: " + error.message);
                        app.dialog.alert('Error al enviar..', 'Error');
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }else{
        app.dialog.alert('El campo: Fotograf\u00eda. Es requerido.', 'Aviso');
        app.preloader.hide();
    }
}

function verpdf(IdCte, IdCed, TipoC) {
    var id_empresa = localStorage.getItem("id_empresa");
    if (TipoC == "levantamiento" || TipoC == "mantenimiento") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if (TipoC == "sanitizacion") {
        app.views.main.router.navigate({
            name: "visualizars",
            params: { IdCte: IdCte, IdCed: IdCed },
        });
    } else if (TipoC == "fumigacion") {
        app.views.main.router.navigate({
            name: "visualizarf",
            params: { IdCte: IdCte, IdCed: IdCed },
        });
    } else if (TipoC == "baja") {
        localStorage.setItem("IdBennetts", IdCed);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if (TipoC == "reporteTecnico" || TipoC == "minutaCoordinador") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if(TipoC == "sanitizacionSURO"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if(TipoC == "General"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({name: "visualizar"});
    } else if(TipoC == "Checklist"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({name: "visualizar"});
    } else if(TipoC == "AuditoriaTecnico" || TipoC == "AuditoriaSupervisorTecnico" || TipoC == "AuditoriaLider"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({name: "visualizar"});
    } else if(TipoC == "ventaSMC" || TipoC == "servicioSMC"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({name: "visualizar"});
    }
  }
  

function clientSelected(clientName){
    var mes = $("#month").val();
    localStorage.setItem("id_cliente",clientName);
    localStorage.setItem("mes_detalle",mes);
    app.views.main.router.navigate({name: 'verVisita'});
}
function clientSelected2(clientName,fecha){
    let fechaDetalle = fecha.split("-");
    localStorage.setItem("id_cliente",clientName);
    localStorage.setItem("year_detalle",fechaDetalle[0]);
    localStorage.setItem("month_detalle",fechaDetalle[1]);
    localStorage.setItem("day_detalle",fechaDetalle[2]);    
    app.views.main.router.navigate({name: 'calendar-page'});
}
//metodo regresar
function regresar(){
     window.location.href = "./menu.html";
     screen.orientation.lock('portrait');
}
function sumarDias(fecha, dias){
    var fecha = new Date();
    fecha.setDate(fecha.getDate() + dias);
    var options = { year: "numeric", month: "numeric", day: "numeric" };
    return fecha.toLocaleDateString( fecha.getTimezoneOffset(), options );
}

function regresarRecorrido(){
    app.views.main.router.back('/recorrido/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorrido2(){
    app.views.main.router.back('/recorrido2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorrido3(){
    app.views.main.router.back('/recorrido3/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSEG(){
    app.views.main.router.back('/recorridoseg/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSMC1(){
    app.views.main.router.back('/recorridoSMC1/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSMC2(){
    app.views.main.router.back('/recorridoSMC2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSMC3(){
    app.views.main.router.back('/recorridoSMC3/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSMC4(){
    app.views.main.router.back('/recorridoSMC4/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoDIPREC1(){
    app.views.main.router.back('/recorridoDIPREC1/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoDIPREC2(){
    app.views.main.router.back('/recorridoDIPREC2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoDIPREC3(){
    app.views.main.router.back('/recorridoDIPREC3/', {force: true, ignoreCache: true, reload: true});
}
function regresarBennetts(){
    app.views.main.router.back('/menuBennetts/', {force: true, ignoreCache: true, reload: true});
}
function regresarBennetts2(){
    app.views.main.router.back('/recorridoBennetts2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoServInd1(){
    app.views.main.router.back('/recorridoServ1/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoServInd2(){
    app.views.main.router.back('/recorridoServ2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoMer1(){
    app.views.main.router.back('/recorridoMerGroup/', {force: true, ignoreCache: true, reload: true});
}
function horizontal(){
    screen.orientation.lock('landscape');
}

function Results(){
    $( "#Resultados" ) .show( "fast");
    $( "#LimSani" )    .hide( "fast");
    $( "#ManAli" )     .hide( "fast");
    $( "#higPerso" )   .hide( "fast");
    $( "#ContTemp" )   .hide( "fast");
    $( "#ContPlag" )   .hide( "fast");
    var valCheckuno = document.getElementById("uno").checked;
  //  alert(valCheckuno);
    var valCheckdos = document.getElementById("dos").checked;
  //  alert(valCheckdos);
    if(valCheckuno == true){var n1 = 10;}
    if(valCheckdos == true){ var n2 = 10;}

    var suma = parseInt(n1) + parseInt(n2);
   // alert("La suma es: "+suma);
    $("#res").html("<span>La suma es: "+suma+"</span");
}

function limpiar(){
    $("#NombreRecibe").val("");
    $("#PuestoRecibe").val("");
    $("#Telefono").val("");
    $("#Correo").val("");
    $("#NombreRecibe").css("background-color", "#ffffff");
    $("#PuestoRecibe").css("background-color", "#ffffff");
    $("#Telefono").css("background-color", "#ffffff");
    $("#Correo").css("background-color", "#ffffff");
}

function editar_fecha(fecha, intervalo, dma, separador) {
    var separador = separador || "-";
    var arrayFecha = fecha.split(separador);
    var dia = arrayFecha[2];
    var mes = arrayFecha[1];
    var anio = arrayFecha[0];

    var fechaInicial = new Date(anio, mes - 1, dia);
    var fechaFinal = fechaInicial;
    if(dma=="m" || dma=="M"){
      fechaFinal.setMonth(fechaInicial.getMonth()+parseInt(intervalo));
    }else if(dma=="y" || dma=="Y"){
      fechaFinal.setFullYear(fechaInicial.getFullYear()+parseInt(intervalo));
    }else if(dma=="d" || dma=="D"){
      fechaFinal.setDate(fechaInicial.getDate()+parseInt(intervalo));
    }else{
       return fecha;
    }
    dia = fechaFinal.getDate();
    mes = fechaFinal.getMonth() + 1;
    anio = fechaFinal.getFullYear();
    dia = (dia.toString().length == 1) ? "0" + dia.toString() : dia;
    mes = (mes.toString().length == 1) ? mes.toString() : mes;
    return anio + "-" + mes + "-" + dia;
}

function storageImages(valor){
   var imagen = $("#imagenC"+ valor).val();
   localStorage.setItem("imagenC"+ valor, imagen);
}

function gdatos(){
    var emblechicos = $("#emblechicos").val();
    localStorage.setItem("emblechicos", emblechicos);
    var emblegrandes = $("#emblegrandes").val();
    localStorage.setItem("emblegrandes", emblegrandes);
}